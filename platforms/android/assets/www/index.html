    <!DOCTYPE html>
    <html>
    <head>

        <!-- UPDATED FROM WITHOUT assets/www/...-->

        <!-- To revert from the addition of being able to resume an rpt interview that was left, replace the entirety of
        checkLoginV2() with one from the release apk, same with the idle event listener, get rid of currentPage global variable... -->

        <meta charset="UTF-8">
        <meta name="format-detection" content="telephone-no">
        <meta name="viewport" content="user-scalable=no, initial-scale=1, minimum-scale=1, maximum-scale=1, width=device-width, height=device-height">
        <title>Our Application</title>
        <!--link rel="stylesheet" href="css/themes/default/jquery.mobile-1.2.0.css" /-->
        <!--link rel="stylesheet" href="css/redmond/jquery-ui-1.10.3.custom.css" /-->
        <!--link rel="stylesheet" href="js/jquery.mobile-1.3.2.css" /-->
        <link rel="stylesheet" href="css/main.css" />
        <link rel="stylesheet" href="css/themes/ecig/ecig_themes.css" />
        <link rel="stylesheet" href="js/jquery.mobile.structure-1.3.2.css" />
        <script src="cordova.js"></script>
        <!--script src="cordova_plugins.js"></script-->

        <script src="js/jquery-1.10.2.js"></script>
        <!--  script src="http://code.jquery.com/jquery-migrate-1.2.1.js"></script-->

        <script src="js/jquery.mobile-1.3.2.js"></script>
        <!--script src="js/jquery-ui-1.10.3.custom.js"></script-->
        <!--script src="js/jquery.ui.touch-punch.js"></script-->

        <script src="js/mustache.js"></script>
        <script src="js/index.js">app.initialize()</script>
        <script src="js/date.js"></script>
        <script src="js/moment.js"></script>

        <script src="js/caesar_cipher.js"></script>

        <!--script src="js/cryptojs/aes.js"></script-->
        <!--script src="js/cryptojs/aes_302.js"></script-->

        <script src="mobiscroll/js/mobiscroll.core.js"></script>
        <script src="mobiscroll/js/mobiscroll.scroller.js" type="text/javascript"></script>

        <script src="mobiscroll/js/mobiscroll.datetime.js" type="text/javascript"></script>
        <script src="mobiscroll/js/mobiscroll.select.js" type="text/javascript"></script>

        <script src="mobiscroll/js/mobiscroll.scroller.jqm.js" type="text/javascript"></script>
        <script src="mobiscroll/js/mobiscroll.scroller.ios.js" type="text/javascript"></script>
        <script src="mobiscroll/js/mobiscroll.scroller.android.js" type="text/javascript"></script>
        <script src="mobiscroll/js/mobiscroll.scroller.android-ics.js" type="text/javascript"></script>
        <script src="mobiscroll/js/mobiscroll.scroller.wp.js" type="text/javascript"></script>

        <script src="mobiscroll/js/i18n/mobiscroll.i18n.de.js" type="text/javascript"></script>
        <script src="mobiscroll/js/i18n/mobiscroll.i18n.es.js" type="text/javascript"></script>
        <script src="mobiscroll/js/i18n/mobiscroll.i18n.fr.js" type="text/javascript"></script>
        <script src="mobiscroll/js/i18n/mobiscroll.i18n.hu.js" type="text/javascript"></script>
        <script src="mobiscroll/js/i18n/mobiscroll.i18n.it.js" type="text/javascript"></script>
        <script src="mobiscroll/js/i18n/mobiscroll.i18n.no.js" type="text/javascript"></script>
        <script src="mobiscroll/js/i18n/mobiscroll.i18n.pt-BR.js" type="text/javascript"></script>
        <script src="mobiscroll/js/i18n/mobiscroll.i18n.zh.js" type="text/javascript"></script>

        <link href="mobiscroll/css/mobiscroll.scroller.css" rel="stylesheet" type="text/css" />
        <link href="mobiscroll/css/mobiscroll.scroller.jqm.css" rel="stylesheet" type="text/css" />
        <link href="mobiscroll/css/mobiscroll.scroller.android.css" rel="stylesheet" type="text/css" />
        <link href="mobiscroll/css/mobiscroll.scroller.android-ics.css" rel="stylesheet" type="text/css" />
        <link href="mobiscroll/css/mobiscroll.scroller.ios.css" rel="stylesheet" type="text/css" />
        <link href="mobiscroll/css/mobiscroll.scroller.sense-ui.css" rel="stylesheet" type="text/css" />
        <link href="mobiscroll/css/mobiscroll.scroller.wp.css" rel="stylesheet" type="text/css" />

        <link href="mobiscroll/css/mobiscroll.animation.css" rel="stylesheet" type="text/css" />

        <script>

        var encryptionKey = 'unobtainium45459';
        var adminPin = '45459';

        //var notifSoundLoc = 'www/audio/notifsound1.mp3';
        //var notifSoundLoc = 'android.resource://com.testing.ecigcordova3_3/raw/notifsound1.mp3';

        var TobaccoUseIntFileWriter;
        var randomPromptIntFileWriter;
        var suspendFileWriter;
        var wakeTimeBedTimeFileWriter;
        var notifFileWriter;
        var missedNotifsFileWriter;
        var loginFileWriter;
        var problemReportFileWriter;
        var stateFileWriter;

        var TobaccoUseIntFileString;
        var randomPromptIntFileString;
        var suspendFileString;
        var bedTimeFileString;
        var wakeTimeFileString;
        var notifFileString;
        var loginFileString;

        var delimiter = ', ';

        var writingToLoginInfo = false;
        var writingToNotifTimes = false;
        var writingToTobaccoUseInt = false;
        var writingToRandomPromptInt = false;
        var writingToBedtime = false;
        var writingToSuspendTime = false;

        var minSleepTime = 4;
        var maxSleepTime = 19;
        //var minSleepTime = 0;
        //var maxSleepTime = 23;

        //Old missed notif related variables
        //var didMissNotifArr = [];
        var didMissDelayedNotif = true;
        var didMissWakeUp = true;

        var cancelledIDArr = [];
        var idOfNotMissedNotif = -1;
        var numNotifsNotMissed = 0;
        var numSurveysTaken = 0;

        var stringToWrite = '';
        
        //var clearingAll = false;

        var userID = '';
        var userPass = '';

        var writePause = 1000;

        var date = new Date();
        var hour, min, sec;
        var timeStamp;

        var bufferMins = 15;
        //var bufferMins = 5;
        //var bufferMins = 1;

        //This will only hold a different value if the last notif in the queue has been triggered
        //In that situation, need to bookmark the id of that notif, as it will not be accessible upon resuming the app,
        //either by way of opening the notif or accessing the app normally... need to make sure that it isn't incorrectly added
        //as a miss
        var lastNotifID = -1;
        var dealtWithLastNotif = false;

        var surveysInADay = 10;
        //var surveysInADay = 200;

        //var surveysInADay = 50;

        var timeToTakeSurvey = 5 * 60;
        var durationOfNotif = 3 * 60;

        //var timeToTakeSurvey = 5 * 60;
        //var durationOfNotif = 20;

        var states = {
            ACTIVE:      0,
            ASLEEP:      1,
            SUSPENDED:   2
        }

        var currentState = states.ACTIVE;

        var my_media = null;
        var my_alarm_media = null;

        var hasMissedNotif = false;
        var missedNotifs = 0;

        //var notifsToday = 0; //Holds number of notifs that are actually added in a day... number is dependent on when user sets bedtime/waketime/suspends at a point of time in a day
        var notifCount = 0;

        var partitionTimes = [];
        var notifTimes = [];

        var takingTestSurvey = false;

        var startedRandomPromptSurvey = false;
        var finishedRandomPromptSurvey = false;

        var notifAudioLoc = 'android.resource://com.testing.ecig_cordova3_3_simp/raw/notification_tone_3min';
        var alarmAudioLoc = 'android.resource://com.testing.ecig_cordova3_3_simp/raw/alarm_audio_3min';

        var wakeUpFiring = false;

        var rptStartTime = null;

        var defaultWakeTime = moment().hours(0).minutes(0).seconds(0);
        var defaultBedTime = moment().hours(23).minutes(59).seconds(0);

        var wakeTimeDate = moment(defaultWakeTime);
        var bedTimeDate = moment(defaultBedTime);

        var timeAsleep = 1;
        var timeAwake = Math.abs(timeAsleep - (24 * 60));

        var currentState = 0;

        var resumeTime = null;//holds time value at which the application will return to a normal state... after being delayed, suspended, or asleep for so long.
        var appState ='';
        //console.log("\nwakeTime: " + wakeTimeDate.format());
        //console.log("\nbedTime: " + bedTimeDate.format());

        var goto5a = false;
        var goto5a1 = false;
        var gotoCigMenthol = false;

        var suspendMinutes = 0;

        var surveyString = "";

        var tempCounter = 0;

        var checkboxCount = 0;

        var loginData = {username:'', password: ''};
        /*
        var logintemplate = '<div data-role="content">\
                                <form id="form-login">\
                                    <div data-role="fieldcontain" class="ui-hide-label">\
                                        <label for="input-username">Username:</label>\
                                         <input type="text" name="input-username" id="input-username" value="" placeholder="Username" />\
                                    </div>\
                                    <div data-role="fieldcontain" class="ui-hide-label">\
                                        <label for="input-password">Password:</label>\
                                        <input type="password" name="input-password" id="input-password" value="" placeholder="Password" />\
                                    </div>\
                                    <input type="button" value="Login" id="button-login" onclick="checkLogin()">\
                                </form>\
                            </div>';
        */

        var delayData = {delaymins:""};
        var delayTemplate = '<h3>Do you want to do the survey now or delay it?</h3>\
                             <a href="#" data-role="button" data-icon="bars" onclick="startRandomPromptInterview()">Do the survey now</a>\
                             <div id="delaydiv" data-role="controlgroup" data-type="horizontal">\
                                    <label for="select-choice-1">Select a delay amount:</label>\
                                	<select name="select-choice-1" id="select-choice-1" data-icon="arrow-d" data-iconpos="left">\
                                        <option value="5">5 mins</option>\
                                        <option value="10">10 mins</option>\
                                        <option value="15">15 mins</option>\
                                        <option value="20">20 mins</option>\
                                    </select>\
                                    <a href="#" data-role="button" data-icon="check" onclick="delayNotif(false)">Delay notif</a>\
                             </div>';

        var visitedEmoSurveyA = false;
        var visitedEmoSurveyB = false;
        var visitedEmoSurveyC = false;

        //OLD SLIDER CODE BELOW:
        /*
        var emoSurveyAData = {happy:"",relax:"",cheer:""};
        var emoSurveyATemplate =  '<h3>On a scale of 1-10</h3>\
                                    <h2>Right now, I feel:</h2>\
                                    <div class="jqmslidercontemoSurveyA">\
                                        <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                            <label for="slider-happy" class="sliderlabel">Happy:</label>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="range" name="slider-happy" id="slider-happy" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="false" data-popup-enabled="false">\
                                        </div>\
                                        \
                                         <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                            <label for="slider-relax" class="sliderlabel">Relaxed:</label>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="range" name="slider-relax" id="slider-relax" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="false" data-popup-enabled="false">\
                                        </div>\
                                        \
                                         <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                            <label for="slider-cheer" class="sliderlabel">Cheerful:</label>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="range" name="slider-cheer" id="slider-cheer" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="false" data-popup-enabled="false">\
                                        </div>\
                                    </div>';


        var emoSurveyBData = {sad:"",stress:"",angry:""};
        var emoSurveyBTemplate =  '<h3>On a scale of 1-10</h3>\
                                    <h2>Right now, I feel:</h2>\
                                    <div class="jqmslidercontemoSurveyB">\
                                         <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                            <label for="slider-sad" class="sliderlabel">Sad:</label>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="range" name="slider-sad" id="slider-sad" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="false" data-popup-enabled="false">\
                                        </div>\
                                    \
                                         <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                            <label for="slider-stress" class="sliderlabel">Stressed:</label>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="range" name="slider-stress" id="slider-stress" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="false" data-popup-enabled="false">\
                                        </div>\
                                    \
                                         <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                            <label for="slider-angry" class="sliderlabel">Angry:</label>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="range" name="slider-angry" id="slider-angry" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="false" data-popup-enabled="false">\
                                        </div>\
                                    </div>';


        var emoSurveyCData = {frust:"",irritbl:"",confdnt:""};
        var emoSurveyCTemplate =  '<h3>On a scale of 1-10</h3>\
                                    <h2>Right now, I feel:</h2>\
                                    <div class="jqmslidercontemoSurveyC">\
                                         <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                            <label for="slider-frust" class="sliderlabel">Frustrated:</label>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="range" name="slider-frust" id="slider-frust" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="false" data-popup-enabled="false">\
                                        </div>\
                                    \
                                         <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                            <label for="slider-irritbl" class="sliderlabel">Irritable:</label>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="range" name="slider-irritbl" id="slider-irritbl" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="false" data-popup-enabled="false">\
                                        </div>\
                                    \
                                         <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                            <label for="slider-confdnt" class="sliderlabel">Confident:</label>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="range" name="slider-confdnt" id="slider-confdnt" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="false" data-popup-enabled="false">\
                                        </div>\
                                    </div>';

        var visitedBeforeTobEmoSurveyA = false;
        var visitedBeforeTobEmoSurveyB = false;
        var visitedBeforeTobEmoSurveyC = false;

        var beforeTobEmoSurveyAData = {bhappy:"",brelax:"",bcheer:""};
        var beforeTobEmoSurveyATemplate =  '<h3>Now think about the time <span style=”text-decoration:underline;”>just before</span> you used tobacco...</h3>\
                                    <h3>On a scale of 1-10</h3>\
                                    <h2>Before using tobacco, I felt:</h2>\
                                    <div class="jqmslidercontbefEmoSurveyA">\
                                        <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                            <label for="slider-bhappy" class="sliderlabel">Happy:</label>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="range" name="slider-bhappy" id="slider-bhappy" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="false" data-popup-enabled="false">\
                                        </div>\
                                        \
                                         <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                            <label for="slider-brelax" class="sliderlabel">Relaxed:</label>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="range" name="slider-brelax" id="slider-brelax" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="false" data-popup-enabled="false">\
                                        </div>\
                                        \
                                         <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                            <label for="slider-bcheer" class="sliderlabel">Cheerful:</label>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="range" name="slider-bcheer" id="slider-bcheer" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="false" data-popup-enabled="false">\
                                        </div>\
                                    </div>';


        var beforeTobEmoSurveyBData = {bsad:"",bstress:"",bangry:""};
        var beforeTobEmoSurveyBTemplate =  '<h3>Now think about the time <span style=”text-decoration:underline;”>just before</span> you used tobacco...</h3>\
                                    <h3>On a scale of 1-10</h3>\
                                    <h2>Before using tobacco, I felt:</h2>\
                                    <div class="jqmslidercontbefEmoSurveyB">\
                                         <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                            <label for="slider-bsad" class="sliderlabel">Sad:</label>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="range" name="slider-bsad" id="slider-bsad" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="false" data-popup-enabled="false">\
                                        </div>\
                                    \
                                         <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                            <label for="slider-bstress" class="sliderlabel">Stressed:</label>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="range" name="slider-bstress" id="slider-bstress" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="false" data-popup-enabled="false">\
                                        </div>\
                                    \
                                         <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                            <label for="slider-bangry" class="sliderlabel">Angry:</label>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="range" name="slider-bangry" id="slider-bangry" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="false" data-popup-enabled="false">\
                                        </div>\
                                </div>';


        var beforeTobEmoSurveyCData = {bfrust:"",birritbl:"",bconfdnt:""};
        var beforeTobEmoSurveyCTemplate =  '<h3>Now think about the time <span style=”text-decoration:underline;”>just before</span> you used tobacco...</h3>\
                                    <h3>On a scale of 1-10</h3>\
                                    <h2>Before using tobacco, I felt:</h2>\
                                    <div class="jqmslidercontbefEmoSurveyC">\
                                         <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                            <label for="slider-bfrust" class="sliderlabel">Frustrated:</label>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="range" name="slider-bfrust" id="slider-bfrust" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="false" data-popup-enabled="false">\
                                        </div>\
                                    \
                                         <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                            <label for="slider-birritbl" class="sliderlabel">Irritable:</label>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="range" name="slider-birritbl" id="slider-birritbl" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="false" data-popup-enabled="false">\
                                        </div>\
                                    \
                                         <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                            <label for="slider-bconfdnt" class="sliderlabel">Confident:</label>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="range" name="slider-bconfdnt" id="slider-bconfdnt" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="false" data-popup-enabled="false">\
                                        </div>\
                                    </div>';

        var visitedWhenUsingTobSurvey = false;

        //Need to replace # with answer from previous question
        var whenUsingTobSurveyData = {pleasur:"",satisfy:""};
        var whenUsingTobSurveyTemplate = '<h3>Now think about when you were using tobacco...</h3>\
                                            <h3>On a scale of 1-10</h3>\
                                            <div class="jqmslidercontwhenUsingSurvey">\
                                                <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                                    <label for="slider-pleasur" class="sliderlabel" id="pleasurLabel">How pleasurable was the product?</label>\
                                                    <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                                    <input type="range" name="slider-pleasur" id="slider-pleasur" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="false" data-popup-enabled="false">\
                                                </div>\
                                                \
                                                 <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                                    <label for="slider-satisfy" class="sliderlabel" id="satisfyLabel">How satisfying was the product?</label>\
                                                    <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                                    <input type="range" name="slider-satisfy" id="slider-satisfy" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="false" data-popup-enabled="false">\
                                                </div>\
                                                \
                                            </div>';
         */

        var emoSurveyAData = {happy:"",relax:"",cheer:""};
        var emoSurveyATemplate =  '<h3>On a scale of 1-10</h3>\
                                    <h2>Right now, I feel:</h2>\
                                    <div class="post-header"></div>\
                                    <form>\
                                        <fieldset data-role="controlgroup" class="horizontal" data-type="horizontal">\
                                            <legend><b>Happy:</b></legend>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="radio" name="radio-happy" id="radio-happy-a" value="1">\
                                            <label for="radio-happy-a">1</label>\
                                            <input type="radio" name="radio-happy" id="radio-happy-b" value="2">\
                                            <label for="radio-happy-b">2</label>\
                                            <input type="radio" name="radio-happy" id="radio-happy-c" value="3">\
                                            <label for="radio-happy-c">3</label>\
                                            <input type="radio" name="radio-happy" id="radio-happy-d" value="4">\
                                            <label for="radio-happy-d">4</label>\
                                            <input type="radio" name="radio-happy" id="radio-happy-e" value="5">\
                                            <label for="radio-happy-e">5</label>\
                                            <input type="radio" name="radio-happy" id="radio-happy-f" value="6">\
                                            <label for="radio-happy-f">6</label>\
                                            <input type="radio" name="radio-happy" id="radio-happy-g" value="7">\
                                            <label for="radio-happy-g">7</label>\
                                            <input type="radio" name="radio-happy" id="radio-happy-h" value="8">\
                                            <label for="radio-happy-h">8</label>\
                                            <input type="radio" name="radio-happy" id="radio-happy-i" value="9">\
                                            <label for="radio-happy-i">9</label>\
                                            <input type="radio" name="radio-happy" id="radio-happy-j" value="10">\
                                            <label for="radio-happy-j" class="horizontal-10">10</label>\
                                        </fieldset>\
                                    </form>\
                                    <div class="post-horizontal"></div>\
                                    <form>\
                                        <fieldset data-role="controlgroup" class="horizontal" data-type="horizontal">\
                                            <legend><b>Relaxed:</b></legend>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="radio" name="radio-relax" id="radio-relax-a" value="1">\
                                            <label for="radio-relax-a">1</label>\
                                            <input type="radio" name="radio-relax" id="radio-relax-b" value="2">\
                                            <label for="radio-relax-b">2</label>\
                                            <input type="radio" name="radio-relax" id="radio-relax-c" value="3">\
                                            <label for="radio-relax-c">3</label>\
                                            <input type="radio" name="radio-relax" id="radio-relax-d" value="4">\
                                            <label for="radio-relax-d">4</label>\
                                            <input type="radio" name="radio-relax" id="radio-relax-e" value="5">\
                                            <label for="radio-relax-e">5</label>\
                                            <input type="radio" name="radio-relax" id="radio-relax-f" value="6">\
                                            <label for="radio-relax-f">6</label>\
                                            <input type="radio" name="radio-relax" id="radio-relax-g" value="7">\
                                            <label for="radio-relax-g">7</label>\
                                            <input type="radio" name="radio-relax" id="radio-relax-h" value="8">\
                                            <label for="radio-relax-h">8</label>\
                                            <input type="radio" name="radio-relax" id="radio-relax-i" value="9">\
                                            <label for="radio-relax-i">9</label>\
                                            <input type="radio" name="radio-relax" id="radio-relax-j" value="10">\
                                            <label for="radio-relax-j" class="horizontal-10">10</label>\
                                        </fieldset>\
                                    </form>\
                                    <div class="post-horizontal"></div>\
                                    <form>\
                                        <fieldset data-role="controlgroup" class="horizontal" data-type="horizontal">\
                                            <legend><b>Cheerful:</b></legend>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="radio" name="radio-cheer" id="radio-cheer-a" value="1">\
                                            <label for="radio-cheer-a">1</label>\
                                            <input type="radio" name="radio-cheer" id="radio-cheer-b" value="2">\
                                            <label for="radio-cheer-b">2</label>\
                                            <input type="radio" name="radio-cheer" id="radio-cheer-c" value="3">\
                                            <label for="radio-cheer-c">3</label>\
                                            <input type="radio" name="radio-cheer" id="radio-cheer-d" value="4">\
                                            <label for="radio-cheer-d">4</label>\
                                            <input type="radio" name="radio-cheer" id="radio-cheer-e" value="5">\
                                            <label for="radio-cheer-e">5</label>\
                                            <input type="radio" name="radio-cheer" id="radio-cheer-f" value="6">\
                                            <label for="radio-cheer-f">6</label>\
                                            <input type="radio" name="radio-cheer" id="radio-cheer-g" value="7">\
                                            <label for="radio-cheer-g">7</label>\
                                            <input type="radio" name="radio-cheer" id="radio-cheer-h" value="8">\
                                            <label for="radio-cheer-h">8</label>\
                                            <input type="radio" name="radio-cheer" id="radio-cheer-i" value="9">\
                                            <label for="radio-cheer-i">9</label>\
                                            <input type="radio" name="radio-cheer" id="radio-cheer-j" value="10">\
                                            <label for="radio-cheer-j" class="horizontal-10">10</label>\
                                        </fieldset>\
                                    </form>';


        var emoSurveyBData = {sad:"",stress:"",angry:""};
        var emoSurveyBTemplate =  '<h3>On a scale of 1-10</h3>\
                                    <h2>Right now, I feel:</h2>\
                                    <div class="post-header"></div>\
                                    <form>\
                                        <fieldset data-role="controlgroup" class="horizontal" data-type="horizontal">\
                                            <legend><b>Sad:</b></legend>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="radio" name="radio-sad" id="radio-sad-a" value="1">\
                                            <label for="radio-sad-a">1</label>\
                                            <input type="radio" name="radio-sad" id="radio-sad-b" value="2">\
                                            <label for="radio-sad-b">2</label>\
                                            <input type="radio" name="radio-sad" id="radio-sad-c" value="3">\
                                            <label for="radio-sad-c">3</label>\
                                            <input type="radio" name="radio-sad" id="radio-sad-d" value="4">\
                                            <label for="radio-sad-d">4</label>\
                                            <input type="radio" name="radio-sad" id="radio-sad-e" value="5">\
                                            <label for="radio-sad-e">5</label>\
                                            <input type="radio" name="radio-sad" id="radio-sad-f" value="6">\
                                            <label for="radio-sad-f">6</label>\
                                            <input type="radio" name="radio-sad" id="radio-sad-g" value="7">\
                                            <label for="radio-sad-g">7</label>\
                                            <input type="radio" name="radio-sad" id="radio-sad-h" value="8">\
                                            <label for="radio-sad-h">8</label>\
                                            <input type="radio" name="radio-sad" id="radio-sad-i" value="9">\
                                            <label for="radio-sad-i">9</label>\
                                            <input type="radio" name="radio-sad" id="radio-sad-j" value="10">\
                                            <label for="radio-sad-j" class="horizontal-10">10</label>\
                                        </fieldset>\
                                    </form>\
                                    <div class="post-horizontal"></div>\
                                    <form>\
                                        <fieldset data-role="controlgroup" class="horizontal" data-type="horizontal">\
                                            <legend><b>Stressed:</b></legend>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="radio" name="radio-stress" id="radio-stress-a" value="1">\
                                            <label for="radio-stress-a">1</label>\
                                            <input type="radio" name="radio-stress" id="radio-stress-b" value="2">\
                                            <label for="radio-stress-b">2</label>\
                                            <input type="radio" name="radio-stress" id="radio-stress-c" value="3">\
                                            <label for="radio-stress-c">3</label>\
                                            <input type="radio" name="radio-stress" id="radio-stress-d" value="4">\
                                            <label for="radio-stress-d">4</label>\
                                            <input type="radio" name="radio-stress" id="radio-stress-e" value="5">\
                                            <label for="radio-stress-e">5</label>\
                                            <input type="radio" name="radio-stress" id="radio-stress-f" value="6">\
                                            <label for="radio-stress-f">6</label>\
                                            <input type="radio" name="radio-stress" id="radio-stress-g" value="7">\
                                            <label for="radio-stress-g">7</label>\
                                            <input type="radio" name="radio-stress" id="radio-stress-h" value="8">\
                                            <label for="radio-stress-h">8</label>\
                                            <input type="radio" name="radio-stress" id="radio-stress-i" value="9">\
                                            <label for="radio-stress-i">9</label>\
                                            <input type="radio" name="radio-stress" id="radio-stress-j" value="10">\
                                            <label for="radio-stress-j" class="horizontal-10">10</label>\
                                        </fieldset>\
                                    </form>\
                                    <div class="post-horizontal"></div>\
                                    <form>\
                                        <fieldset data-role="controlgroup" class="horizontal" data-type="horizontal">\
                                            <legend><b>Angry:</b></legend>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="radio" name="radio-angry" id="radio-angry-a" value="1">\
                                            <label for="radio-angry-a">1</label>\
                                            <input type="radio" name="radio-angry" id="radio-angry-b" value="2">\
                                            <label for="radio-angry-b">2</label>\
                                            <input type="radio" name="radio-angry" id="radio-angry-c" value="3">\
                                            <label for="radio-angry-c">3</label>\
                                            <input type="radio" name="radio-angry" id="radio-angry-d" value="4">\
                                            <label for="radio-angry-d">4</label>\
                                            <input type="radio" name="radio-angry" id="radio-angry-e" value="5">\
                                            <label for="radio-angry-e">5</label>\
                                            <input type="radio" name="radio-angry" id="radio-angry-f" value="6">\
                                            <label for="radio-angry-f">6</label>\
                                            <input type="radio" name="radio-angry" id="radio-angry-g" value="7">\
                                            <label for="radio-angry-g">7</label>\
                                            <input type="radio" name="radio-angry" id="radio-angry-h" value="8">\
                                            <label for="radio-angry-h">8</label>\
                                            <input type="radio" name="radio-angry" id="radio-angry-i" value="9">\
                                            <label for="radio-angry-i">9</label>\
                                            <input type="radio" name="radio-angry" id="radio-angry-j" value="10">\
                                            <label for="radio-angry-j" class="horizontal-10">10</label>\
                                        </fieldset>\
                                    </form>';


        var emoSurveyCData = {frust:"",irritbl:"",confdnt:""};
        var emoSurveyCTemplate =  '<h3>On a scale of 1-10</h3>\
                                    <h2>Right now, I feel:</h2>\
                                    <div class="post-header"></div>\
                                    <form>\
                                        <fieldset data-role="controlgroup" class="horizontal" data-type="horizontal">\
                                            <legend><b>Frustrated:</b></legend>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="radio" name="radio-frust" id="radio-frust-a" value="1">\
                                            <label for="radio-frust-a">1</label>\
                                            <input type="radio" name="radio-frust" id="radio-frust-b" value="2">\
                                            <label for="radio-frust-b">2</label>\
                                            <input type="radio" name="radio-frust" id="radio-frust-c" value="3">\
                                            <label for="radio-frust-c">3</label>\
                                            <input type="radio" name="radio-frust" id="radio-frust-d" value="4">\
                                            <label for="radio-frust-d">4</label>\
                                            <input type="radio" name="radio-frust" id="radio-frust-e" value="5">\
                                            <label for="radio-frust-e">5</label>\
                                            <input type="radio" name="radio-frust" id="radio-frust-f" value="6">\
                                            <label for="radio-frust-f">6</label>\
                                            <input type="radio" name="radio-frust" id="radio-frust-g" value="7">\
                                            <label for="radio-frust-g">7</label>\
                                            <input type="radio" name="radio-frust" id="radio-frust-h" value="8">\
                                            <label for="radio-frust-h">8</label>\
                                            <input type="radio" name="radio-frust" id="radio-frust-i" value="9">\
                                            <label for="radio-frust-i">9</label>\
                                            <input type="radio" name="radio-frust" id="radio-frust-j" value="10">\
                                            <label for="radio-frust-j" class="horizontal-10">10</label>\
                                        </fieldset>\
                                    </form>\
                                    <div class="post-horizontal"></div>\
                                    <form>\
                                        <fieldset data-role="controlgroup" class="horizontal" data-type="horizontal">\
                                            <legend><b>Irritable:</b></legend>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="radio" name="radio-irritbl" id="radio-irritbl-a" value="1">\
                                            <label for="radio-irritbl-a">1</label>\
                                            <input type="radio" name="radio-irritbl" id="radio-irritbl-b" value="2">\
                                            <label for="radio-irritbl-b">2</label>\
                                            <input type="radio" name="radio-irritbl" id="radio-irritbl-c" value="3">\
                                            <label for="radio-irritbl-c">3</label>\
                                            <input type="radio" name="radio-irritbl" id="radio-irritbl-d" value="4">\
                                            <label for="radio-irritbl-d">4</label>\
                                            <input type="radio" name="radio-irritbl" id="radio-irritbl-e" value="5">\
                                            <label for="radio-irritbl-e">5</label>\
                                            <input type="radio" name="radio-irritbl" id="radio-irritbl-f" value="6">\
                                            <label for="radio-irritbl-f">6</label>\
                                            <input type="radio" name="radio-irritbl" id="radio-irritbl-g" value="7">\
                                            <label for="radio-irritbl-g">7</label>\
                                            <input type="radio" name="radio-irritbl" id="radio-irritbl-h" value="8">\
                                            <label for="radio-irritbl-h">8</label>\
                                            <input type="radio" name="radio-irritbl" id="radio-irritbl-i" value="9">\
                                            <label for="radio-irritbl-i">9</label>\
                                            <input type="radio" name="radio-irritbl" id="radio-irritbl-j" value="10">\
                                            <label for="radio-irritbl-j" class="horizontal-10">10</label>\
                                        </fieldset>\
                                    </form>\
                                    <div class="post-horizontal"></div>\
                                    <form>\
                                        <fieldset data-role="controlgroup" class="horizontal" data-type="horizontal">\
                                            <legend><b>Confident:</b></legend>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="radio" name="radio-confdnt" id="radio-confdnt-a" value="1">\
                                            <label for="radio-confdnt-a">1</label>\
                                            <input type="radio" name="radio-confdnt" id="radio-confdnt-b" value="2">\
                                            <label for="radio-confdnt-b">2</label>\
                                            <input type="radio" name="radio-confdnt" id="radio-confdnt-c" value="3">\
                                            <label for="radio-confdnt-c">3</label>\
                                            <input type="radio" name="radio-confdnt" id="radio-confdnt-d" value="4">\
                                            <label for="radio-confdnt-d">4</label>\
                                            <input type="radio" name="radio-confdnt" id="radio-confdnt-e" value="5">\
                                            <label for="radio-confdnt-e">5</label>\
                                            <input type="radio" name="radio-confdnt" id="radio-confdnt-f" value="6">\
                                            <label for="radio-confdnt-f">6</label>\
                                            <input type="radio" name="radio-confdnt" id="radio-confdnt-g" value="7">\
                                            <label for="radio-confdnt-g">7</label>\
                                            <input type="radio" name="radio-confdnt" id="radio-confdnt-h" value="8">\
                                            <label for="radio-confdnt-h">8</label>\
                                            <input type="radio" name="radio-confdnt" id="radio-confdnt-i" value="9">\
                                            <label for="radio-confdnt-i">9</label>\
                                            <input type="radio" name="radio-confdnt" id="radio-confdnt-j" value="10">\
                                            <label for="radio-confdnt-j" class="horizontal-10">10</label>\
                                        </fieldset>\
                                    </form>';

        var visitedBeforeTobEmoSurveyA = false;
        var visitedBeforeTobEmoSurveyB = false;
        var visitedBeforeTobEmoSurveyC = false;

        var beforeTobEmoSurveyAData = {bhappy:"",brelax:"",bcheer:""};
        var beforeTobEmoSurveyATemplate =  '<h3>Now think about the time <span style=”text-decoration:underline;”>just before</span> you used tobacco...</h3>\
                                    <h3>On a scale of 1-10</h3>\
                                    <h2>Before using tobacco, I felt:</h2>\
                                    <div class="post-header"></div>\
                                    <form>\
                                        <fieldset data-role="controlgroup" class="horizontal" data-type="horizontal">\
                                            <legend><b>Happy:</b></legend>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="radio" name="radio-bhappy" id="radio-bhappy-a" value="1">\
                                            <label for="radio-bhappy-a">1</label>\
                                            <input type="radio" name="radio-bhappy" id="radio-bhappy-b" value="2">\
                                            <label for="radio-bhappy-b">2</label>\
                                            <input type="radio" name="radio-bhappy" id="radio-bhappy-c" value="3">\
                                            <label for="radio-bhappy-c">3</label>\
                                            <input type="radio" name="radio-bhappy" id="radio-bhappy-d" value="4">\
                                            <label for="radio-bhappy-d">4</label>\
                                            <input type="radio" name="radio-bhappy" id="radio-bhappy-e" value="5">\
                                            <label for="radio-bhappy-e">5</label>\
                                            <input type="radio" name="radio-bhappy" id="radio-bhappy-f" value="6">\
                                            <label for="radio-bhappy-f">6</label>\
                                            <input type="radio" name="radio-bhappy" id="radio-bhappy-g" value="7">\
                                            <label for="radio-bhappy-g">7</label>\
                                            <input type="radio" name="radio-bhappy" id="radio-bhappy-h" value="8">\
                                            <label for="radio-bhappy-h">8</label>\
                                            <input type="radio" name="radio-bhappy" id="radio-bhappy-i" value="9">\
                                            <label for="radio-bhappy-i">9</label>\
                                            <input type="radio" name="radio-bhappy" id="radio-bhappy-j" value="10">\
                                            <label for="radio-bhappy-j" class="horizontal-10">10</label>\
                                        </fieldset>\
                                    </form>\
                                    <div class="post-horizontal"></div>\
                                    <form>\
                                        <fieldset data-role="controlgroup" class="horizontal" data-type="horizontal">\
                                            <legend><b>Relaxed:</b></legend>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="radio" name="radio-brelax" id="radio-brelax-a" value="1">\
                                            <label for="radio-brelax-a">1</label>\
                                            <input type="radio" name="radio-brelax" id="radio-brelax-b" value="2">\
                                            <label for="radio-brelax-b">2</label>\
                                            <input type="radio" name="radio-brelax" id="radio-brelax-c" value="3">\
                                            <label for="radio-brelax-c">3</label>\
                                            <input type="radio" name="radio-brelax" id="radio-brelax-d" value="4">\
                                            <label for="radio-brelax-d">4</label>\
                                            <input type="radio" name="radio-brelax" id="radio-brelax-e" value="5">\
                                            <label for="radio-brelax-e">5</label>\
                                            <input type="radio" name="radio-brelax" id="radio-brelax-f" value="6">\
                                            <label for="radio-brelax-f">6</label>\
                                            <input type="radio" name="radio-brelax" id="radio-brelax-g" value="7">\
                                            <label for="radio-brelax-g">7</label>\
                                            <input type="radio" name="radio-brelax" id="radio-brelax-h" value="8">\
                                            <label for="radio-brelax-h">8</label>\
                                            <input type="radio" name="radio-brelax" id="radio-brelax-i" value="9">\
                                            <label for="radio-brelax-i">9</label>\
                                            <input type="radio" name="radio-brelax" id="radio-brelax-j" value="10">\
                                            <label for="radio-brelax-j" class="horizontal-10">10</label>\
                                        </fieldset>\
                                    </form>\
                                    <div class="post-horizontal"></div>\
                                    <form>\
                                        <fieldset data-role="controlgroup" class="horizontal" data-type="horizontal">\
                                            <legend><b>Cheerful:</b></legend>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="radio" name="radio-bcheer" id="radio-bcheer-a" value="1">\
                                            <label for="radio-bcheer-a">1</label>\
                                            <input type="radio" name="radio-bcheer" id="radio-bcheer-b" value="2">\
                                            <label for="radio-bcheer-b">2</label>\
                                            <input type="radio" name="radio-bcheer" id="radio-bcheer-c" value="3">\
                                            <label for="radio-bcheer-c">3</label>\
                                            <input type="radio" name="radio-bcheer" id="radio-bcheer-d" value="4">\
                                            <label for="radio-bcheer-d">4</label>\
                                            <input type="radio" name="radio-bcheer" id="radio-bcheer-e" value="5">\
                                            <label for="radio-bcheer-e">5</label>\
                                            <input type="radio" name="radio-bcheer" id="radio-bcheer-f" value="6">\
                                            <label for="radio-bcheer-f">6</label>\
                                            <input type="radio" name="radio-bcheer" id="radio-bcheer-g" value="7">\
                                            <label for="radio-bcheer-g">7</label>\
                                            <input type="radio" name="radio-bcheer" id="radio-bcheer-h" value="8">\
                                            <label for="radio-bcheer-h">8</label>\
                                            <input type="radio" name="radio-bcheer" id="radio-bcheer-i" value="9">\
                                            <label for="radio-bcheer-i">9</label>\
                                            <input type="radio" name="radio-bcheer" id="radio-bcheer-j" value="10">\
                                            <label for="radio-bcheer-j" class="horizontal-10">10</label>\
                                        </fieldset>\
                                    </form>';


        var beforeTobEmoSurveyBData = {bsad:"",bstress:"",bangry:""};
        var beforeTobEmoSurveyBTemplate =  '<h3>Now think about the time <span style=”text-decoration:underline;”>just before</span> you used tobacco...</h3>\
                                    <h3>On a scale of 1-10</h3>\
                                    <h2>Before using tobacco, I felt:</h2>\
                                    <div class="post-header"></div>\
                                     <form>\
                                        <fieldset data-role="controlgroup" class="horizontal" data-type="horizontal">\
                                            <legend><b>Sad:</b></legend>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="radio" name="radio-bsad" id="radio-bsad-a" value="1">\
                                            <label for="radio-bsad-a">1</label>\
                                            <input type="radio" name="radio-bsad" id="radio-bsad-b" value="2">\
                                            <label for="radio-bsad-b">2</label>\
                                            <input type="radio" name="radio-bsad" id="radio-bsad-c" value="3">\
                                            <label for="radio-bsad-c">3</label>\
                                            <input type="radio" name="radio-bsad" id="radio-bsad-d" value="4">\
                                            <label for="radio-bsad-d">4</label>\
                                            <input type="radio" name="radio-bsad" id="radio-bsad-e" value="5">\
                                            <label for="radio-bsad-e">5</label>\
                                            <input type="radio" name="radio-bsad" id="radio-bsad-f" value="6">\
                                            <label for="radio-bsad-f">6</label>\
                                            <input type="radio" name="radio-bsad" id="radio-bsad-g" value="7">\
                                            <label for="radio-bsad-g">7</label>\
                                            <input type="radio" name="radio-bsad" id="radio-bsad-h" value="8">\
                                            <label for="radio-bsad-h">8</label>\
                                            <input type="radio" name="radio-bsad" id="radio-bsad-i" value="9">\
                                            <label for="radio-bsad-i">9</label>\
                                            <input type="radio" name="radio-bsad" id="radio-bsad-j" value="10">\
                                            <label for="radio-bsad-j" class="horizontal-10">10</label>\
                                        </fieldset>\
                                    </form>\
                                    <div class="post-horizontal"></div>\
                                    <form>\
                                        <fieldset data-role="controlgroup" class="horizontal" data-type="horizontal">\
                                            <legend><b>Stressed:</b></legend>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="radio" name="radio-bstress" id="radio-bstress-a" value="1">\
                                            <label for="radio-bstress-a">1</label>\
                                            <input type="radio" name="radio-bstress" id="radio-bstress-b" value="2">\
                                            <label for="radio-bstress-b">2</label>\
                                            <input type="radio" name="radio-bstress" id="radio-bstress-c" value="3">\
                                            <label for="radio-bstress-c">3</label>\
                                            <input type="radio" name="radio-bstress" id="radio-bstress-d" value="4">\
                                            <label for="radio-bstress-d">4</label>\
                                            <input type="radio" name="radio-bstress" id="radio-bstress-e" value="5">\
                                            <label for="radio-bstress-e">5</label>\
                                            <input type="radio" name="radio-bstress" id="radio-bstress-f" value="6">\
                                            <label for="radio-bstress-f">6</label>\
                                            <input type="radio" name="radio-bstress" id="radio-bstress-g" value="7">\
                                            <label for="radio-bstress-g">7</label>\
                                            <input type="radio" name="radio-bstress" id="radio-bstress-h" value="8">\
                                            <label for="radio-bstress-h">8</label>\
                                            <input type="radio" name="radio-bstress" id="radio-bstress-i" value="9">\
                                            <label for="radio-bstress-i">9</label>\
                                            <input type="radio" name="radio-bstress" id="radio-bstress-j" value="10">\
                                            <label for="radio-bstress-j" class="horizontal-10">10</label>\
                                        </fieldset>\
                                    </form>\
                                    <div class="post-horizontal"></div>\
                                    <form>\
                                        <fieldset data-role="controlgroup" class="horizontal" data-type="horizontal">\
                                            <legend><b>Angry:</b></legend>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="radio" name="radio-bangry" id="radio-bangry-a" value="1">\
                                            <label for="radio-bangry-a">1</label>\
                                            <input type="radio" name="radio-bangry" id="radio-bangry-b" value="2">\
                                            <label for="radio-bangry-b">2</label>\
                                            <input type="radio" name="radio-bangry" id="radio-bangry-c" value="3">\
                                            <label for="radio-bangry-c">3</label>\
                                            <input type="radio" name="radio-bangry" id="radio-bangry-d" value="4">\
                                            <label for="radio-bangry-d">4</label>\
                                            <input type="radio" name="radio-bangry" id="radio-bangry-e" value="5">\
                                            <label for="radio-bangry-e">5</label>\
                                            <input type="radio" name="radio-bangry" id="radio-bangry-f" value="6">\
                                            <label for="radio-bangry-f">6</label>\
                                            <input type="radio" name="radio-bangry" id="radio-bangry-g" value="7">\
                                            <label for="radio-bangry-g">7</label>\
                                            <input type="radio" name="radio-bangry" id="radio-bangry-h" value="8">\
                                            <label for="radio-bangry-h">8</label>\
                                            <input type="radio" name="radio-bangry" id="radio-bangry-i" value="9">\
                                            <label for="radio-bangry-i">9</label>\
                                            <input type="radio" name="radio-bangry" id="radio-bangry-j" value="10">\
                                            <label for="radio-bangry-j" class="horizontal-10">10</label>\
                                        </fieldset>\
                                    </form>';


        var beforeTobEmoSurveyCData = {bfrust:"",birritbl:"",bconfdnt:""};
        var beforeTobEmoSurveyCTemplate =  '<h3>Now think about the time <span style=”text-decoration:underline;”>just before</span> you used tobacco...</h3>\
                                    <h3>On a scale of 1-10</h3>\
                                    <h2>Before using tobacco, I felt:</h2>\
                                    <div class="post-header"></div>\
                                     <form>\
                                        <fieldset data-role="controlgroup" class="horizontal" data-type="horizontal">\
                                            <legend><b>Frustrated:</b></legend>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="radio" name="radio-bfrust" id="radio-bfrust-a" value="1">\
                                            <label for="radio-bfrust-a">1</label>\
                                            <input type="radio" name="radio-bfrust" id="radio-bfrust-b" value="2">\
                                            <label for="radio-bfrust-b">2</label>\
                                            <input type="radio" name="radio-bfrust" id="radio-bfrust-c" value="3">\
                                            <label for="radio-bfrust-c">3</label>\
                                            <input type="radio" name="radio-bfrust" id="radio-bfrust-d" value="4">\
                                            <label for="radio-bfrust-d">4</label>\
                                            <input type="radio" name="radio-bfrust" id="radio-bfrust-e" value="5">\
                                            <label for="radio-bfrust-e">5</label>\
                                            <input type="radio" name="radio-bfrust" id="radio-bfrust-f" value="6">\
                                            <label for="radio-bfrust-f">6</label>\
                                            <input type="radio" name="radio-bfrust" id="radio-bfrust-g" value="7">\
                                            <label for="radio-bfrust-g">7</label>\
                                            <input type="radio" name="radio-bfrust" id="radio-bfrust-h" value="8">\
                                            <label for="radio-bfrust-h">8</label>\
                                            <input type="radio" name="radio-bfrust" id="radio-bfrust-i" value="9">\
                                            <label for="radio-bfrust-i">9</label>\
                                            <input type="radio" name="radio-bfrust" id="radio-bfrust-j" value="10">\
                                            <label for="radio-bfrust-j" class="horizontal-10">10</label>\
                                        </fieldset>\
                                    </form>\
                                    <div class="post-horizontal"></div>\
                                    <form>\
                                        <fieldset data-role="controlgroup" class="horizontal" data-type="horizontal">\
                                            <legend><b>Irritable:</b></legend>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="radio" name="radio-birritbl" id="radio-birritbl-a" value="1">\
                                            <label for="radio-birritbl-a">1</label>\
                                            <input type="radio" name="radio-birritbl" id="radio-birritbl-b" value="2">\
                                            <label for="radio-birritbl-b">2</label>\
                                            <input type="radio" name="radio-birritbl" id="radio-birritbl-c" value="3">\
                                            <label for="radio-birritbl-c">3</label>\
                                            <input type="radio" name="radio-birritbl" id="radio-birritbl-d" value="4">\
                                            <label for="radio-birritbl-d">4</label>\
                                            <input type="radio" name="radio-birritbl" id="radio-birritbl-e" value="5">\
                                            <label for="radio-birritbl-e">5</label>\
                                            <input type="radio" name="radio-birritbl" id="radio-birritbl-f" value="6">\
                                            <label for="radio-birritbl-f">6</label>\
                                            <input type="radio" name="radio-birritbl" id="radio-birritbl-g" value="7">\
                                            <label for="radio-birritbl-g">7</label>\
                                            <input type="radio" name="radio-birritbl" id="radio-birritbl-h" value="8">\
                                            <label for="radio-birritbl-h">8</label>\
                                            <input type="radio" name="radio-birritbl" id="radio-birritbl-i" value="9">\
                                            <label for="radio-birritbl-i">9</label>\
                                            <input type="radio" name="radio-birritbl" id="radio-birritbl-j" value="10">\
                                            <label for="radio-birritbl-j" class="horizontal-10">10</label>\
                                        </fieldset>\
                                    </form>\
                                    <div class="post-horizontal"></div>\
                                    <form>\
                                        <fieldset data-role="controlgroup" class="horizontal" data-type="horizontal">\
                                            <legend><b>Confident:</b></legend>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="radio" name="radio-bconfdnt" id="radio-bconfdnt-a" value="1">\
                                            <label for="radio-bconfdnt-a">1</label>\
                                            <input type="radio" name="radio-bconfdnt" id="radio-bconfdnt-b" value="2">\
                                            <label for="radio-bconfdnt-b">2</label>\
                                            <input type="radio" name="radio-bconfdnt" id="radio-bconfdnt-c" value="3">\
                                            <label for="radio-bconfdnt-c">3</label>\
                                            <input type="radio" name="radio-bconfdnt" id="radio-bconfdnt-d" value="4">\
                                            <label for="radio-bconfdnt-d">4</label>\
                                            <input type="radio" name="radio-bconfdnt" id="radio-bconfdnt-e" value="5">\
                                            <label for="radio-bconfdnt-e">5</label>\
                                            <input type="radio" name="radio-bconfdnt" id="radio-bconfdnt-f" value="6">\
                                            <label for="radio-bconfdnt-f">6</label>\
                                            <input type="radio" name="radio-bconfdnt" id="radio-bconfdnt-g" value="7">\
                                            <label for="radio-bconfdnt-g">7</label>\
                                            <input type="radio" name="radio-bconfdnt" id="radio-bconfdnt-h" value="8">\
                                            <label for="radio-bconfdnt-h">8</label>\
                                            <input type="radio" name="radio-bconfdnt" id="radio-bconfdnt-i" value="9">\
                                            <label for="radio-bconfdnt-i">9</label>\
                                            <input type="radio" name="radio-bconfdnt" id="radio-bconfdnt-j" value="10">\
                                            <label for="radio-bconfdnt-j" class="horizontal-10">10</label>\
                                        </fieldset>\
                                    </form>';

        var visitedWhenUsingTobSurvey = false;

        var whenUsingTobSurveyData = {pleasur:"",satisfy:""};
        var whenUsingTobSurveyTemplate = '<h3>Now think about when you were using tobacco...</h3>\
                                            <h3>On a scale of 1-10</h3>\
                                            <div class="post-header"></div>\
                                            <form>\
                                                <fieldset data-role="controlgroup" class="horizontal" data-type="horizontal">\
                                                    <legend><b>How pleasurable was the product?</b></legend>\
                                                    <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                                    <input type="radio" name="radio-pleasur" id="radio-pleasur-a" value="1">\
                                                    <label for="radio-pleasur-a">1</label>\
                                                    <input type="radio" name="radio-pleasur" id="radio-pleasur-b" value="2">\
                                                    <label for="radio-pleasur-b">2</label>\
                                                    <input type="radio" name="radio-pleasur" id="radio-pleasur-c" value="3">\
                                                    <label for="radio-pleasur-c">3</label>\
                                                    <input type="radio" name="radio-pleasur" id="radio-pleasur-d" value="4">\
                                                    <label for="radio-pleasur-d">4</label>\
                                                    <input type="radio" name="radio-pleasur" id="radio-pleasur-e" value="5">\
                                                    <label for="radio-pleasur-e">5</label>\
                                                    <input type="radio" name="radio-pleasur" id="radio-pleasur-f" value="6">\
                                                    <label for="radio-pleasur-f">6</label>\
                                                    <input type="radio" name="radio-pleasur" id="radio-pleasur-g" value="7">\
                                                    <label for="radio-pleasur-g">7</label>\
                                                    <input type="radio" name="radio-pleasur" id="radio-pleasur-h" value="8">\
                                                    <label for="radio-pleasur-h">8</label>\
                                                    <input type="radio" name="radio-pleasur" id="radio-pleasur-i" value="9">\
                                                    <label for="radio-pleasur-i">9</label>\
                                                    <input type="radio" name="radio-pleasur" id="radio-pleasur-j" value="10">\
                                                    <label for="radio-pleasur-j" class="horizontal-10">10</label>\
                                                </fieldset>\
                                            </form>\
                                            <div class="post-horizontal"></div>\
                                            <form>\
                                                <fieldset data-role="controlgroup" class="horizontal" data-type="horizontal">\
                                                    <legend><b>How satisfying was the product?</b></legend>\
                                                    <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                                    <input type="radio" name="radio-satisfy" id="radio-satisfy-a" value="1">\
                                                    <label for="radio-satisfy-a">1</label>\
                                                    <input type="radio" name="radio-satisfy" id="radio-satisfy-b" value="2">\
                                                    <label for="radio-satisfy-b">2</label>\
                                                    <input type="radio" name="radio-satisfy" id="radio-satisfy-c" value="3">\
                                                    <label for="radio-satisfy-c">3</label>\
                                                    <input type="radio" name="radio-satisfy" id="radio-satisfy-d" value="4">\
                                                    <label for="radio-satisfy-d">4</label>\
                                                    <input type="radio" name="radio-satisfy" id="radio-satisfy-e" value="5">\
                                                    <label for="radio-satisfy-e">5</label>\
                                                    <input type="radio" name="radio-satisfy" id="radio-satisfy-f" value="6">\
                                                    <label for="radio-satisfy-f">6</label>\
                                                    <input type="radio" name="radio-satisfy" id="radio-satisfy-g" value="7">\
                                                    <label for="radio-satisfy-g">7</label>\
                                                    <input type="radio" name="radio-satisfy" id="radio-satisfy-h" value="8">\
                                                    <label for="radio-satisfy-h">8</label>\
                                                    <input type="radio" name="radio-satisfy" id="radio-satisfy-i" value="9">\
                                                    <label for="radio-satisfy-i">9</label>\
                                                    <input type="radio" name="radio-satisfy" id="radio-satisfy-j" value="10">\
                                                    <label for="radio-satisfy-j" class="horizontal-10">10</label>\
                                                </fieldset>\
                                            </form>';

		var productUrgeSurveyData = {ulcigarette:"", ulcigar:"", ucigarilo:"", ubcigar:"", uecig:"", uvap:"", uhookah:"", uchew:"", udipsnf:"", usnus:"", unourge:""};
        var productUrgeSurveyTemplate= '<h3>Right now: Do you have an urge to have/use any of the following tobacco products (check all that apply)?</h3>\
                                       <div id="productUrgeSurveyCheckboxes" data-role="fieldcontain">\
                                           <fieldset class="ui-grid-a">\
                                           \
                                                <div class="ui-block-a">\
                                                    <fieldset data-role="controlgroup">\
                                                        <input type="checkbox" name="checkbox-ulcigarette" id="checkbox-ulcigarette" class="check" />\
                                                        <label for="checkbox-ulcigarette">Cigarette</label>\
                                                        \
                                                        <input type="checkbox" name="checkbox-ulcigar" id="checkbox-ulcigar" class="check" />\
                                                        <label for="checkbox-ulcigar">Little Cigar</label>\
                                                        \
                                                        <input type="checkbox" name="checkbox-ucigarilo" id="checkbox-ucigarilo" class="check" />\
                                                        <label for="checkbox-ucigarilo">Cigarillo</label>\
                                                        \
                                                        <input type="checkbox" name="checkbox-ubcigar" id="checkbox-ubcigar" class="check" />\
                                                        <label for="checkbox-ubcigar">Big Cigar</label>\
                                                        \
                                                        <input type="checkbox" name="checkbox-uecig" id="checkbox-uecig" class="check" />\
                                                        <label for="checkbox-uecig">e-cigarette</label>\
                                                        \
                                                        <input type="checkbox" name="checkbox-uvap" id="checkbox-uvap" class="check" />\
                                                        <label for="checkbox-uvap">Vaporizer</label>\
                                                    </fieldset>\
                                                </div>\
                                                \
                                                <div class="ui-block-b">\
                                                    <fieldset data-role="controlgroup">\
                                                        <input type="checkbox" name="checkbox-uhookah" id="checkbox-uhookah" class="check" />\
                                                        <label for="checkbox-uhookah">Hookah</label>\
                                                        \
                                                        <input type="checkbox" name="checkbox-uchew" id="checkbox-uchew" class="check" />\
                                                        <label for="checkbox-uchew">Chew</label>\
                                                        \
                                                        <input type="checkbox" name="checkbox-udipsnf" id="checkbox-udipsnf" class="check" />\
                                                        <label for="checkbox-udipsnf">Dip or Snuff</label>\
                                                        \
                                                        <input type="checkbox" name="checkbox-usnus" id="checkbox-usnus" class="check" />\
                                                        <label for="checkbox-usnus">Snus</label>\
                                                        \
                                                        <input type="checkbox" name="checkbox-unourge" id="checkbox-unourge" class="check" />\
                                                        <label for="checkbox-unourge">No urge for any tobacco product</label>\
                                                    </fieldset>\
                                                </div>\
                                            </fieldset>\
                                        </div>';


        var currentActivitySurveyData = {hang:"", tvmus:"", phone:"", texting:"", compint:"", reading:"", schl:"", job:"", eatdrnk:"", alc:"", pot:"", party:"", phys:"", walking:"", club:"", trans:"", noth:"", other:""};
        var currentActivitySurveyTemplate =  '<h3>What are you doing?</h3>\
                                <div id="currentActivitySurveyCheckboxes" data-role="fieldcontain">\
                                   <fieldset class="ui-grid-a">\
                                   \
                                        <div class="ui-block-a">\
                                            <fieldset data-role="controlgroup">\
                                                <input type="checkbox" name="checkbox-hang" id="checkbox-hang" class="check" />\
                                                <label for="checkbox-hang">Hanging out</label>\
                                                \
                                                <input type="checkbox" name="checkbox-tvmus" id="checkbox-tvmus" class="check" />\
                                                <label for="checkbox-tvmus">TV, Music, or Movies</label>\
                                                \
                                                <input type="checkbox" name="checkbox-phone" id="checkbox-phone" class="check" />\
                                                <label for="checkbox-phone">Telephone</label>\
                                                \
                                                <input type="checkbox" name="checkbox-texting" id="checkbox-texting" class="check" />\
                                                <label for="checkbox-texting">Texting</label>\
                                                \
                                                <input type="checkbox" name="checkbox-compint" id="checkbox-compint" class="check" />\
                                                <label for="checkbox-compint">Computer</label>\
                                                \
                                                <input type="checkbox" name="checkbox-reading" id="checkbox-reading" class="check" />\
                                                <label for="checkbox-reading">Reading</label>\
                                                \
                                                <input type="checkbox" name="checkbox-schl" id="checkbox-schl" class="check" />\
                                                <label for="checkbox-schl">Class work</label>\
                                                \
                                                <input type="checkbox" name="checkbox-job" id="checkbox-job" class="check" />\
                                                <label for="checkbox-job">Job</label>\
                                                \
                                                <input type="checkbox" name="checkbox-eatdrnk" id="checkbox-eatdrnk" class="check" />\
                                                <label for="checkbox-eatdrnk">Eating or drinking</label>\
                                            </fieldset>\
                                        </div>\
                                        <div class="ui-block-b">\
                                            <fieldset data-role="controlgroup">\
                                                <input type="checkbox" name="checkbox-alc" id="checkbox-alc" class="check" />\
                                                <label for="checkbox-alc">Drinking alcohol</label>\
                                                \
                                                <input type="checkbox" name="checkbox-pot" id="checkbox-pot" class="check" />\
                                                <label for="checkbox-pot">Marijuana use</label>\
                                                \
                                                <input type="checkbox" name="checkbox-party" id="checkbox-party" class="check" />\
                                                <label for="checkbox-party">Party</label>\
                                                \
                                                <input type="checkbox" name="checkbox-phys" id="checkbox-phys" class="check" />\
                                                <label for="checkbox-phys">Physical activity or Sports</label>\
                                                \
                                                <input type="checkbox" name="checkbox-walking" id="checkbox-walking" class="check" />\
                                                <label for="checkbox-walking">Walking</label>\
                                                \
                                                <input type="checkbox" name="checkbox-club" id="checkbox-club" class="check" />\
                                                <label for="checkbox-club">Organized club</label>\
                                                \
                                                <input type="checkbox" name="checkbox-trans" id="checkbox-trans" class="check" />\
                                                <label for="checkbox-trans">Transit or Driving</label>\
                                                \
                                                <input type="checkbox" name="checkbox-noth" id="checkbox-noth" class="check" />\
                                                <label for="checkbox-noth">Nothing</label>\
                                                \
                                                <input type="checkbox" name="checkbox-other" id="checkbox-other" class="check" />\
                                                <label for="checkbox-other">Other</label>\
                                            </fieldset>\
                                        </div>\
                                    </fieldset>\
                                </div>';

        var wOthersSurveyData = {comp:""};
        var wOthersSurveyTemplate =  '<div id="wOthersSurveyRadios">\
                                          <fieldset data-role="controlgroup">\
                                          <legend>Are you with others?</legend>\
                                              <input type="radio" name="withothers" id="radio-comp1" value="1" class="radio" />\
                                              <label for="radio-comp1">Alone</label>\
                                              \
                                              <input type="radio" name="withothers" id="radio-comp2" value="2" class="radio" />\
                                              <label for="radio-comp2">Alone-others nearby</label>\
                                              \
                                              <input type="radio" name="withothers" id="radio-comp3" value="3" class="radio" />\
                                              <label for="radio-comp3">With other(s)</label>\
                                          </fieldset>\
                                       </div>';


        var whoNearbySurveyData = {alo_wthfam:"", alo_wthpart:"",alo_wthwork:"",alo_wthfr:"",alo_wthoth:""};
        var whoNearbySurveyTemplate = '<h3>Who is nearby?</h3>\
                                <div id="whoNearbySurveyCheckboxes" data-role="fieldcontain">\
                                    <fieldset data-role="controlgroup">\
                                        <input type="checkbox" name="checkbox-alo_wthfam" id="checkbox-alo_wthfam" class="check" />\
                                        <label for="checkbox-alo_wthfam">Family</label>\
                                        \
                                        <input type="checkbox" name="checkbox-alo_wthpart" id="checkbox-alo_wthpart" class="check" />\
                                        <label for="checkbox-alo_wthpart">Romantic Partner or Spouse</label>\
                                        \
                                        <input type="checkbox" name="checkbox-alo_wthwork" id="checkbox-alo_wthwork" class="check" />\
                                        <label for="checkbox-alo_wthwork">Coworkers</label>\
                                        \
                                        <input type="checkbox" name="checkbox-alo_wthfr" id="checkbox-alo_wthfr" class="check" />\
                                        <label for="checkbox-alo_wthfr">Friends or Peers</label>\
                                        \
                                        <input type="checkbox" name="checkbox-alo_wthoth" id="checkbox-alo_wthoth" class="check" />\
                                        <label for="checkbox-alo_wthoth">Other</label>\
                                    </fieldset>\
                                </div>';

        var whoFamilySurveyData = {alo_wthmom:"", alo_wthsib:"",alo_wthchild:"",alo_wthdad:"",alo_wthrel:""};
        var whoFamilySurveyTemplate = '<h3>Which family members are nearby (check all that apply)?</h3>\
                                <div id="whoFamilySurveyCheckboxes" data-role="fieldcontain">\
                                    <fieldset data-role="controlgroup">\
                                        <input type="checkbox" name="checkbox-alo_wthmom" id="checkbox-alo_wthmom" class="check" />\
                                        <label for="checkbox-alo_wthmom">Mother</label>\
                                        \
                                        <input type="checkbox" name="checkbox-alo_wthsib" id="checkbox-alo_wthsib" class="check" />\
                                        <label for="checkbox-alo_wthsib">Brother(s) or Sister(s)</label>\
                                        \
                                        <input type="checkbox" name="checkbox-alo_wthchild" id="checkbox-alo_wthchild" class="check" />\
                                        <label for="checkbox-alo_wthchild">Children</label>\
                                        \
                                        <input type="checkbox" name="checkbox-alo_wthdad" id="checkbox-alo_wthdad" class="check" />\
                                        <label for="checkbox-alo_wthdad">Father</label>\
                                        \
                                        <input type="checkbox" name="checkbox-alo_wthrel" id="checkbox-alo_wthrel" class="check" />\
                                        <label for="checkbox-alo_wthrel">Other Relative</label>\
                                    </fieldset>\
                                </div>';

        var nearbyProductUseSurveyData = {ocig:"", olcigar:"", ocigrilo:"", obcigar:"", oecig:"", ovap:"", ohookah:"", ochew:"", odipsnf:"", osnus:"", onone:""};
        var nearbyProductUseSurveyTemplate = '<h3>Are any of these people using any of the following tobacco products (check all that apply)?</h3>\
                                <div id="nearbyProductUseSurveyCheckboxes" data-role="fieldcontain">\
                                   <fieldset class="ui-grid-a">\
                                   \
                                        <div class="ui-block-a">\
                                            <fieldset data-role="controlgroup">\
                                                <input type="checkbox" name="checkbox-ocig" id="checkbox-ocig" class="check" />\
                                                <label for="checkbox-ocig">Cigarette</label>\
                                                \
                                                <input type="checkbox" name="checkbox-olcigar" id="checkbox-olcigar" class="check" />\
                                                <label for="checkbox-olcigar">Little Cigar</label>\
                                                \
                                                <input type="checkbox" name="checkbox-ocigrilo" id="checkbox-ocigrilo" class="check" />\
                                                <label for="checkbox-ocigrilo">Cigarillo</label>\
                                                \
                                                <input type="checkbox" name="checkbox-obcigar" id="checkbox-obcigar" class="check" />\
                                                <label for="checkbox-obcigar">Big Cigar</label>\
                                                \
                                                <input type="checkbox" name="checkbox-oecig" id="checkbox-oecig" class="check" />\
                                                <label for="checkbox-oecig">e-cigarette</label>\
                                                \
                                                <input type="checkbox" name="checkbox-ovap" id="checkbox-ovap" class="check" />\
                                                <label for="checkbox-ovap">Vaporizer</label>\
                                            </fieldset>\
                                        </div>\
                                        \
                                        <div class="ui-block-b">\
                                            <fieldset data-role="controlgroup">\
                                                <input type="checkbox" name="checkbox-ohookah" id="checkbox-ohookah" class="check" />\
                                                <label for="checkbox-ohookah">Hookah</label>\
                                                \
                                                <input type="checkbox" name="checkbox-ochew" id="checkbox-ochew" class="check" />\
                                                <label for="checkbox-ochew">Chew</label>\
                                                \
                                                <input type="checkbox" name="checkbox-odipsnf" id="checkbox-odipsnf" class="check" />\
                                                <label for="checkbox-odipsnf">Dip or Snuff</label>\
                                                \
                                                <input type="checkbox" name="checkbox-osnus" id="checkbox-osnus" class="check" />\
                                                <label for="checkbox-osnus">Snus</label>\
                                                \
                                                <input type="checkbox" name="checkbox-onone" id="checkbox-onone" class="check" />\
                                                <label for="checkbox-onone">No one was using a tobacco product</label>\
                                            </fieldset>\
                                        </div>\
                                    </fieldset>\
                                </div>';

        var locationSurveyData= {locat3:""};
        var locationSurveyTemplate= '<h3>Right now, where are you?</h3>\
                                      <div id="locationSurveyRadios" data-role="fieldcontain">\
                                           <fieldset class="ui-grid-a">\
                                           \
                                                <div class="ui-block-a">\
                                                    <fieldset data-role="controlgroup">\
                                                        <input type="radio" name="whereareyou" id="radio-locat31" value="1" class="radio"/>\
                                                        <label for="radio-locat31">Your home</label>\
                                                        \
                                                        <input type="radio" name="whereareyou" id="radio-locat32" value="2" class="radio"/>\
                                                        <label for="radio-locat32">Parent\'s home</label>\
                                                        \
                                                        <input type="radio" name="whereareyou" id="radio-locat33" value="3" class="radio"/>\
                                                        <label for="radio-locat33">Friend\'s home</label>\
                                                        \
                                                        <input type="radio" name="whereareyou" id="radio-locat34" value="4" class="radio"/>\
                                                        <label for="radio-locat34">School</label>\
                                                        \
                                                        <input type="radio" name="whereareyou" id="radio-locat35" value="5" class="radio"/>\
                                                        <label for="radio-locat35">Work</label>\
                                                        \
                                                        <input type="radio" name="whereareyou" id="radio-locat36" value="6" class="radio"/>\
                                                        <label for="radio-locat36">In car</label>\
                                                        \
                                                        <input type="radio" name="whereareyou" id="radio-locat37" value="7" class="radio"/>\
                                                        <label for="radio-locat37">Other transit</label>\
                                                        \
                                                        <input type="radio" name="whereareyou" id="radio-locat38" value="8" class="radio"/>\
                                                        <label for="radio-locat38">Bar or club</label>\
                                                    </fieldset>\
                                                </div>\
                                                <div class="ui-block-b">\
                                                    <fieldset data-role="controlgroup">\
                                                        <input type="radio" name="whereareyou" id="radio-locat39" value="9" class="radio"/>\
                                                        <label for="radio-locat39">Coffee shop</label>\
                                                        \
                                                        <input type="radio" name="whereareyou" id="radio-locat310" value="10" class="radio"/>\
                                                        <label for="radio-locat310">Restaurant</label>\
                                                        \
                                                        <input type="radio" name="whereareyou" id="radio-locat311" value="11" class="radio"/>\
                                                        <label for="radio-locat311">Hookah lounge</label>\
                                                        \
                                                        <input type="radio" name="whereareyou" id="radio-locat312" value="12" class="radio"/>\
                                                        <label for="radio-locat312">Sport venue</label>\
                                                        \
                                                        <input type="radio" name="whereareyou" id="radio-locat313" value="13" class="radio"/>\
                                                        <label for="radio-locat313">Entertainment venue</label>\
                                                        \
                                                        <input type="radio" name="whereareyou" id="radio-locat314" value="14" class="radio"/>\
                                                        <label for="radio-locat314">Outside-public property</label>\
                                                        \
                                                        <input type="radio" name="whereareyou" id="radio-locat315" value="15" class="radio" />\
                                                        <label for="radio-locat315">Other</label>\
                                                    </fieldset>\
                                                </div>\
                                           </fieldset>\
                                      </div>';

        var firstRadioSetSurveyData={smklocat:"", antimsg:"", promsg: ""};
        var firstRadioSetSurveyTemplate= '<div id="firstRadioSetSurveyRadios">\
                                                <fieldset data-role="controlgroup">\
                                                    <legend>Is smoking cigarettes allowed in this location?</legend>\
                                                        <input type="radio" name="smokinglocation" id="radio-smklocat2" value="2" class="radio"/>\
                                                        <label for="radio-smklocat2">Yes</label>\
                                                        \
                                                        <input type="radio" name="smokinglocation" id="radio-smklocat1" value="1" class="radio"/>\
                                                        <label for="radio-smklocat1">No</label>\
                                                </fieldset>\
                                                \
                                                <fieldset data-role="controlgroup">\
                                                    <legend>In the last hour, have you seen or heard any anti-smoking or stop-smoking messages?</legend>\
                                                        <input type="radio" name="antimessage" id="radio-antimsg2" value="2" class="radio"/>\
                                                        <label for="radio-antimsg2">Yes</label>\
                                                        \
                                                        <input type="radio" name="antimessage" id="radio-antimsg1" value="1" class="radio"/>\
                                                        <label for="radio-antimsg1">No</label>\
                                                </fieldset>\
                                                \
                                                <fieldset data-role="controlgroup">\
                                                    <legend>In the last hour, have you seen or heard any cigarette or tobacco promotions or advertising?</legend>\
                                                        <input type="radio" name="promessage" id="radio-promsg2" value="2" class="radio"/>\
                                                        <label for="radio-promsg2">Yes</label>\
                                                        \
                                                        <input type="radio" name="promessage" id="radio-promsg1" value="1" class="radio"/>\
                                                        <label for="radio-promsg1">No</label>\
                                                </fieldset>\
                                           </div>';


        var secondRadioSetSurveyData={alchour:"", pothour:""};
        var secondRadioSetSurveyTemplate= '<div id="secondRadioSetSurveyRadios">\
                                                <fieldset data-role="controlgroup">\
                                                    <legend>Did you drink alcohol in the last hour?</legend>\
                                                        <input type="radio" name="alcoholhour" id="radio-alchour2" value="2" class="radio"/>\
                                                        <label for="radio-alchour2">Yes</label>\
                                                        \
                                                        <input type="radio" name="alcoholhour" id="radio-alchour1" value="1" class="radio"/>\
                                                        <label for="radio-alchour1">No</label>\
                                                </fieldset>\
                                                \
                                                <fieldset data-role="controlgroup">\
                                                    <legend>Have you used marijuana in the last hour?</legend>\
                                                        <input type="radio" name="pothour" id="radio-pothour2" value="2" class="radio"/>\
                                                        <label for="radio-pothour2">Yes</label>\
                                                        \
                                                        <input type="radio" name="pothour" id="radio-pothour1" value="1" class="radio"/>\
                                                        <label for="radio-pothour1">No</label>\
                                                </fieldset>\
                                            </div>';


        var tobProductSurveyData={TUProduct:""};
        var tobProductSurveyTemplate='<h3>What type of tobacco product did you use?</h3>\
                                      <div id="tobProductSurveyRadios" data-role="fieldcontain">\
                                           <fieldset class="ui-grid-a">\
                                                <div class="ui-block-a">\
                                                    <fieldset data-role="controlgroup">\
                                                        <input type="radio" name="productused" id="radio-tuproduct1" value="1" class="radio"/>\
                                                        <label for="radio-tuproduct1">Cigarette</label>\
                                                        \
                                                        <input type="radio" name="productused" id="radio-tuproduct2" value="2" class="radio"/>\
                                                        <label for="radio-tuproduct2">Little Cigar</label>\
                                                        \
                                                        <input type="radio" name="productused" id="radio-tuproduct3" value="3" class="radio"/>\
                                                        <label for="radio-tuproduct3">Cigarillo</label>\
                                                        \
                                                        <input type="radio" name="productused" id="radio-tuproduct4" value="4" class="radio"/>\
                                                        <label for="radio-tuproduct4">Big Cigar</label>\
                                                        \
                                                        <input type="radio" name="productused" id="radio-tuproduct5" value="5" class="radio"/>\
                                                        <label for="radio-tuproduct5">e-cigarette</label>\
                                                        \
                                                    </fieldset>\
                                                </div>\
                                                <div class="ui-block-b">\
                                                    <fieldset data-role="controlgroup">\
                                                        <input type="radio" name="productused" id="radio-tuproduct6" value="6" class="radio"/>\
                                                        <label for="radio-tuproduct6">Vaporizer</label>\
                                                        \
                                                        <input type="radio" name="productused" id="radio-tuproduct7" value="7" class="radio"/>\
                                                        <label for="radio-tuproduct7">Hookah</label>\
                                                        \
                                                        <input type="radio" name="productused" id="radio-tuproduct8" value="8" class="radio"/>\
                                                        <label for="radio-tuproduct8">Chew</label>\
                                                        \
                                                        <input type="radio" name="productused" id="radio-tuproduct9" value="9" class="radio"/>\
                                                        <label for="radio-tuproduct9">Dip/Snuff</label>\
                                                        \
                                                        <input type="radio" name="productused" id="radio-tuproduct10" value="10" class="radio"/>\
                                                        <label for="radio-tuproduct10">Snus</label>\
                                                    </fieldset>\
                                                </div>\
                                           </fieldset>\
                                      </div>';


        var cigMentholSurveyData = {cigment:""};
        var cigMentholSurveyTemplate = '<h3>For <span style=”text-decoration:underline;”>cigarette</span>, was the cigarette menthol?</h3>\
                                            <div id="cigMentholSurveyRadios" align="center">\
                                                <fieldset data-role="controlgroup">\
                                                    <input type="radio" name="cigmenthol" id="radio-menthol2" value="2" class="radio"/>\
                                                    <label for="radio-menthol2">Yes</label>\
                                                    \
                                                    <input type="radio" name="cigmenthol" id="radio-menthol1" value="1" class="radio"/>\
                                                    <label for="radio-menthol1">No</label>\
                                                </fieldset>\
                                             </div>';

        var suspenddata = {suspendval:""};
        var suspendTemplate = '<h3>Select a period and a reason for suspending the application:</h3>\
                                <form id="suspend-form">\
                                    <fieldset data-role="fieldcontain">\
                                        <label for="suspend-select1">Select suspend amount</label>\
                                        <select name="suspend-select1" id="suspend-select1" data-native-menu="false">\
                                            <option value="30">30 mins</option>\
                                            <option value="60">60 mins</option>\
                                            <option value="90">1.5 hrs</option>\
                                            <option value="120">2 hrs</option>\
                                            <option value="150">2.5 hrs</option>\
                                            <option value="180">3 hrs</option>\
                                            <option value="210">3.5 hrs</option>\
                                            <option value="240">4 hrs</option>\
                                        </select>\
                                    \
                                        <label for="suspend-select2">Select the reason for suspension</label>\
                                        <select name="suspend-select2" id="suspend-select2" data-native-menu="false">\
                                            <option value="0">...    </option>\
                                            <option value="1">Transit</option>\
                                            <option value="2">Class</option>\
                                            <option value="3">Org. Activity</option>\
                                            <option value="4">Quiet Place</option>\
                                            <option value="5">Nap</option>\
                                            <option value="6">Job</option>\
                                            <option value="7">Other</option>\
                                        </select>\
                                    </fieldset>\
                                 </form>';

        var wakeTimedata = {wakeTimedata:""};
        var wakeTimeTemplate = '<div data-role="fieldcontain">\
                                    <label for="wscroller">Wake Time:</label>\
                                    <input id="wscroller" name="wscroller" placeholder="tap to enter your wake time..."/>\
                                </div>';


        var problemreportdata = {problemreporttitle:"", problemreportdetail:""};
        var problemreportTemplate = '<label for="problemdetail">Enter the problem below, and hit \'submit report\'</label>\
                <textarea id="problemdetail" name="notestextarea" form="notes" placeholder="Tap to enter the problem"></textarea>';

        var referencedata = {referencedata:""};
        var referenceTemplate = '<div data-role="collapsible-set">\
                                <div data-role="collapsible">\
                                    <h3>Interviews</h3>\
                                    <p>Reference for different aspects of the Tobacco Use Interview & Random Prompt Interview</p>\
                                    <div data-role="collapsible" id="reference-surveym">\
                                        <h3>Tobacco Use Interview</h3>\
                                        <p>This interview is to be completed by the user whenever they finish a tobacco product.</p> \
                                        <p>Simply log in to the application and as long as there is no Random Prompt Notification which has fired within three minutes, you will be taken to the main menu.</p>\
                                         <p>From the main menu tap "Tobacco Use Interview"\
                                         and complete the questionnaire until you are alerted to the interview being recorded and have been taken back to the main menu.</p>\
                                    </div>\
                                    <div data-role="collapsible" id="reference-surveyA">\
                                        <h3>Random Prompt Interview</h3>\
                                        <p>You will receive seven Random Prompt Notifications every 24 hours. Please complete as many interviews as possible when notified</p>\
                                        <p>Simply tap on the notification once it pops up in your Android phone\'s status bar.</p>\
                                        <p>This will open up the application and allow you to log in. The only way to take a Random Prompt Interview is if a Random Prompt Notification has fired within the last three minutes.\
                                        Any Random Prompt Notification that is currently within the status bar will be cleared and the app will record any missed Random Prompt Notifications.</p>\
                                        <p>Please answer all questions contained within the Random Prompt Interview.\
                                        Once you complete the interview, you will be taken back to the main menu.</p>\
                                        <p><b>Please note:</b> if you navigate away from the interview before finishing, or take longer than five minutes to complete the random prompt interview, the application will register the interview as being abandoned.</p>\
                                    </div>\
                                    <div data-role="collapsible" id="reference-surveywidgets">\
                                        <h3>Interview Questions</h3>\
                                        <p>Intensity questions- Simply tap the relevant value of intensity that pertains to its labelled emotion. \
                                        You cannot drag along the widget to select a value, you can only tap an individual value.</p>\
                                        <p>Example:</p>\
                                            <form>\
                                                <fieldset data-role="controlgroup" class="horizontal" data-type="horizontal">\
                                                    <legend><b>Happy:</b></legend>\
                                                    <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                                    <input type="radio" name="radio-happy" id="radio-happy-a" value="1">\
                                                    <label for="radio-happy-a">1</label>\
                                                    <input type="radio" name="radio-happy" id="radio-happy-b" value="2">\
                                                    <label for="radio-happy-b">2</label>\
                                                    <input type="radio" name="radio-happy" id="radio-happy-c" value="3">\
                                                    <label for="radio-happy-c">3</label>\
                                                    <input type="radio" name="radio-happy" id="radio-happy-d" value="4">\
                                                    <label for="radio-happy-d">4</label>\
                                                    <input type="radio" name="radio-happy" id="radio-happy-e" value="5">\
                                                    <label for="radio-happy-e">5</label>\
                                                    <input type="radio" name="radio-happy" id="radio-happy-f" value="6">\
                                                    <label for="radio-happy-f">6</label>\
                                                    <input type="radio" name="radio-happy" id="radio-happy-g" value="7">\
                                                    <label for="radio-happy-g">7</label>\
                                                    <input type="radio" name="radio-happy" id="radio-happy-h" value="8">\
                                                    <label for="radio-happy-h">8</label>\
                                                    <input type="radio" name="radio-happy" id="radio-happy-i" value="9">\
                                                    <label for="radio-happy-i">9</label>\
                                                    <input type="radio" name="radio-happy" id="radio-happy-j" value="10">\
                                                    <label for="radio-happy-j" class="horizontal-10">10</label>\
                                                </fieldset>\
                                            </form>\
                                        <p>Checkbox questions- Check all choices that match the questionnaire at the top of the interview page.</p>\
                                        <p>Example:</p>\
                                        <div data-role="fieldcontain">\
                                            <fieldset data-role="controlgroup">\
                                                <input type="checkbox" name="reference-check1" id="reference-check1" class="check" />\
                                                <label for="reference-check1">Checkbox 1</label>\
                                                <input type="checkbox" name="reference-check2" id="reference-check2" class="check" />\
                                                <label for="reference-check2">Checkbox 2</label>\
                                                <input type="checkbox" name="reference-check3" id="reference-check3" class="check" />\
                                                <label for="reference-check3">Checkbox 3</label>\
                                                <input type="checkbox" name="reference-check4" id="reference-check4" class="check" />\
                                                <label for="reference-check4">Checkbox 4</label>\
                                                <input type="checkbox" name="reference-check5" id="reference-check5" class="check" />\
                                                <label for="reference-check5">Checkbox 5</label>\
                                            </fieldset>\
                                        </div>\
                                        <p>Radiobox questions- Check only one response that matches the questionnaire at the top of the interview page. \
                                        These questions function the same as checkbox questions, but will only accept one answer instead of multiple answers.</p>\
                                        <p>Example: </p>\
                                        <div data-role="fieldcontain">\
                                            <fieldset data-role="controlgroup">\
                                                <input type="radio" name="reference-radio" id="reference-radio1" class="radio" />\
                                                <label for="reference-radio1">Radiobox 1</label>\
                                                <input type="radio" name="reference-radio" id="reference-radio2" class="radio" />\
                                                <label for="reference-radio2">Radiobox 2</label>\
                                                <input type="radio" name="reference-radio" id="reference-radio3" class="radio" />\
                                                <label for="reference-radio3">Radiobox 3</label>\
                                            </fieldset>\
                                        </div>\
                                    </div>\
                                </div>\
                                \
                                <div data-role="collapsible">\
                                    <h3>Random Prompt Notifications</h3>\
                                    <img src="img/icon.png" style="text-align: center;">\
                                    <p>The above image shows you the icon that accompanies Random Prompt Notifications.</p>\
                                    <p>Random Prompt Notifications will appear in the status bar at the top of the screen.</p>\
                                    <p>Click the button below to fire off an example Random Prompt Notification.</p>\
                                    <a href="#" data-role="button" onclick="fireExampleNotif()">Click here to fire a Random Prompt Notification</a>\
                                </div>\
                                \
                                <div data-role="collapsible">\
                                    <h3>Bedtime</h3>\
                                    <p>Use the time scroll wheel to set an alarm for the application.</p>\
                                    <p>From the time you set this alarm until the time the alarm goes off, you will not receive Random Prompt Notifications.</p>\
                                    <p>Upon the alarm going off, you will receive Random Prompt Notifications again for that day.</p>\
                                </div>\
                                \
                                <div data-role="collapsible">\
                                    <h3>Suspend</h3>\
                                    <p>Select a period of time from the drop-down menu on the left for which you do not want to receive Random Prompt Notifications. This will cancel all future Random Prompt Notifications that lie within the selected time limit.</p>\n\n\
                                    <p>Be aware that you are supposed to complete around seven Random Prompt Interviews each day.</p>\n\n\
                                    <p>Select the reason for suspending Random Prompt Notification on the right drop-down menu.</p>\
                                </div>\
                            </div>';

        /*
        <div data-role="collapsible">\
        <h3>Notifs</h3>\
        <p>Click the button below to see an example of the notif that will be sent to your device throughout the day.</p>\
        <a href="#" data-role="button" onclick="fireExampleNotif()">Click here for a notif</a>\
        </div>\
        */

		$(document).on("pageinit",function(){

            /*
            Initializing OLD slider code... no longer need now that sliders are replaced with horizontal radio groups

            $(".ui-slider-input").prop("readonly", true);

            var ticks2 = "<div class='tick' id='ticka'></div>"
            ticks2 += "<div class='tick' id='tickb'></div>";
            ticks2 += "<div class='tick' id='tickc'></div>";
            ticks2 += "<div class='tick' id='tickd'></div>";
            ticks2 += "<div class='tick' id='ticke'></div>";
            ticks2 += "<div class='tick' id='tickf'></div>";
            ticks2 += "<div class='tick' id='tickg'></div>";
            ticks2 += "<div class='tick' id='tickh'></div>";
            ticks2 += "<div class='number' id='number1'>1</div>";
            ticks2 += "<div class='number' id='numbera'>2</div>";
            ticks2 += "<div class='number' id='numberb'>3</div>";
            ticks2 += "<div class='number' id='numberc'>4</div>";
            ticks2 += "<div class='number' id='numberd'>5</div>";
            ticks2 += "<div class='number' id='numbere'>6</div>";
            ticks2 += "<div class='number' id='numberf'>7</div>";
            ticks2 += "<div class='number' id='numberg'>8</div>";
            ticks2 += "<div class='number' id='numberh'>9</div>";
            ticks2 += "<div class='number' id='number10'>10</div>";


            $("div.ui-slider-track").append(ticks2);



            console.log('\nvisitedEmoSurveyA: ' + visitedEmoSurveyA);
            console.log('\nvisitedEmoSurveyB: ' + visitedEmoSurveyB);
            console.log('\nvisitedEmoSurveyC: ' + visitedEmoSurveyC);


            if(!visitedEmoSurveyA){
                $("#emoSurveyA .jquerymobileslidercont .ui-slider-handle").css("left", "50%");
            }

            if(!visitedEmoSurveyB){
                $("#emoSurveyB .jquerymobileslidercont .ui-slider-handle").css("left", "50%");
            }

            if(!visitedEmoSurveyC){
                $("#emoSurveyC .jquerymobileslidercont .ui-slider-handle").css("left", "50%");
            }

            if(!visitedBeforeTobEmoSurveyA){
                $("#beforeTobEmoSurveyA .jquerymobileslidercont .ui-slider-handle").css("left", "50%");
            }

            if(!visitedBeforeTobEmoSurveyB){
                $("#beforeTobEmoSurveyB .jquerymobileslidercont .ui-slider-handle").css("left", "50%");
            }

            if(!visitedBeforeTobEmoSurveyC){
                $("#beforeTobEmoSurveyC .jquerymobileslidercont .ui-slider-handle").css("left", "50%");
            }

            if(!visitedWhenUsingTobSurvey){
                $("#whenUsingTobSurvey .jquerymobileslidercont .ui-slider-handle").css("left", "50%");
            }

            */

            $('#wscroller').mobiscroll().time({
                theme: 'default',
                display: 'modal',
                mode: 'scroller',
                setText: 'Ok',
                cancelText: 'Cancel',
                headerText: 'Set your wake time'
            });


            $('#wscroller').mobiscroll({preset: 'time', onSelect: function(valueText, inst){
                console.log(valueText);



            }});
            $('#wscroller').mobiscroll('option', { stepMinute: 5 });




            $("#delay").on("pagecreate", function(){
                var html = Mustache.to_html(delayTemplate, delayData);
                $("#delaycontent").html(html);
                //$("#ajaxSpinner").hide("fast");
            });


            $("#main").on("pagecreate", function(){
                //Change size of survey button and it's font size
                $("#button-mainsurvey").css('height','50px');
                //$("#button-mainsurvey").children().children().css('font-size','28px');

            });

            //#whichprompt  is not used anymore
            $("#whichprompt").on("pagecreate", function(){
                $("#button-whichprompt-yes").css('height','50px');
                $("#button-whichprompt-yes").css('width','150px');
                $("#button-whichprompt-yes").css('text-align','center');
                //$("#button-whichprompt-yes").children().children().css('font-size','28px');

                $("#button-whichprompt-no").css('height','50px');
                $("#button-whichprompt-no").css('width','150px');
                $("#button-whichprompt-no").css('text-align','center');
                //$("#button-whichprompt-no").children().children().css('font-size','28px');
            });

            $("#emoSurveyA").on("pagecreate", function(){
				var html = Mustache.to_html(emoSurveyATemplate, emoSurveyAData);
				$("#emoSurveyAcontent").html(html);

                //$(".jqmslidercontemoSurveyA .ui-slider-track").prepend(ticks);
			});


            $("#emoSurveyB").on("pagecreate", function(){
                var html = Mustache.to_html(emoSurveyBTemplate, emoSurveyBData);
                $("#emoSurveyBcontent").html(html);

                //$(".jqmslidercontemoSurveyB .ui-slider-track").prepend(ticks);
            });


            $("#emoSurveyC").on("pagecreate", function(){
                var html = Mustache.to_html(emoSurveyCTemplate, emoSurveyCData);
                $("#emoSurveyCcontent").html(html);

                //$(".jqmslidercontemoSurveyC .ui-slider-track").prepend(ticks);
            });



            $("#beforeTobEmoSurveyA").on("pagecreate", function(){
                var html = Mustache.to_html(beforeTobEmoSurveyATemplate, beforeTobEmoSurveyAData);
                $("#beforeTobEmoSurveyAcontent").html(html);

                //$(".jqmslidercontbefEmoSurveyA .ui-slider-track").prepend(ticks);

            });


            $("#beforeTobEmoSurveyB").on("pagecreate", function(){
                var html = Mustache.to_html(beforeTobEmoSurveyBTemplate, beforeTobEmoSurveyBData);
                $("#beforeTobEmoSurveyBcontent").html(html);

                //$(".jqmslidercontbefEmoSurveyB .ui-slider-track").prepend(ticks);

            });


            $("#beforeTobEmoSurveyC").on("pagecreate", function(){
                var html = Mustache.to_html(beforeTobEmoSurveyCTemplate, beforeTobEmoSurveyCData);
                $("#beforeTobEmoSurveyCcontent").html(html);

                //$(".jqmslidercontbefEmoSurveyC .ui-slider-track").prepend(ticks);

            });

            $("#whenUsingTobSurvey").on("pagecreate", function(){
                var html = Mustache.to_html(whenUsingTobSurveyTemplate, whenUsingTobSurveyData);
                $("#whenUsingTobSurveycontent").html(html);

                //$(".jqmslidercontwhenUsingSurvey .ui-slider-track").prepend(ticks);

            });


            $("#productUrgeSurvey").on("pagecreate", function(){
                var html = Mustache.to_html(productUrgeSurveyTemplate, productUrgeSurveyData);
                $("#productUrgeSurveyContent").html(html);
            });

            $("#currentActivitySurvey").on("pagecreate", function(){
                var html = Mustache.to_html(currentActivitySurveyTemplate, currentActivitySurveyData);
                $("#currentActivitySurveyContent").html(html);
            });

            $("#wOthersSurvey").on("pagecreate", function(){
                var html = Mustache.to_html(wOthersSurveyTemplate, wOthersSurveyData);
                $("#wOthersSurveyContent").html(html);
            });

            $("#whoNearbySurvey").on("pagecreate", function(){
                var html = Mustache.to_html(whoNearbySurveyTemplate, whoNearbySurveyData);
                $("#whoNearbySurveyContent").html(html);

                //console.log("\nwithin whoNearbySurvey.on(\"pagecreate\")");
            });

            $("#whoFamilySurvey").on("pagecreate", function(){
                var html = Mustache.to_html(whoFamilySurveyTemplate, whoFamilySurveyData);
                $("#whoFamilySurveyContent").html(html);
                //console.log("\nwithin whoFamilySurvey.on(\"pagecreate\")");
            });

            $("#nearbyProductUseSurvey").on("pagecreate", function(){
                var html = Mustache.to_html(nearbyProductUseSurveyTemplate, nearbyProductUseSurveyData);
                $("#nearbyProductUseSurveyContent").html(html);
                //console.log("\nwithin nearbyProductUseSurvey.on(\"pagecreate\")");
            });

            $("#locationSurvey").on("pagecreate", function(){
                var html = Mustache.to_html(locationSurveyTemplate, locationSurveyData);
                $("#locationSurveyContent").html(html);
                //console.log("\nwithin locationSurvey.on(\"pagecreate\")");
            });

            $("#firstRadioSetSurvey").on("pagecreate", function(){
                var html = Mustache.to_html(firstRadioSetSurveyTemplate, firstRadioSetSurveyData);
                $("#firstRadioSetSurveyContent").html(html);
                //console.log("\nwithin firstRadioSetSurvey.on(\"pagecreate\")");
            });

            $("#secondRadioSetSurvey").on("pagecreate", function(){
                var html = Mustache.to_html(secondRadioSetSurveyTemplate, secondRadioSetSurveyData);
                $("#secondRadioSetSurveyContent").html(html);
                //console.log("\nwithin secondRadioSetSurvey.on(\"pagecreate\")");
            });

            $("#tobProductSurvey").on("pagecreate", function(){
                var html = Mustache.to_html(tobProductSurveyTemplate, tobProductSurveyData);
                $("#tobProductSurveyContent").html(html);
            });

            $("#cigMentholSurvey").on("pagecreate", function(){
                var html = Mustache.to_html(cigMentholSurveyTemplate, cigMentholSurveyData);
                $("#cigMentholSurveyContent").html(html);
            });

			$("#suspend").on("pagecreate", function(){
				var html = Mustache.to_html(suspendTemplate, suspenddata);
				$("#suspendcontent").html(html);
			});


			$("#wakeTime").on("pagecreate",function(){
				var html3 = Mustache.to_html(wakeTimeTemplate, wakeTimedata);
                $("#wakeTimecontent").html(html3);

                $('#wscroller').mobiscroll({onSelect: function(valueText, inst){
                    console.log(valueText);
                }});
			});

			$("#problemreport").on("pagecreate",function(){
				var html4 = Mustache.to_html(problemreportTemplate, problemreportdata);
				$("#problemreportcontent").html(html4);

                $("#problemdetail").height(100);
			});

			$("#reference").on("pagecreate",function(){
				var html5 = Mustache.to_html(referenceTemplate, referencedata);
				$("#referencecontent").html(html5);
			});

            $("#wakeup").on("pagecreate",function(){
                $("#button-wakeup").css('height','100px');
                $("#button-wakeup").children().children().css('font-size','40px');
                $("#button-snooze").css('height','100px');
                $("#button-snooze").children().children().css('font-size','40px');
            });
		});

        $(document).on('pagebeforecreate', '[data-role="page"]', function(){
            setTimeout(function(){
                $.mobile.loading('show');
            },1);
        });

        $(document).on('pageshow', '[data-role="page"]', function(){
            setTimeout(function(){
                $.mobile.loading('hide');
            },300);
        });


        //Disables the 'back' hardware button on the phone
        function onBackKeyDown(e) {
            e.preventDefault();
        }


        function userHasGoneIdle(){
            //window.plugin.backgroundMode.enable();

            idOfNotMissedNotif = -1;

            //If user goes idle and has started a random prompt survey but has not finished it before going idle,
            //Need to record a survey as being abandoned
            if(startedRandomPromptSurvey && !finishedRandomPromptSurvey){
                //If a user delays a notif, don't want to add to missing notifs file yet.
                if(currentState != states.DELAYED){
                    //hasMissedNotif = true;
                    //addToMissedNotifs(1, moment().format('dddd, MMMM Do, HH:mm:ss a'));
                    addToMissedNotifs(1, moment().toDate().toString());
                    startedRandomPromptSurvey = false;
                    finishedRandomPromptSurvey = false;
                    rptStartTime = null;
                }
                //If a user clicks a notif (indicates that they have started a random prompt interview), delays notif,
                //then misses the delayed notif, it will register both an abandoned as well as a missed, when really they have only missed
                //the last delayed notif
            }

            writingToRandomPromptInt = false;
            $("#login-password").val('');

            resetSurveyWidgets();
            rptStartTime = null;

            window.plugin.notification.local.getScheduledIds(function (scheduledIds) {
                //if no, or only one notif to be scheduled, repopulate

                console.log("\nLENGTH OF scheduledIds: " + scheduledIds.length);

                //console.log("\n@ onResume notifCount: " + notifCount);

                //IN CASE OF # of NOTIFICATIONS REACHING 0, REPOPULATE
                // Also,
                //ODD BUG WHERE NOTIFICATIONS WILL NOT BE CLEARED PRIOR TO BEING ADDED... GENERALLY MORE THAN 2x SURVEYSINADAY will be added with duplicate notifs in a day
                //2.5 because num would be greater than 2x surveysaday, but delaying a notif will also increase length, so there could legitimately be more than 2x surveys a day
                //Also, in case of last notif fire, need to check if it has been dealt with before repopulating notifs, otherwise
                //clicking on the notif will cause app to resume > repopulate > register no notifs having fired within 3 minutes, won't go to
                //RPT, or could mislabel the notif as being missed
                //if((scheduledIds.length < 1 && dealtWithLastNotif)|| scheduledIds.length > parseInt(2.5 * surveysInADay)){
                if(scheduledIds.length < 1  || scheduledIds.length > parseInt(2.5 * surveysInADay)){
                    if(currentState == states.ACTIVE){
                        clearPriorNotifs(function(){
                            console.log("HOLY FUCK JUST CANCELLED ALL NOTIFS FROM onresume");
                            addNewNotifs(false, function(){
                                formNotifString(writeToNotifFile);
                                lastNotifID = -1;
                            });
                        });
                    }
                }
            });

            console.log('\nuserHasGoneIdle');
        }

        //Event function that fires when a user resumes the application (Bringing it to the foreground)
        function onResumeApp(){
            //alert("onResumeApp()");

            console.log('\nonResumeApp()');
            console.log("\ntimeAsleep: " + timeAsleep);
            console.log("\ntimeAwake: " + timeAwake);

            /*
            window.plugin.notification.local.getScheduledIds( function (scheduledIds) {
                 console.log('\nScheduled IDs: ' + scheduledIds.join(' ,'));
            });
            */


            //Check to see if there is a suspension time set, if so, check to see if that time has passed, if so, resume normal app behavior
            if(resumeTime != null){
                //in the case of delaying a notif, need to change currentState to active through a timeout function...
                // otherwise causes error in how missing a delayed a notif counts more than once
                if(moment().isAfter(moment(resumeTime))){

                    if(currentState == states.ASLEEP){
                        currentState = states.ACTIVE;
                        breakSleep();
                    }

                    else if(currentState == states.SUSPENDED){
                        currentState = states.ACTIVE;
                        breakSuspend();
                    }
                }
            }

            $.mobile.navigate("#login");

            /*
            if (hasMissedNotif){
                alert("You have missed " + missedNotifs + " random prompt survey(s). Please remember to take as many surveys as possible.");
                hasMissedNotif = false;
                missedNotifs = 0;
            }
            */

            //Need to check size of scheduledIds, if it is zero, then that means the the user has cleared notifs
            //from the Android clear device button... need to repopulate all new notifs

            /*
            window.plugin.notification.local.isScheduled('-99', function (isScheduled) {

                if(isScheduled)
                console.log("ALARM is scheduled");
                else
                console.log("ALARM is NOT scheduled");
            })
            */

            window.plugin.notification.local.getScheduledIds(function (scheduledIds) {
                //if no, or only one notif to be scheduled, repopulate

                console.log("\nLENGTH OF scheduledIds: " + scheduledIds.length);

                //console.log("\n@ onResume notifCount: " + notifCount);

                //IN CASE OF # of NOTIFICATIONS REACHING 0, REPOPULATE
                // Also,
                //ODD BUG WHERE NOTIFICATIONS WILL NOT BE CLEARED PRIOR TO BEING ADDED... GENERALLY MORE THAN 2x SURVEYSINADAY will be added with duplicate notifs in a day
                //2.5 because num would be greater than 2x surveysaday, but delaying a notif will also increase length, so there could legitimately be more than 2x surveys a day
                //Also, in case of last notif fire, need to check if it has been dealt with before repopulating notifs, otherwise
                //clicking on the notif will cause app to resume > repopulate > register no notifs having fired within 3 minutes, won't go to
                //RPT, or could mislabel the notif as being missed
                //if((scheduledIds.length < 1 && dealtWithLastNotif)|| scheduledIds.length > parseInt(2.5 * surveysInADay)){
                if(scheduledIds.length < 1  || scheduledIds.length > parseInt(2.5 * surveysInADay)){
                    if(currentState == states.ACTIVE){
                        clearPriorNotifs(function(){
                            console.log("HOLY FUCK JUST CANCELLED ALL NOTIFS FROM onresume");
                            addNewNotifs(false, function(){
                                formNotifString(writeToNotifFile);
                                lastNotifID = -1;
                            });
                        });
                    }
                }
            });
        }

		function onLoad() {
			document.addEventListener("deviceready", onDeviceReady, false);
		}

//***************onDeviceReady()
		function onDeviceReady() {
            console.log("\nWITHIN onDeviceReady()");
            //alert("App has RESTARTED!!!");

            document.addEventListener("pause", userHasGoneIdle , false);
            document.addEventListener("backbutton", onBackKeyDown, false);
            document.addEventListener("resume", onResumeApp, false);

            determineWhichLogin();



            //AS OF v0.7 OF THE LOCAL NOTIFICATION PLUGIN: Event listener functions DO NOT WORK CORRECTLY. DO NOT USE THEM.
            //ONCE THE APP IS PUSHED OT THE BACKGROUND AND HAS IT'S MEMORY RELEASED, ANY JS CODE WITHIN THE EVENT LISTENER FUNCTIONS
            //WILL NOT FIRE...VERY CONFUSING
            //If last recorded app status was not suspend or sleep, then it's okay to add notifs, if they need to be added...
            //This might be problematic...

            /*
            window.plugin.notification.local.oncancel = function(id, state, json){

                console.log("Cancelled notification #" + id);

                //if(!clearingAll){
                    //alert("Cancelled notif " + id + "\nState: " + state);
                //}
            }

             window.plugin.notification.local.onadd = function(id, state, json){

             console.log("\nAdded notification #" + id);

             }

            */
            /*
            window.plugin.notification.local.onclick = function(id, state, json){
                //alert("Clicked notif " + id + "\nState: " + state);
            }
            */



            /*
            window.plugin.notification.local.getScheduledIds(function (scheduledIds) {
                //if no, or only one notif to be scheduled, repopulate

                console.log("\nLENGTH OF scheduledIds: " + scheduledIds.length);
                //console.log("\n@ onResume notifCount: " + notifCount);


                //Sometimes if the app is suspended in the background, upon waking up, will repopulate with all new notifs...
                //Don't want this unless we first check to see if prior notifs were already added, if not (or if the number of notifs is
                if(scheduledIds.length < 1 || scheduledIds.length > parseInt(2.5 * surveysInADay)){

                    clearPriorNotifs(function(){
                        addNewNotifs(function(){
                            formNotifString(writeToNotifFile);
                        });
                    });
                }
            });
            */
            //Use this in release:

            determineState(function(){
                actOnState(function(){
                    readInNotifTimes(function(){

                        //Only populate with new notifications if there were not already old ones... notifTimes should be empty in this scenario
                        if(notifTimes.length < 1){

                            clearPriorNotifs(function(){
                                addNewNotifs(false, function(){
                                    formNotifString(writeToNotifFile);
                                })
                            })
                        }
                    })
                })
            });

            /*
            //FOR TESTING... FIRES a lot of Notifs in the first 5 minutes
            clearPriorNotifs(function(){
                addNotifsNow(function(){
                    formNotifString(writeToNotifFile);
                });
            });
            */

            //console.log("\ncurrentState: " + currentState + " typeOf: " + typeof(currentState));
        }


        function actOnState(callback){

            var now = moment();
            var tempResumeTime;

            if(resumeTime)
                tempResumeTime = moment(resumeTime);
            else
                tempResumeTime = null;

            console.log("\n!currentState, before: " + currentState);

            //resumeTime == null when state of app is changed to Active, so
            //on app resuming from ACTIVE state:
            if(tempResumeTime == null){
                currentState = states.ACTIVE
                console.log("\n!!!resumeTime is " + resumeTime);
            }

            //Otherwise, the state of the app must have been in sleep or suspended, but
            //could be responding to a notif that is meant to bring the app out of sleep
            //In which case, need to set state to ACTIVE... Should also maybe check number of notifs
            //and repopulate if there are none left
            else if (tempResumeTime.isBefore(now)){
                //console.log("\n!!!resumeTime ALREADY met, should be active: " + resumeTime + " ")
                currentState = states.ACTIVE;
                changeAppStatus(currentState);
            }

            //If resuming the application before the resumeTime hits, need to update appStatus to currentState and
            //update resumeTime as well...
            else if(tempResumeTime.isAfter(now)){
                //console.log("\n!!!resumeTime NOT met yet, should be not active: " + resumeTime.toString() + " ");
                changeAppStatus(currentState);
            }

            console.log("\n!!!!!currentState, after: " + currentState);

            if(typeof(callback === 'function')){
                callback();
            }
        }


        //Function called to clear all prior notifications... This function needs to be called before the functions used to add notifications
        function clearPriorNotifs(callback){
            //clearingAll = true;
            console.log("\nclearPriorNotifs()");
            //console.log("\ncaller is " + arguments.callee.caller.toString());

            notifCount = 0;
            partitionTimes = [];
            notifTimes = [];
            //didMissNotifArr = [];
            cancelledIDArr = [];
            idOfNotMissedNotif = -1;
            window.plugin.notification.local.cancelAll();

            if (typeof callback === "function"){
                
                setTimeout(function(){
                    //clearingAll = false;
                    callback();

                }, 2 * 1000);

            }
        }



        //Convenience function for adding new notifications
        function addNewNotifs(fromWakeUp, callback){
            console.log("\naddNewNotifs");
            now = moment();

            setPartitionNotifsForDaysV2(2, fromWakeUp, notifCheckAndAdd);

            console.log('\nnotifCount: ' + notifCount.toString());

            if (typeof callback === "function"){
                callback();
            }
        }

        /*
        //Called when last notif for the day is fired, adds 7 new notifs for the next day.
        function addNextDaysNotifs(){
            tomorrow = moment().add('days',1);

            setPartitionNotifsForDays(tomorrow.toDate(), 1, notifCheckAndAdd);
        }
        */


        //Reads the .log file from the root, assigns the userid from that file to the global variable userID, for use
        //throughout the app running, if log file is not found then userID variable remains null
        function readUserID(encrypted){

            var loginArr = [];

            exists('Log.log', function(value){
                if(value){
                    //console.log("\nLog.log FOUND");

                        window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fs){
                            var entry = fs.root;
                            entry.getDirectory("alt", {create: true, exclusive: false}, function(directory){

                                directory.getFile('Log.log', null, function(fe){
                                    //console.log('\nwithin readFromFile getFile()');
                                    var content;

                                    if(!encrypted){

                                        fe.file(function(file){
                                        //console.log('\nwithin readFromFile file()');
                                            var reader = new FileReader();

                                            reader.onloadend = function(evt){
                                                //console.log("\nRead as text");
                                                content = evt.target.result;
                                                //console.log(content);

                                                loginArr = content.split(delimiter);
                                                userID = loginArr[0];
                                                console.log(typeof(userID));
                                                console.log(userID.toString());
                                            }

                                            reader.readAsText(file);
                                        }, onFSError);
                                    }
                                    else{
                                        getDecryptedStringFromFileEntry(fe, function(decryptedStr){
                                            loginArr = decryptedStr.split(delimiter);

                                            userID = loginArr[0];
                                            console.log(typeof(userID));
                                            console.log(userID.toString());
                                        });
                                    }
                                }, onFSError);
                            }, onGetDirectoryFail);
                        }, onFSError);
                }
            });
        }

        //To be called at onDeviceReady, in determineWhichLogin... no need to continuosuly delve into encrypted login file,
        //Can just do once and save to variable and refer back to variable when logging in.
        function determineNameAndPass(callback){
            //if no log.log file, then must be new user
            //console.log("\nLog.log FOUND");

            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fs){
                var entry = fs.root;
                entry.getDirectory("alt", {create: true, exclusive: false}, function(directory){

                    directory.getFile('Log.log', null, function(fe){
                        //console.log('\nwithin readFromFile getFile()');

                        //if wanting to decrypt login before comparing to user input...
                        getDecryptedStringFromFileEntry(fe, function(decryptedStr){
                            var loginArr = decryptedStr.split(delimiter);

                            userID = loginArr[0];
                            userPass = loginArr[1];

                        });
                    }, onFSError);
                }, onGetDirectoryFail);
            }, onFSError);

            if(typeof(callback) === 'function'){
                callback();
            }
        }

        //Called on the app breaking suspension...changes the login page theme to go back to the default
        function breakSuspend(callback){
            currentState = states.ACTIVE;
            changeAppStatus(states.ACTIVE);

            writingToRandomPromptInt = false;

            alert("App is no longer suspended. \nYou are now receiving Random Prompt Notifications");

            if(typeof(callback) ==="function"){
                callback();
            }
        }

        //Called on app breaking sleep... changes the login page them to go back to the default
        function breakSleep(callback){
            currentState = states.ACTIVE;
            changeAppStatus(states.ACTIVE);

            //Just added this, but didnt test... might want to make sure it doesn't cause the alarm to not play, it shouldnt though...
            window.plugin.notification.local.cancel(-99);

            writingToRandomPromptInt = false;

            alert("App is now awake. \nYou are now receiving Random Prompt Notifications.");

            if(typeof(callback) ==="function"){
                callback();
            }
        }

        //First, check if login file exists, if it does and has contents,
        function checkLoginV2(){
            //set up writing permissions:
            var p = $("#login-password").val();
            //check if Log.log exists, if so then read the text file and save the contents to a string

            //if admin pin entered, then navigate to admin profile
            if ($("#login-password").val() == adminPin){
                readUserID(true);
                $.mobile.navigate('#administrator');
            }

            //otherwise check user entered pin
            else{
                if(userPass != ''){
                    //console.log("\nLog.log FOUND");
                    //If user has entered correct password:
                    if(userPass == p){
                        //If user has touched notif to take RPT
                        $("#login-password").val('');

                        //Determines missed notifs, and decides whether the user goes ot the main menu
                        //or starts random prompt survey
                        if(currentState == states.ACTIVE){

                            console.log("\nState at Login was ACTIVE");
                            startLogin(function(){
                                formNotifString(writeToNotifFile);
                            });
                        }

                        else if(currentState == states.ASLEEP){

                            console.log("\nState at Login was ASLEEP");
                            breakSleep(function(){
                                $.mobile.navigate("#main");

                                clearPriorNotifs(function(){

                                    console.log("HOLY HALLWAY! CLEARED NOTIFICATIONS AS CALLBACK FROM breakSleep()");

                                    addNewNotifs(false, function(){
                                        formNotifString(writeToNotifFile);
                                        console.log("\nnotifTimes.length = " + notifTimes.length);
                                    });
                                });
                            });
                        }
                        //if state is suspended, then cannot be responding to a notif, therefore just log into main menu
                        else if(currentState == states.SUSPENDED){

                            console.log("\nState at Login was SUSPENDED");
                            breakSuspend(function(){
                                $.mobile.navigate("#main");

                                clearPriorNotifs(function(){

                                    console.log("DAMN DUDE! CLEARED NOTIFICATIONS AS CALLBACK FROM breakSuspend()");

                                    addNewNotifs(false, function(){
                                        formNotifString(writeToNotifFile);

                                        console.log("\nnotifTimes.length = " + notifTimes.length)
                                    });
                                });
                            });

                        }
                    }
                    else if ((p == '')){
                        alert("Must enter a password");
                        //$.mobile.navigate('#login');
                        $("#login-password").val('');
                    }
                    else{
                        alert("Incorrect login information");
                        //$.mobile.navigate('#login');
                        $("#login-password").val('');
                    }
                }
                //if no Log.log file, create it, and write the contents of the two input fields to the text file-  userID, password
                else{
                    alert("Please enter new user information");
                    $.mobile.navigate("#login-newuser");
                }
            }
        }

        //Sets up parameters for the Tobacco Use Interview survey page progression
        function startLoginToMain(navigateToNextPage){

            $(document).on('pagebeforeshow', '#emoSurveyA', function(){
                // So we can test if button is disabled or not
                $('#emoSurveyABack').prop('disabled', false).removeClass('ui-disabled');
            });

            startedRandomPromptSurvey = false;
            finishedRandomPromptSurvey = false;
            writingToRandomPromptInt = false;

            $("#secondRadioSetSurveyGo .ui-btn-text").text("Next");
            //$.mobile.navigate("#tobProductSurvey");

            if(navigateToNextPage)
                $.mobile.navigate("#main");
        }

        //determines if any notifs have been missed, alerts the user, and determines if the user can go to rpt survey
        //or main menu
        function startLogin(callback){
            //Chosen to start random prompt interview
            console.log('\nCP1 @startRandomPromptInterview');

            //Records any notifs which have been stacked or are otherwise considered late, also cancels those notifs
            //and defines the id of the notif if it isn't considered late.
            determineMissedNotifs(function(){


                //If there is a notif within the notif tray which has been interacted with within 3 minutes...
                if(idOfNotMissedNotif != -1){
                    $(document).on('pagebeforeshow', '#emoSurveyA', function(){
                        $('#emoSurveyABack').prop('disabled', true).addClass('ui-disabled');
                    });

                    $("#emoSurveyABack").attr('href', '#');
                    $("#secondRadioSetSurveyGo .ui-btn-text").text("Submit survey");

                    rptStartTime = moment();

                    startedRandomPromptSurvey = true;
                    finishedRandomPromptSurvey = false;
                    writingToRandomPromptInt = true;

                    $.mobile.navigate("#emoSurveyA");

                    console.log("\nN#" + idOfNotMissedNotif + " was NOT missed.");
                }
                //If all of the current notifs which have been triggered are late (no valid notif)
                else{
                    //alert("No Random Prompt Notification has fired within the last 3 minutes.\nYou will be taken to the main menu.");
                    $.mobile.navigate("#main");

                    startedRandomPromptSurvey = false;
                    finishedRandomPromptSurvey = false;
                    writingToRandomPromptInt = false;
                    rptStartTime = null;
                    console.log("\nCP 5b, no notif was valid");
                }

                clearStackedNotifs(function(){
                    if(hasMissedNotif){
                        alert("Random Prompt Notification(s) missed. This has been logged.\nPlease remember to respond to as many Random Prompt Notifications as possible.");
                        hasMissedNotif = false;
                    }
                    //console.log("\nnotifTimes after clear stack: " + notifTimes.toString());
                    cancelledIDArr = [];
                });
            });

            if(typeof(callback)==='function'){
                callback();
            }
        }

        //Workaround function that cancels notifications which were determined to be cancelled--in the case that a user has missed a notification(s)--
        //upon a user logging into the application.
        function clearStackedNotifs(callback){
            for(var j = 0; j < cancelledIDArr.length; j++){
                var cancelledID = cancelledIDArr[j];

                console.log("\nCP 6 @clearStackedNotifs cancelledID=" + cancelledID);

                //cancelledIDArr already holds id of actual notifs ( +1)...no need to increas eby one here
                window.plugin.notification.local.cancel(cancelledID);
                notifTimes[cancelledID - 1] = null;

                //if the last notif has been interacted with (cancelled), can now repopulate notifs upon resuming the app
                if(cancelledID == notifTimes.length){
                    dealtWithLastNotif = true;
                    lastNotifID = cancelledID;
                    console.log("\n***Dealing with last notif #" + lastNotifID);
                }
            }

            //Still need to make sure that the actual notif of the not missed notif is cancelled, since
            //a user does not need to tap on it explicitly to start a survey.
            if(idOfNotMissedNotif != -1){
                window.plugin.notification.local.cancel(idOfNotMissedNotif);
                notifTimes[idOfNotMissedNotif - 1] = null;

                if(idOfNotMissedNotif == notifTimes.length){
                    dealtWithLastNotif = true;
                    lastNotifID = idOfNotMissedNotif;
                    console.log("\n***Dealing with last notif #" + lastNotifID);
                }
            }


            if(typeof(callback) === 'function'){
                callback();
            }
        }

        //Determines which notifications should be cancelled due to them being 'missed' notifications once the user logs
        //in
        function determineMissedNotifs(callback){
            var concatString = '';

            console.log('\nCP2 @determineMissedNotifs');
            defineCancelledIDArr(function(){
                console.log("\nNotifs to be cancelled: " + cancelledIDArr.toString());

                if(cancelledIDArr.length > 0){
                    for(var i = 0; i < cancelledIDArr.length; i++){
                        var cancelledIndex = (cancelledIDArr[i] - 1); //-1 because cancelledIDArr[i] holds the id of the notif to cancel, but the index of the corresponding time is one less
                        //var tempStr = cancelledIDArr[i] + '; 2; ';//must be type 2, as abandoned notifications are recorded in a different function
                        var tempStr = userID + ', 2, ';

                        if(notifTimes[cancelledIndex]){
                            tempStr += moment(notifTimes[cancelledIndex]).toDate().toString();
                            concatString += (tempStr + '\n');
                        }
                        else
                            console.log("\nERR: notifsTimes[" + cancelledIndex + "]= " + notifTimes[cancelledIndex].toString());
                        /*
                        if(notifTimes[cancelledIndex]){
                            console.log("\nCP4 adding #" + (cancelledIndex + 1) + " to missed Notifs, time: " + notifTimes[cancelledIndex].toString());
                            addToMissedNotifs(2, notifTimes[cancelledIndex].format('dddd, MMMM Do, HH:mm:ss a'));
                        }
                        */
                    }
                    writeToMissedNotifsFile(concatString);
                }
            });

            if(typeof(callback) === "function"){
                callback();
            }
        }


        //auxilary function used within determineMissedNotifs to help aid in determining 'missed' notifications
        function defineCancelledIDArr(callback){
            //var limit = moment().add('minutes', 3);
            //var limit = moment().add('seconds', 10);
            var now = moment();
            var diff;

            for(var i = 0; i < notifTimes.length; i++){
                //if(notifTimes[i])
                    //console.log("\n#CP3a notifTimes[i]: " + notifTimes[i].format('dddd, MMMM Do, HH:mm:ss a'));
                //Must not already be a notif that has been cancelled

                if(notifTimes[i] != null){
                    var notifMoment = moment(notifTimes[i]);
                    console.log("\n#CP3 notifTime[" + i + "]= id#" + (i + 1) +" @" + notifTimes[i].format('dddd, MMMM Do, HH:mm:ss a'));

                    if(notifMoment.isBefore(now)){
                        //for times that are considered missed
                        //if( Math.abs(limit.diff(notifMoment, "seconds")) > 180 ){

                        diff = Math.abs(now.diff(notifMoment, "seconds"));
                        console.log("\nTime since notif fired: " + diff + " seconds.");

                        if(diff > durationOfNotif){
                            hasMissedNotif = true;
                            cancelledIDArr.push(i + 1);
                            console.log('\nCP3aa @defineCancelledIDArr add id#' + (i + 1) + " to cancelledIDArr, time: " + notifMoment.format('dddd, MMMM Do, HH:mm:ss a'));
                        }
                        //for times that are considered not missed
                        else{
                            console.log('\nCP3ab @defineCancelledIDArr, notifNotMissed: id#' + (i + 1));
                            idOfNotMissedNotif = (i + 1);
                            break;
                        }
                    }

                    //if querying a notif time that has not occurred yet, break:
                    else{
                        break;
                    }
                }
                else
                    console.log("\n#CP3 notifTime[" + i + "]=" + notifTimes[i]);
            }

            if(typeof(callback) === 'function'){
                callback();
            }
        }


        //Function which used AES encryption, but proved problematic. Used cryptWithCaesar(string, doDecrypt) instead
        function encryptStringWithAES(passedString){
            var encryptedStr = CryptoJS.AES.encrypt(passedString, encryptionKey);

            return encryptedStr;
        }

        //Convenience function to decrypt an encrypted text file
        function getDecryptedStringFromFileEntry(fileEntry, callback){

            fileEntry.file(function(file){
                var content, decrypted, decryptedStr;
                var reader = new FileReader();

                reader.onloadend = function(e){
                    content = e.target.result;

                    decrypted = cryptWithCaesar(content, true);
                    decryptedStr = decrypted.toString();
                    //console.log(decryptedStr);

                    if(typeof(callback === 'function')){
                        callback(decryptedStr);
                    }
                }
                reader.readAsText(file);

            }, onFSError);

        }


        //Convenience function to encrypt an entire file, also can decrypt if the second argument passed is True
        function cryptFileWithCaesar(fileEntry, doDecrypt){

            fileEntry.file(function(file){

                console.log("\nCheckpoint 10 passed, fileEntry type:" + typeof(fileEntry));

                var content, crypted;
                var reader = new FileReader();

                reader.onloadend = function(e){
                    console.log("\nCheckpoint 11 reader has finished loading");
                    content = e.target.result;

                    console.log("\ncontents of " + file.name + ": " + content);

                    cryptWithCaesar(content, doDecrypt, function(crypted){

                        console.log("\nCheckpoint 12, decrypted content: " + crypted.toString());
                        fileEntry.createWriter(function(writer){
                            console.log("\nCheckpoint 13, created writer");
                            //writer.seek(0);

                            //console.log('\nwithin randomPromptIntfile createwriter()');
                            writer.write(crypted.toString());

                            writer.onwriteend = function(evt){
                                console.log('\nCheckpoint 14 Wrote to file ' + fileEntry.fullPath);
                            }
                        },onFSError);
                    });
                }
                reader.readAsText(file);
            }, onFSError);
        }


        //Determines if a file exists
        function exists(fileName, callback) {
            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0,function(fs){
                var entry = fs.root;
                entry.getDirectory("alt", {create: true, exclusive: false}, function(directory){

                    directory.getFile(fileName,
                        {create : false},
                        function() {callback(true);
                        //console.log(fileName + " exists!");
                        },
                        function() {callback(false);
                        //console.log(fileName + " does NOT exist!");
                        });
                }, onGetDirectoryFail);
            }, onFSError)
        }


        //aux function to log when file system error occurs
        function onFSError(err) {
            console.log("\nWITHIN onFSERROR()");
            console.log(err.code);
        }


        //aux function to log when file directory error occurs
        function onGetDirectoryFail(error) {
            console.log("\nError creating directory "+error.code);
        }


        //Writes to notification file
        function writeToNotifFile(passedString, doEncrypt){
            console.log("\nwriteToNotifFile()");
            if (doEncrypt){
                //passedString = CryptoJS.AES.encrypt(passedString, encryptionKey).toString();
                passedString = cryptWithCaesar(passedString, false);
            }

            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSystem){

                var entry = fileSystem.root;
                entry.getDirectory("alt", {create: true, exclusive: false}, function(directory){

                    directory.getFile("Not.not", {create: true, exclusive: false}, function(fileEntry){

                        //console.log("\nFILEENTRY.NAME: " + fileEntry);
                        fileEntry.createWriter(function(writer){

                            notifFileWriter = writer;
                            //notifFilewriter.seek(0);
                            //console.log('\nwithin notiffile createwriter()');
                            notifFileWriter.write(passedString);
                            notifFileWriter.onwriteend = function(evt){
                                //alert(evt);
                                //console.log("\nDone writing to Not.not!");
                                //console.log('\n\ntimes written to notifs.txt: \n' + passedString);
                            }
                        },onFSError);
                    },onFSError);
                }, onGetDirectoryFail);
            }, onFSError);
        }


        //writes to missed notificaiton file
        function writeToMissedNotifsFile(passedString, doEncrypt){

            if (doEncrypt){
                //passedString = CryptoJS.AES.encrypt(passedString, encryptionKey).toString();
                passedString = cryptWithCaesar(passedString, false);
            }

            //console.log('\nmissedNotifs: ' + passedString);

            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSystem){

                var entry = fileSystem.root;
                entry.getDirectory("alt", {create: true, exclusive: false}, function(directory){

                    directory.getFile("Mis.mis", {create: true, exclusive: false}, function(fileEntry){
                        //console.log("\nFILEENTRY.NAME: " + fileEntry);

                        fileEntry.createWriter(function(writer){
                            missedNotifsFileWriter = writer;
                            missedNotifsFileWriter.seek(writer.length);
                            //console.log('\nwithin missednotifsfile createwriter()');
                            missedNotifsFileWriter.write(passedString);
                            missedNotifsFileWriter.onwriteend = function(evt){
                                //alert(evt);
                                //console.log("\nDone writing to missednotifs.txt!");
                                console.log('\nWrote to Mis.mis: ' + passedString);
                            }
                        },onFSError);
                    }, onGetDirectoryFail);
                },onFSError);
            }, onFSError);
        }


        //Holds strings indicating state, resumeTime of application... needed as the app tends to restart
        //arbitrarily
        function writeToStateFile(passedString, doEncrypt){

            if (doEncrypt){
                //passedString = CryptoJS.AES.encrypt(passedString, encryptionKey).toString();
                passedString = cryptWithCaesar(passedString, false);
            }

            //console.log('\nmissedNotifs: ' + passedString);

            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSystem){

                var entry = fileSystem.root;
                entry.getDirectory("alt", {create: true, exclusive: false}, function(directory){

                    directory.getFile("State.state", {create: true, exclusive: false}, function(fileEntry){
                        //console.log("\nFILEENTRY.NAME: " + fileEntry);

                        fileEntry.createWriter(function(writer){
                            stateFileWriter = writer;
                            //stateFilewriter.seek(0);
                            //console.log('\nwithin missednotifsfile createwriter()');
                            stateFileWriter.write(passedString);
                            stateFileWriter.onwriteend = function(evt){
                                //alert(evt);
                                //console.log("\nDone writing to missednotifs.txt!");
                                console.log('\nWrote to State.state: ' + passedString);
                            }
                        },onFSError);
                    }, onGetDirectoryFail);
                },onFSError);
            }, onFSError);
        }


        //write to login file
        function writeToLoginFile(passedString, doEncrypt){

            if (doEncrypt){
                //passedString = CryptoJS.AES.encrypt(passedString, encryptionKey).toString();
                passedString = cryptWithCaesar(passedString, false);
            }

            console.log('\nlogin: ' + passedString);

            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSystem){


                var entry = fileSystem.root;
                entry.getDirectory("alt", {create: true, exclusive: false}, function(directory){

                    directory.getFile("Log.log", {create: true, exclusive: false}, function(fileEntry){
                    //console.log("\nFILEENTRY.NAME: " + fileEntry);
                        fileEntry.createWriter(function(writer){
                            loginFileWriter = writer;
                            //loginFilewriter.seek(0);
                            //console.log('\nwithin loginfile createwriter()');
                            loginFileWriter.write(passedString);
                            loginFileWriter.onwriteend = function(evt){
                                //alert(evt);
                                //console.log("\nDone writing to Log.log!");
                                console.log('\nwrote to login file: ' + passedString);
                            }
                        },onFSError);
                    }, onGetDirectoryFail);
                },onFSError);
            }, onFSError);
        }


        //Write to tobacco use interview file
        function writeToTobaccoUseIntFile(passedString, doEncrypt, callback){

            if (doEncrypt){
                //passedString = CryptoJS.AES.encrypt(passedString, encryptionKey).toString();
                passedString = cryptWithCaesar(passedString, false);
            }

            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSystem){
                var entry = fileSystem.root;
                entry.getDirectory("alt", {create: true, exclusive: false}, function(directory){

                    directory.getFile("Tob.tob", {create: true, exclusive: false}, function(fileEntry){
                    //console.log("\nFILEENTRY.NAME: " + fileEntry);
                        fileEntry.createWriter(function(writer){
                            TobaccoUseIntFileWriter = writer;
                            TobaccoUseIntFileWriter.seek(writer.length);
                            //console.log('\nwithin TobaccoUseIntfile createwriter()');
                            TobaccoUseIntFileWriter.write(passedString);
                            TobaccoUseIntFileWriter.onwriteend = function(evt){
                                //alert(evt);
                                //console.log("\nDone writing to Tob.tob!");
                                console.log('\nwrote to tobacco use interview survey: \n' + passedString);
                            }
                        },onFSError);
                    }, onGetDirectoryFail);
                },onFSError);
            }, onFSError);

            if(typeof(callback) === 'function')
                callback();
        }


        //write to random prompt interview file
        function writeToRandomPromptIntFile(passedString, doEncrypt, callback){

            if (doEncrypt){
                //passedString = CryptoJS.AES.encrypt(passedString, encryptionKey).toString();
                passedString = cryptWithCaesar(passedString, false);
            }

            console.log("\nrandompromptint: " + passedString);

            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSystem){
                var entry = fileSystem.root;
                entry.getDirectory("alt", {create: true, exclusive: false}, function(directory){

                    directory.getFile("Rpt.rpt", {create: true, exclusive: false}, function(fileEntry){
                        //console.log("\nFILEENTRY.NAME: " + fileEntry);
                        fileEntry.createWriter(function(writer){
                            randomPromptIntFileWriter = writer;
                            randomPromptIntFileWriter.seek(writer.length);
                            //console.log('\nwithin randomPromptIntfile createwriter()');
                            randomPromptIntFileWriter.write(passedString);
                            randomPromptIntFileWriter.onwriteend = function(evt){
                                //alert(evt);
                                //console.log("\nDone writing to randomPromptInt.txt!");
                                console.log('\nwrote to randomPromptInt: ' + passedString);
                            }
                        },onFSError);
                    }, onGetDirectoryFail);
                },onFSError);
            }, onFSError);

            callback();
        }


        //write to problem report file
        function writeToProblemReportFile(passedString, doEncrypt, callback){

            if (doEncrypt){
                //passedString = CryptoJS.AES.encrypt(passedString, encryptionKey).toString();
                passedString = cryptWithCaesar(passedString, false);
            }

            console.log("\nProblemReport: " + passedString);

            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSystem){
                var entry = fileSystem.root;
                entry.getDirectory("alt", {create: true, exclusive: false}, function(directory){

                    directory.getFile("Prob.prob", {create: true, exclusive: false}, function(fileEntry){
                        //console.log("\nFILEENTRY.NAME: " + fileEntry);
                        fileEntry.createWriter(function(writer){
                            ProblemReportFileWriter = writer;
                            ProblemReportFileWriter.seek(writer.length);
                            //console.log('\nwithin ProblemReportfile createwriter()');
                            ProblemReportFileWriter.write(passedString);
                            ProblemReportFileWriter.onwriteend = function(evt){
                                //alert(evt);
                                //console.log("\nDone writing to ProblemReport.txt!");
                                console.log('\nwrote to ProblemReport: ' + passedString);
                            }
                        },onFSError);
                    }, onGetDirectoryFail);
                },onFSError);
            }, onFSError);

            if(typeof(callback)==="function"){
                callback();
            }
        }

        //aux function to copy a file form one directory to another... used when 'Prepare Files' is selected from admin
        //menu in the app
        function copyFile(entry, callback) {

            var fileName = entry.name;
            var fileType = fileName.split('.').pop();


            console.log("\nCheckpoint 4 @copyFile fileName: " + fileName);
            console.log("\nfile type: " + fileType);
            /*
            var parent = document.getElementById('parent').value,
                    parentName = parent.substring(parent.lastIndexOf('/')+1),
                    parentEntry = new DirectoryEntry(parentName, parent);
                    */

            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fs){
                console.log("\ncheckpoint 5, got FileSystem within copyFile");

                fs.root.getDirectory("alt", {create: true, exclusive: false}, function(dr){
                    console.log("\ncheckPoint 6, got directory ...");

                    dr.getDirectory(userID.toString(), {create:true, exclusive: false}, function(userDir){
                        console.log("\ncheckPoint 7, got directory " + userDir.fullPath);

                        entry.copyTo(userDir, userID.toString() + "." + fileType, function(newFileEntry){
                            console.log("\ncheckpoint 8 copied successfully, renamed to: " + newFileEntry.name);

                            newFileEntry.file(function(f){
                                console.log("\ncopied file " +  f.name + " size: " + f.size);
                            }, function(err){
                                console.log("\ncopied fileENtry to file() err: " + err);
                            });

                            if (typeof(callback) === 'function')
                                callback(newFileEntry);

                        }, onFSError);
                    }, onGetDirectoryFail);
                },onGetDirectoryFail);
            }, onFSError);
        };


        //A more general function to write to any file, instead of having to call indivdual functions that perform the same
        //task... didn't end up using this
        function generalWriteToFile(passedString, fileName, subDir, doEncrypt, doAppend, callback){

            if (doEncrypt)
                passedString = encryptStringWithAES(passedString).toString();

            console.log("\npassedString to general writeToFile: " + passedString);

            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSystem){
                var entry = fileSystem.root;

                if(!subDir)
                    subDir = '';

                entry.getDirectory(".../" + subDir, {create: true, exclusive: false}, function(dir){

                    dir.getFile(fileName, {create: true, exclusive: false}, function(fileEntry){
                        //console.log("\nFILEENTRY.NAME: " + fileEntry);
                        fileEntry.createWriter(function(writer){

                            if (doAppend)
                                writer.seek(writer.length);
                            //else
                                //writer.seek(0);

                            //console.log('\nwithin randomPromptIntfile createwriter()');
                            writer.write(passedString);

                            writer.onwriteend = function(evt){
                                console.log('\nWrote to file ' + fileName + ': ' + passedString);
                            }
                        },onFSError);
                    }, onGetDirectoryFail);
                },onFSError);
            }, onFSError);

            if (typeof(callback) === 'function'){
                callback();
            }
        }

        //Convenience function to write to problem report file
        function recordProblemReport(){
            recordTimeStamp();
            var problemText = $("#problemdetail").val();

            if (problemText != '')
                writeToProblemReportFile(userID + ', ' + timeStamp + ', ' + problemText + '\n', false);
        }

        //Convenience function to assign current time to global timeStamp variable
        function recordTimeStamp(){
            /*
            date = new Date();

            hour = date.getHours();
            min = date.getMinutes();
            sec = date.getSeconds();

            dayOfMonth = date.getDate();
            month = date.getMonth() + 1;
            year = date.getFullYear();
            */

            //timeStamp = (month + '/' + dayOfMonth + '/' + year + '_' + hour + ':' + min + ':' + sec);
            //timeStamp = moment().format('dddd, MMMM Do, HH:mm:ss a');
            timeStamp = moment().toDate().toString();
        }


        /*
        OLD slider record code:

        function recordEmoSurvey(){
            emoSurveyAData.happy = $("#slider-happy").val();
            emoSurveyAData.relax = $("#slider-relax").val();
            emoSurveyAData.cheer = $("#slider-cheer").val();
            emoSurveyBData.sad = $("#slider-sad").val();
            emoSurveyBData.stress = $("#slider-stress").val();
            emoSurveyBData.angry = $("#slider-angry").val();
            emoSurveyCData.frust = $("#slider-frust").val();
            emoSurveyCData.irritbl = $("#slider-irritbl").val();
            emoSurveyCData.confdnt = $("#slider-confdnt").val();

            console.log('\nin recordEmoSurvey()');
        }

        function recordBEmoSurvey(){
            beforeTobEmoSurveyAData.bhappy = $("#slider-bhappy").val();
            beforeTobEmoSurveyAData.brelax = $("#slider-brelax").val();
            beforeTobEmoSurveyAData.bcheer = $("#slider-bcheer").val();
            beforeTobEmoSurveyBData.bsad = $("#slider-bsad").val();
            beforeTobEmoSurveyBData.bstress = $("#slider-bstress").val();
            beforeTobEmoSurveyBData.bangry = $("#slider-bangry").val();
            beforeTobEmoSurveyCData.bfrust = $("#slider-bfrust").val();
            beforeTobEmoSurveyCData.birritbl = $("#slider-birritbl").val();
            beforeTobEmoSurveyCData.bconfdnt = $("#slider-bconfdnt").val();

            console.log('\nin recordBEmoSurvey()');
        }

        function recordWhenUsingTobSurvey(){
            whenUsingTobSurveyData.pleasur = $("#slider-pleasur").val();
            whenUsingTobSurveyData.satisfy = $("#slider-satisfy").val();

            console.log('\nin recordWhenUsingTobSurvey()');
        }

        */

        //Below functions assign values from state of widgets to global variables... necessary for recording the answers
        //to file at the end of the survey
        function recordEmoSurvey(){

            console.log("$('input:radio[name=radio-happy]:checked').val() = " + $('input:radio[name=radio-happy]:checked').val() +
                    "$('input:radio[name=radio-relax]:checked').val() = " + $('input:radio[name=radio-relax]:checked').val() +
                    "$('input:radio[name=radio-cheer]:checked').val() = " + $('input:radio[name=radio-cheer]:checked').val());

            emoSurveyAData.happy = $('input:radio[name=radio-happy]:checked').val();
            emoSurveyAData.relax = $('input:radio[name=radio-relax]:checked').val();
            emoSurveyAData.cheer = $('input:radio[name=radio-cheer]:checked').val();
            emoSurveyBData.sad = $('input:radio[name=radio-sad]:checked').val();
            emoSurveyBData.stress = $('input:radio[name=radio-stress]:checked').val();
            emoSurveyBData.angry = $('input:radio[name=radio-angry]:checked').val();
            emoSurveyCData.frust = $('input:radio[name=radio-frust]:checked').val();
            emoSurveyCData.irritbl = $('input:radio[name=radio-irritbl]:checked').val();
            emoSurveyCData.confdnt = $('input:radio[name=radio-confdnt]:checked').val();

            console.log('\nin recordEmoSurvey()');
        }

        function recordBEmoSurvey(){
            beforeTobEmoSurveyAData.bhappy = $('input:radio[name=radio-bhappy]:checked').val();
            beforeTobEmoSurveyAData.brelax = $('input:radio[name=radio-brelax]:checked').val();
            beforeTobEmoSurveyAData.bcheer = $('input:radio[name=radio-bcheer]:checked').val();
            beforeTobEmoSurveyBData.bsad = $('input:radio[name=radio-bsad]:checked').val();
            beforeTobEmoSurveyBData.bstress = $('input:radio[name=radio-bstress]:checked').val();
            beforeTobEmoSurveyBData.bangry = $('input:radio[name=radio-bangry]:checked').val();
            beforeTobEmoSurveyCData.bfrust = $('input:radio[name=radio-bfrust]:checked').val();
            beforeTobEmoSurveyCData.birritbl = $('input:radio[name=radio-birritbl]:checked').val();
            beforeTobEmoSurveyCData.bconfdnt = $('input:radio[name=radio-bconfdnt]:checked').val();

            console.log('\nin recordBEmoSurvey()');
        }

        function recordWhenUsingTobSurvey(){
            whenUsingTobSurveyData.pleasur = $('input:radio[name=radio-pleasur]:checked').val();
            whenUsingTobSurveyData.satisfy = $('input:radio[name=radio-satisfy]:checked').val();

            console.log('\nin recordWhenUsingTobSurvey()');
        }



        function recordProductUrgeSurvey(){
            productUrgeSurveyData.ulcigarette = translateCheckBox($("#checkbox-ulcigarette").prop('checked'));
            productUrgeSurveyData.ulcigar = translateCheckBox($("#checkbox-ulcigar").prop('checked'));
            productUrgeSurveyData.ucigarilo = translateCheckBox($("#checkbox-ucigarilo").prop('checked'));
            productUrgeSurveyData.ubcigar = translateCheckBox($("#checkbox-ubcigar").prop('checked'));
            productUrgeSurveyData.uecig = translateCheckBox($("#checkbox-uecig").prop('checked'));
            productUrgeSurveyData.uvap = translateCheckBox($("#checkbox-uvap").prop('checked'));
            productUrgeSurveyData.uhookah = translateCheckBox($("#checkbox-uhookah").prop('checked'));
            productUrgeSurveyData.uchew = translateCheckBox($("#checkbox-uchew").prop('checked'));
            productUrgeSurveyData.udipsnf = translateCheckBox($("#checkbox-udipsnf").prop('checked'));
            productUrgeSurveyData.usnus = translateCheckBox($("#checkbox-usnus").prop('checked'));
            productUrgeSurveyData.unourge = translateCheckBox($("#checkbox-unourge").prop('checked'));
        }

        function recordCurrentActivitySurvey(){
            currentActivitySurveyData.hang =  translateCheckBox($("#checkbox-hang").prop('checked'));
            currentActivitySurveyData.tvmus =  translateCheckBox($("#checkbox-tvmus").prop('checked'));
            currentActivitySurveyData.phone =  translateCheckBox($("#checkbox-phone").prop('checked'));
            currentActivitySurveyData.texting = translateCheckBox($("#checkbox-texting").prop('checked'));
            currentActivitySurveyData.compint = translateCheckBox($("#checkbox-compint").prop('checked'));
            currentActivitySurveyData.reading = translateCheckBox($("#checkbox-reading").prop('checked'));
            currentActivitySurveyData.schl = translateCheckBox($("#checkbox-schl").prop('checked'));
            currentActivitySurveyData.job = translateCheckBox($("#checkbox-job").prop('checked'));
            currentActivitySurveyData.eatdrnk = translateCheckBox($("#checkbox-eatdrnk").prop('checked'));
            currentActivitySurveyData.alc = translateCheckBox($("#checkbox-alc").prop('checked'));
            currentActivitySurveyData.pot = translateCheckBox($("#checkbox-pot").prop('checked'));
            currentActivitySurveyData.party = translateCheckBox($("#checkbox-party").prop('checked'));
            currentActivitySurveyData.phys = translateCheckBox($("#checkbox-phys").prop('checked'));
            currentActivitySurveyData.walking = translateCheckBox($("#checkbox-walking").prop('checked'));
            currentActivitySurveyData.club = translateCheckBox($("#checkbox-club").prop('checked'));
            currentActivitySurveyData.trans = translateCheckBox($("#checkbox-trans").prop('checked'));
            currentActivitySurveyData.noth = translateCheckBox($("#checkbox-noth").prop('checked'));
            currentActivitySurveyData.other = translateCheckBox($("#checkbox-other").prop('checked'));
        }


        function recordWOthersSurvey(){
            /*
             fileWriter.write(wOthersSurveyData.comp + delimiter);
             */
        }

        function recordWhoNearbySurvey(){
            if(!goto5a){
                whoNearbySurveyData.alo_wthfam = 0;
                whoNearbySurveyData.alo_wthpart = 0;
                whoNearbySurveyData.alo_wthwork = 0;
                whoNearbySurveyData.alo_wthfr = 0;
                whoNearbySurveyData.alo_wthoth = 0;
            }

        }

        function recordWhoFamilySurvey(){
            if (goto5a1){
                whoFamilySurveyData.alo_wthmom = translateCheckBox($("checkbox-alo_wthmom").prop("checked"));
                whoFamilySurveyData.alo_wthsib = translateCheckBox($("checkbox-alo_wthsib").prop("checked"));
                whoFamilySurveyData.alo_wthchild = translateCheckBox($("checkbox-alo_wthchild").prop("checked"));
                whoFamilySurveyData.alo_wthdad = translateCheckBox($("checkbox-alo_wthdad").prop("checked"));
                whoFamilySurveyData.alo_wthrel = translateCheckBox($("checkbox-alo_wthrel").prop("checked"));
            }
            else{
                whoFamilySurveyData.alo_wthmom = 0;
                whoFamilySurveyData.alo_wthsib = 0;
                whoFamilySurveyData.alo_wthchild = 0;
                whoFamilySurveyData.alo_wthdad = 0;
                whoFamilySurveyData.alo_wthrel = 0;
            }

        }

        function recordNearbyProductUseSurvey(){
            if(goto5a){
                nearbyProductUseSurveyData.ocig = translateCheckBox($("#checkbox-ocig").prop("checked"));
                nearbyProductUseSurveyData.olcigar = translateCheckBox($("#checkbox-olcigar").prop("checked"));
                nearbyProductUseSurveyData.ocigrilo = translateCheckBox($("#checkbox-ocigrilo").prop("checked"));
                nearbyProductUseSurveyData.obcigar = translateCheckBox($("#checkbox-obcigar").prop("checked"));
                nearbyProductUseSurveyData.oecig = translateCheckBox($("#checkbox-oecig").prop("checked"));
                nearbyProductUseSurveyData.ovap = translateCheckBox($("#checkbox-ovap").prop("checked"));
                nearbyProductUseSurveyData.ohookah = translateCheckBox($("#checkbox-ohookah").prop("checked"));
                nearbyProductUseSurveyData.ochew = translateCheckBox($("#checkbox-ochew").prop("checked"));
                nearbyProductUseSurveyData.odipsnf = translateCheckBox($("#checkbox-odipsnf").prop("checked"));
                nearbyProductUseSurveyData.osnus = translateCheckBox($("#checkbox-osnus").prop("checked"));
                nearbyProductUseSurveyData.onone = translateCheckBox($("#checkbox-onone").prop("checked"));
            }
            else{
                nearbyProductUseSurveyData.ocig = 0;
                nearbyProductUseSurveyData.olcigar = 0;
                nearbyProductUseSurveyData.ocigrilo = 0;
                nearbyProductUseSurveyData.obcigar = 0;
                nearbyProductUseSurveyData.oecig = 0;
                nearbyProductUseSurveyData.ovap = 0;
                nearbyProductUseSurveyData.ohookah = 0;
                nearbyProductUseSurveyData.ochew = 0;
                nearbyProductUseSurveyData.odipsnf = 0;
                nearbyProductUseSurveyData.osnus = 0;
                nearbyProductUseSurveyData.onone = 0;
            }

        }

        function recordLocationSurvey(){
            chosenValue = "";

            if($("#radio-locat31").prop("checked")){
                chosenValue = $("#radio-locat31").val();
            }
            else if ($("#radio-locat32").prop("checked")){
                chosenValue = $("#radio-locat32").val();
            }
            else if ($("#radio-locat33").prop("checked")){
                chosenValue = $("#radio-locat33").val();
            }
            else if ($("#radio-locat34").prop("checked")){
                chosenValue = $("#radio-locat34").val();
            }
            else if ($("#radio-locat35").prop("checked")){
                chosenValue = $("#radio-locat35").val();
            }
            else if ($("#radio-locat36").prop("checked")){
                chosenValue = $("#radio-locat36").val();
            }
            else if ($("#radio-locat37").prop("checked")){
                chosenValue = $("#radio-locat37").val();
            }
            else if ($("#radio-locat38").prop("checked")){
                chosenValue = $("#radio-locat38").val();
            }
            else if ($("#radio-locat39").prop("checked")){
                chosenValue = $("#radio-locat39").val();
            }
            else if ($("#radio-locat310").prop("checked")){
                chosenValue = $("#radio-locat310").val();
            }
            else if ($("#radio-locat311").prop("checked")){
                chosenValue = $("#radio-locat311").val();
            }
            else if ($("#radio-locat312").prop("checked")){
                chosenValue = $("#radio-locat312").val();
            }
            else if ($("#radio-locat313").prop("checked")){
                chosenValue = $("#radio-locat313").val();
            }
            else if ($("#radio-locat314").prop("checked")){
                chosenValue = $("#radio-locat314").val();
            }
            else if ($("#radio-locat315").prop("checked")){
                chosenValue = $("#radio-locat315").val();
            }

            locationSurveyData.locat3 = chosenValue;
        }

        function recordFirstRadioSetSurvey(){
            firstRadioSetSurveyData.smklocat = translateCheckBox($("#radio-smklocat2").prop("checked"));
            firstRadioSetSurveyData.antimsg = translateCheckBox($("#radio-antimsg2").prop("checked"));
            firstRadioSetSurveyData.promsg = translateCheckBox($("#radio-promsg2").prop("checked"));
        }

        function recordSecondRadioSetSurvey(){
            var temp1 = "";
            var temp2 = "";

            if($("#radio-alchour2").prop("checked")){
                temp1 = 2;
            }
            else if($("#radio-alchour1").prop("checked")){
                temp1 = 1;
            }

            if($("#radio-pothour2").prop("checked")){
                temp2 = 2;
            }
            else if($("#radio-pothour1").prop("checked")){
                temp2 = 1;
            }

            secondRadioSetSurveyData.alchour = temp1;
            secondRadioSetSurveyData.pothour = temp2;
        }

        function recordTobProductSurvey(){

            chosenValue = "";

            if($("#radio-tuproduct1").prop("checked")){
                chosenValue = $("#radio-tuproduct1").val();
            }
            else if ($("#radio-tuproduct2").prop("checked")){
                chosenValue = $("#radio-tuproduct2").val();
            }
            else if ($("#radio-tuproduct3").prop("checked")){
                chosenValue = $("#radio-tuproduct3").val();
            }
            else if ($("#radio-tuproduct4").prop("checked")){
                chosenValue = $("#radio-tuproduct4").val();
            }
            else if ($("#radio-tuproduct5").prop("checked")){
                chosenValue = $("#radio-tuproduct5").val();
            }
            else if ($("#radio-tuproduct6").prop("checked")){
                chosenValue = $("#radio-tuproduct6").val();
            }
            else if ($("#radio-tuproduct7").prop("checked")){
                chosenValue = $("#radio-tuproduct7").val();
            }
            else if ($("#radio-tuproduct8").prop("checked")){
                chosenValue = $("#radio-tuproduct8").val();
            }
            else if ($("#radio-tuproduct9").prop("checked")){
                chosenValue = $("#radio-tuproduct9").val();
            }
            else if ($("#radio-tuproduct10").prop("checked")){
                chosenValue = $("#radio-tuproduct10").val();
            }

            tobProductSurveyData.TUProduct = chosenValue;
        }

        function recordCigMentholSurvey(){

            if(gotoCigMenthol){
                if($("#radio-menthol2").prop("checked"))
                    cigMentholSurveyData.cigment = $("#radio-menthol2").val();

                else if($("#radio-menthol1").prop("checked"))
                    cigMentholSurveyData.cigment = $("#radio-menthol1").val();

            }
            else
                cigMentholSurveyData.cigment = 0;
        }

        //records random prompt notif survey
        function recordRandomPromptSurvey(){
            var rptFinishTime = moment();

            surveyString = '';

            recordTimeStamp();

            recordEmoSurvey();
            recordProductUrgeSurvey();
            recordCurrentActivitySurvey();
            recordWOthersSurvey();
            recordWhoNearbySurvey();
            recordWhoFamilySurvey();
            recordNearbyProductUseSurvey();
            recordLocationSurvey();
            recordFirstRadioSetSurvey();
            recordSecondRadioSetSurvey();

            surveyString = (userID + delimiter +
                    timeStamp + delimiter +
                    emoSurveyAData.happy + delimiter +
                    emoSurveyAData.relax + delimiter +
                    emoSurveyAData.cheer + delimiter +
                    emoSurveyBData.sad + delimiter +
                    emoSurveyBData.stress + delimiter +
                    emoSurveyBData.angry + delimiter +
                    emoSurveyCData.frust + delimiter +
                    emoSurveyCData.irritbl + delimiter +
                    emoSurveyCData.confdnt + delimiter +
                    productUrgeSurveyData.ulcigarette + delimiter +
                    productUrgeSurveyData.ulcigar + delimiter +
                    productUrgeSurveyData.ucigarilo + delimiter +
                    productUrgeSurveyData.ubcigar + delimiter +
                    productUrgeSurveyData.uecig + delimiter +
                    productUrgeSurveyData.uvap + delimiter +
                    productUrgeSurveyData.uhookah + delimiter +
                    productUrgeSurveyData.uchew + delimiter +
                    productUrgeSurveyData.udipsnf + delimiter +
                    productUrgeSurveyData.usnus + delimiter +
                    productUrgeSurveyData.unourge + delimiter +
                    currentActivitySurveyData.hang + delimiter +
                    currentActivitySurveyData.tvmus + delimiter +
                    currentActivitySurveyData.phone + delimiter +
                    currentActivitySurveyData.texting + delimiter +
                    currentActivitySurveyData.compint + delimiter +
                    currentActivitySurveyData.reading + delimiter +
                    currentActivitySurveyData.schl + delimiter +
                    currentActivitySurveyData.job + delimiter +
                    currentActivitySurveyData.eatdrnk + delimiter +
                    currentActivitySurveyData.alc + delimiter +
                    currentActivitySurveyData.pot + delimiter +
                    currentActivitySurveyData.party + delimiter +
                    currentActivitySurveyData.phys + delimiter +
                    currentActivitySurveyData.walking + delimiter +
                    currentActivitySurveyData.club + delimiter +
                    currentActivitySurveyData.trans + delimiter +
                    currentActivitySurveyData.noth + delimiter +
                    currentActivitySurveyData.other + delimiter +
                    wOthersSurveyData.comp + delimiter +
                    whoNearbySurveyData.alo_wthfam + delimiter +
                    whoNearbySurveyData.alo_wthpart + delimiter +
                    whoNearbySurveyData.alo_wthwork + delimiter +
                    whoNearbySurveyData.alo_wthfr + delimiter +
                    whoNearbySurveyData.alo_wthoth + delimiter +
                    whoFamilySurveyData.alo_wthmom + delimiter+
                    whoFamilySurveyData.alo_wthsib + delimiter +
                    whoFamilySurveyData.alo_wthchild + delimiter +
                    whoFamilySurveyData.alo_wthdad + delimiter +
                    whoFamilySurveyData.alo_wthrel  + delimiter +
                    nearbyProductUseSurveyData.ocig + delimiter +
                    nearbyProductUseSurveyData.olcigar + delimiter +
                    nearbyProductUseSurveyData.ocigrilo + delimiter +
                    nearbyProductUseSurveyData.obcigar + delimiter +
                    nearbyProductUseSurveyData.oecig + delimiter +
                    nearbyProductUseSurveyData.ovap + delimiter +
                    nearbyProductUseSurveyData.ohookah + delimiter +
                    nearbyProductUseSurveyData.ochew + delimiter +
                    nearbyProductUseSurveyData.odipsnf + delimiter +
                    nearbyProductUseSurveyData.osnus + delimiter +
                    nearbyProductUseSurveyData.onone + delimiter +
                    locationSurveyData.locat3 + delimiter +
                    firstRadioSetSurveyData.smklocat + delimiter +
                    firstRadioSetSurveyData.antimsg + delimiter +
                    firstRadioSetSurveyData.promsg + delimiter +
                    secondRadioSetSurveyData.alchour + delimiter +
                    secondRadioSetSurveyData.pothour);


            if(!takingTestSurvey){

                finishedRandomPromptSurvey = true;

                //Check amount of time since having started rpt survey... if less than say 5 minutes, do not record survey output
                //and record survey as abandoned
                if(Math.abs(rptStartTime.diff(rptFinishTime, 'seconds')) < timeToTakeSurvey ){
                    //writeToRandomPromptIntFile(surveyString + '\n', true, function(){
                    writeToRandomPromptIntFile(surveyString + '\n', true, function(){

                        resetSurveyWidgets();
                        alert("Thank you for completing an Random Prompt Interview!");
                        numSurveysTaken += 1;
                        numNotifsNotMissed += 1;
                    });
                }
                else{
                    //register rpt survey as having been missed
                    addToMissedNotifs(1, moment().toDate().toString());
                    resetSurveyWidgets();
                    numSurveysTaken += 1;
                    alert("More than 5 minutes have passed since beginning a Random Prompt Interview.\nThis interview has been recorded as being missed.\nPlease remember to complete interviews upon receiving a Random Prompt Notification");
                }
            }

            else{
                resetSurveyWidgets();
                alert("Thank you for taking a demo interview. This input will NOT be recorded.");
            }
            //writeToRandomPromptIntFile(surveyString + '\n', false, resetSurveyWidgets);

            //reset variables so that if a user takes a tobacco use interview after the random prompt interview, the survey
            //will have correct traversal
            //startRandomPromptInterview(false, false);
            startLoginToMain(false);

            //notifCheckAndAdd();
            //addNotifNow();
        }

        function recordTobaccoUseInterviewSurvey(callback){
            surveyString = '';

            recordTimeStamp();

            recordTobProductSurvey();
            recordCigMentholSurvey();
            recordEmoSurvey();
            recordWhenUsingTobSurvey();
            recordCurrentActivitySurvey();
            recordWOthersSurvey();
            recordWhoNearbySurvey();
            recordWhoFamilySurvey();
            recordNearbyProductUseSurvey();
            recordLocationSurvey();
            recordFirstRadioSetSurvey();
            recordSecondRadioSetSurvey();
            recordBEmoSurvey();


            surveyString = (userID + delimiter +
                    timeStamp + delimiter +
                    tobProductSurveyData.TUProduct + delimiter +
                    cigMentholSurveyData.cigment + delimiter +
                    emoSurveyAData.happy + delimiter +
                    emoSurveyAData.relax + delimiter +
                    emoSurveyAData.cheer + delimiter +
                    emoSurveyBData.sad + delimiter +
                    emoSurveyBData.stress + delimiter +
                    emoSurveyBData.angry + delimiter +
                    emoSurveyCData.frust + delimiter +
                    emoSurveyCData.irritbl + delimiter +
                    emoSurveyCData.confdnt + delimiter +
                    whenUsingTobSurveyData.pleasur + delimiter +
                    whenUsingTobSurveyData.satisfy + delimiter +
                    currentActivitySurveyData.hang + delimiter +
                    currentActivitySurveyData.tvmus + delimiter +
                    currentActivitySurveyData.phone + delimiter +
                    currentActivitySurveyData.texting + delimiter +
                    currentActivitySurveyData.compint + delimiter +
                    currentActivitySurveyData.reading + delimiter +
                    currentActivitySurveyData.schl + delimiter +
                    currentActivitySurveyData.job + delimiter +
                    currentActivitySurveyData.eatdrnk + delimiter +
                    currentActivitySurveyData.alc + delimiter +
                    currentActivitySurveyData.pot + delimiter +
                    currentActivitySurveyData.party + delimiter +
                    currentActivitySurveyData.phys + delimiter +
                    currentActivitySurveyData.walking + delimiter +
                    currentActivitySurveyData.club + delimiter +
                    currentActivitySurveyData.trans + delimiter +
                    currentActivitySurveyData.noth + delimiter +
                    currentActivitySurveyData.other + delimiter +
                    wOthersSurveyData.comp + delimiter +
                    whoNearbySurveyData.alo_wthfam + delimiter +
                    whoNearbySurveyData.alo_wthpart + delimiter +
                    whoNearbySurveyData.alo_wthwork + delimiter +
                    whoNearbySurveyData.alo_wthfr + delimiter +
                    whoNearbySurveyData.alo_wthoth + delimiter +
                    whoFamilySurveyData.alo_wthmom + delimiter+
                    whoFamilySurveyData.alo_wthsib + delimiter +
                    whoFamilySurveyData.alo_wthchild + delimiter +
                    whoFamilySurveyData.alo_wthdad + delimiter +
                    whoFamilySurveyData.alo_wthrel  + delimiter +
                    nearbyProductUseSurveyData.ocig + delimiter +
                    nearbyProductUseSurveyData.olcigar + delimiter +
                    nearbyProductUseSurveyData.ocigrilo + delimiter +
                    nearbyProductUseSurveyData.obcigar + delimiter +
                    nearbyProductUseSurveyData.oecig + delimiter +
                    nearbyProductUseSurveyData.ovap + delimiter +
                    nearbyProductUseSurveyData.ohookah + delimiter +
                    nearbyProductUseSurveyData.ochew + delimiter +
                    nearbyProductUseSurveyData.odipsnf + delimiter +
                    nearbyProductUseSurveyData.osnus + delimiter +
                    nearbyProductUseSurveyData.onone + delimiter +
                    locationSurveyData.locat3 + delimiter +
                    firstRadioSetSurveyData.smklocat + delimiter +
                    firstRadioSetSurveyData.antimsg + delimiter +
                    firstRadioSetSurveyData.promsg + delimiter +
                    secondRadioSetSurveyData.alchour + delimiter +
                    secondRadioSetSurveyData.pothour + delimiter +
                    beforeTobEmoSurveyAData.bhappy + delimiter +
                    beforeTobEmoSurveyAData.brelax + delimiter +
                    beforeTobEmoSurveyAData.bcheer + delimiter +
                    beforeTobEmoSurveyBData.bsad + delimiter +
                    beforeTobEmoSurveyBData.bstress + delimiter +
                    beforeTobEmoSurveyBData.bangry + delimiter +
                    beforeTobEmoSurveyCData.bfrust + delimiter +
                    beforeTobEmoSurveyCData.birritbl + delimiter +
                    beforeTobEmoSurveyCData.bconfdnt);

            //writeToTobaccoUseIntFile(surveyString+ '\n', true, function(){
            writeToTobaccoUseIntFile(surveyString+ '\n', true, function(){
                resetSurveyWidgets();
                alert("Thank you for completing a Tobacco Use Interview!");
            });

            //startRandomPromptInterview(false, false);
            startLoginToMain(false);

        }

        //Below functions determine the navigation from pages to other pages
        function setSurveyFromWOthersSurvey(){
            //Set comp's value:

            if($("#radio-comp1").prop("checked"))
                wOthersSurveyData.comp = $("#radio-comp1").val();

            else if($("#radio-comp2").prop("checked"))
                wOthersSurveyData.comp = $("#radio-comp2").val();

            else if($("#radio-comp3").prop("checked"))
                wOthersSurveyData.comp = $("#radio-comp3").val();
            
            checkboxGroupAnswered('wOthersSurvey', 'Radios', function(answered){

                //If alone:
                //Need to reset all answers within 5a (who nearby), 5a1(who family) and 5b(who tob product use) in case they answered them already and back tracked to re-
                //answer as alone
                if(wOthersSurveyData.comp == 1 && answered){
                    goto5a = false;
                    goto5a1 = false;

                    $("#locationSurveyBack").attr("href", "#wOthersSurvey");
                    $("#wOthersSurveyGo").attr("href", "#locationSurvey");

                    $("#whoNearbySurveyCheckboxes input:checked").prop("checked", false);
                    $("#whoNearbySurveyCheckboxes .check").checkboxradio("refresh");

                    $("#whoFamilySurveyCheckboxes input:checked").prop("checked", false);
                    $("#whoFamilySurveyCheckboxes .check").checkboxradio("refresh");

                    $("#nearbyProductUseSurveyCheckboxes input:checked").prop("checked", false);
                    $("#nearbyProductUseSurveyCheckboxes .check").checkboxradio("refresh");
                }

                //If not alone
                else if((wOthersSurveyData.comp == 2 || wOthersSurveyData.comp == 3)  && answered ){
                    goto5a = true;
                    goto5a1 = false;// set/reset to false for now


                    $("#locationSurveyBack").attr("href", "#nearbyProductUseSurvey");
                    $("#wOthersSurveyGo").attr("href", "#whoNearbySurvey");

                }

            });
            //console.log(tempString);
            console.log($("#wOthersSurveyGo").attr("href"));
            console.log("\n#locationSurveyBack:" + $("#locationSurveyBack").attr("href"));
        }

        function setSurveyFromWhoNearbySurvey(){
            if(goto5a){
                whoNearbySurveyData.alo_wthfam = translateCheckBox($("#checkbox-alo_wthfam").prop("checked"));
                whoNearbySurveyData.alo_wthpart = translateCheckBox($("#checkbox-alo_wthpart").prop("checked"));
                whoNearbySurveyData.alo_wthwork = translateCheckBox($("#checkbox-alo_wthwork").prop("checked"));
                whoNearbySurveyData.alo_wthfr = translateCheckBox($("#checkbox-alo_wthfr").prop("checked"));
                whoNearbySurveyData.alo_wthoth = translateCheckBox($("#checkbox-alo_wthoth").prop("checked"));
            }

            checkboxGroupAnswered('whoNearbySurvey', 'Checkboxes', function(answered){
                    //set go and back buttons:

                    //if near family
                    if(whoNearbySurveyData.alo_wthfam == 2 && answered){
                        goto5a1 = true;
                        //console.log("\nwithin whoNearbySurveyData.alo_wthfam == 2");
                        $("#whoNearbySurveyGo").attr("href", "#whoFamilySurvey");
                        $("#nearbyProductUseSurveyBack").attr("href", "#whoFamilySurvey");

                    }

                    //if not near family
                    else if(whoNearbySurveyData.alo_wthfam == 1 && answered){
                        //console.log("\nwithin whoNearbySurveyData.alo_wthfam == 1");
                        goto5a1 = false;

                        $("#whoNearbySurveyGo").attr("href", "#nearbyProductUseSurvey");
                        $("#nearbyProductUseSurveyBack").attr("href", "#whoNearbySurvey");

                        //Reset who family survey and nearbyProduct useSurvey answers
                        $("#whoFamilySurveyCheckboxes input:checked").prop("checked", false);
                        $("#whoFamilySurveyCheckboxes .check").checkboxradio("refresh");

                        $("#nearbyProductUseSurveyCheckboxes input:checked").prop("checked", false);
                        $("#nearbyProductUseSurveyCheckboxes .check").checkboxradio("refresh");

                    }
                    else{
                        $("#whoNearbySurveyGo").attr("href","#");
                    }
            });

            console.log("\n#whoNearbySurveyGo:" + $("#whoNearbySurveyGo").attr("href"));
            console.log("\n#nearbyProductUseSurveyBack:" + $("#nearbyProductUseSurveyBack").attr("href"));
        }


        //Function looks 30 minutes into the future and if a notification will fire before then, but after now, will cancel it.
        function cancelFutureNotif(callback){

            //Need to check 30 minutes in to future to see if an upcoming notif will fire... if so, cancel that notif
            for(var i = 0; i < notifTimes.length; i++){
                if(notifTimes[i]){
                    if(( notifTimes[i].isAfter(moment()) ) && (  notifTimes[i].isBefore(moment().add("minutes", 30)) ) ){
                        window.plugin.notification.local.cancel(i + 1);
                        console.log("\ncancelled notif " + (i + 1) + " as it was scheduled to go off at " + notifTimes[i]);
                        notifTimes[i] = null;
                        break;
                    }
                }
            }

            if(typeof(callback)==="function"){
                 callback();
            }
        }

        //Below functions make certain that all radio sets have been answered, otherwise will not assign a next page link
        //in the survey--user cannot proceed, they must answer all radio widget groups on the page
        function finishEmoSurveyA(){

            /*
            console.log("#radio-happy.val() = " + $("#radio-happy").val() +
                        " #radio-relax.val() = " + $("#radio-relax").val() +
                        " #radio-cheer.val() = " + $("#radio-cheer").val());
                        */

            console.log("$('input:radio[name=radio-happy]:checked').val() = " + $('input:radio[name=radio-happy]:checked').val() +
                    "$('input:radio[name=radio-relax]:checked').val() = " + $('input:radio[name=radio-relax]:checked').val() +
                    "$('input:radio[name=radio-cheer]:checked').val() = " + $('input:radio[name=radio-cheer]:checked').val());

            var n1 = $('input:radio[name=radio-happy]:checked').length;
            var n2 = $('input:radio[name=radio-relax]:checked').length;
            var n3 = $('input:radio[name=radio-cheer]:checked').length;

            console.log("number of checked in radio-happy: " + n1);
            console.log("number of checked in radio-relax: " + n2);
            console.log("number of checked in radio-cheer: " + n3);

            if(n1 != 0 && n2 != 0 && n3 != 0){
                $("#emoSurveyAGo").attr("href", "#emoSurveyB");
                visitedEmoSurveyA = true;

            }

            else
                $("#emoSurveyAGo").attr("href", "#");
        }


        function finishEmoSurveyB(){

            console.log("$('input:radio[name=radio-sad]:checked').val() = " + $('input:radio[name=radio-sad]:checked').val() +
                    "$('input:radio[name=radio-stress]:checked').val() = " + $('input:radio[name=radio-stress]:checked').val() +
                    "$('input:radio[name=radio-angry]:checked').val() = " + $('input:radio[name=radio-angry]:checked').val());

            var n1 = $('input:radio[name=radio-sad]:checked').length;
            var n2 = $('input:radio[name=radio-stress]:checked').length;
            var n3 = $('input:radio[name=radio-angry]:checked').length;

            console.log("number of checked in radio-sad: " + n1);
            console.log("number of checked in radio-stress: " + n2);
            console.log("number of checked in radio-angry: " + n3);

            if((n1 != 0 && n2 != 0 && n3 != 0)){
                $("#emoSurveyBGo").attr("href", "#emoSurveyC");
                visitedEmoSurveyB = true;

            }
            else
                $("#emoSurveyBGo").attr("href", "#");

        }


        function finishEmoSurveyC(){

            console.log("$('input:radio[name=radio-frust]:checked').val() = " + $('input:radio[name=radio-frust]:checked').val() +
                    "$('input:radio[name=radio-irritbl]:checked').val() = " + $('input:radio[name=radio-irritbl]:checked').val() +
                    "$('input:radio[name=radio-confdnt]:checked').val() = " + $('input:radio[name=radio-confdnt]:checked').val());

            var n1 = $('input:radio[name=radio-frust]:checked').length;
            var n2 = $('input:radio[name=radio-irritbl]:checked').length;
            var n3 = $('input:radio[name=radio-confdnt]:checked').length;

            console.log("number of checked in radio-frust: " + n1);
            console.log("number of checked in radio-irritbl: " + n2);
            console.log("number of checked in radio-confdnt: " + n3);

            if(n1 != 0 && n2 != 0 && n3 != 0){

                visitedEmoSurveyC = true;

                if(writingToRandomPromptInt){
                    $("#emoSurveyCGo").attr("href", "#productUrgeSurvey");

                }

                else
                    $("#emoSurveyCGo").attr("href", "#whenUsingTobSurvey");

            }
            else
                $("#emoSurveyCGo").attr("href", "#");

        }


        function finishBeforeTobEmoSurveyA(){

            console.log("$('input:radio[name=radio-bhappy]:checked').val() = " + $('input:radio[name=radio-bhappy]:checked').val() +
                    "$('input:radio[name=radio-brelax]:checked').val() = " + $('input:radio[name=radio-brelax]:checked').val() +
                    "$('input:radio[name=radio-bcheer]:checked').val() = " + $('input:radio[name=radio-bcheer]:checked').val());

            var n1 = $('input:radio[name=radio-bhappy]:checked').length;
            var n2 = $('input:radio[name=radio-brelax]:checked').length;
            var n3 = $('input:radio[name=radio-bcheer]:checked').length;

            console.log("number of checked in radio-bhappy: " + n1);
            console.log("number of checked in radio-brelax: " + n2);
            console.log("number of checked in radio-bcheer: " + n3);

            if(n1 != 0 && n2 != 0 && n3 != 0){
                $("#beforeTobEmoSurveyAGo").attr("href", "#beforeTobEmoSurveyB");
                visitedBeforeTobEmoSurveyA=true;

            }

            else
                $("#beforeTobEmoSurveyAGo").attr("href", "#");
        }

        function finishBeforeTobEmoSurveyB(){

            console.log("$('input:radio[name=radio-bsad]:checked').val() = " + $('input:radio[name=radio-bsad]:checked').val() +
                    "$('input:radio[name=radio-bstress]:checked').val() = " + $('input:radio[name=radio-bstress]:checked').val() +
                    "$('input:radio[name=radio-bangry]:checked').val() = " + $('input:radio[name=radio-bangry]:checked').val());

            var n1 = $('input:radio[name=radio-bsad]:checked').length;
            var n2 = $('input:radio[name=radio-bstress]:checked').length;
            var n3 = $('input:radio[name=radio-bangry]:checked').length;

            console.log("number of checked in radio-bsad: " + n1);
            console.log("number of checked in radio-bstress: " + n2);
            console.log("number of checked in radio-bangry: " + n3);

            if(n1 != 0 && n2 != 0 && n3 != 0){
                $("#beforeTobEmoSurveyBGo").attr("href", "#beforeTobEmoSurveyC");
                visitedBeforeTobEmoSurveyB=true;

            }
            else
                $("#beforeTobEmoSurveyBGo").attr("href", "#");

        }

        //Last page of TUI survey
        function finishBeforeTobEmoSurveyC(){

            console.log("$('input:radio[name=radio-bfrust]:checked').val() = " + $('input:radio[name=radio-bfrust]:checked').val() +
                    "$('input:radio[name=radio-birritbl]:checked').val() = " + $('input:radio[name=radio-birritbl]:checked').val() +
                    "$('input:radio[name=radio-bconfdnt]:checked').val() = " + $('input:radio[name=radio-bconfdnt]:checked').val());

            var n1 = $('input:radio[name=radio-bfrust]:checked').length;
            var n2 = $('input:radio[name=radio-birritbl]:checked').length;
            var n3 = $('input:radio[name=radio-bconfdnt]:checked').length;

            console.log("number of checked in radio-bfrust: " + n1);
            console.log("number of checked in radio-birritbl: " + n2);
            console.log("number of checked in radio-bconfdnt: " + n3);

            if(n1 != 0 && n2 != 0 && n3 != 0){

                $("#beforeTobEmoSurveyCGo").attr("href", "#main");
                visitedBeforeTobEmoSurveyC=true;
                recordTobaccoUseInterviewSurvey();
            }
            else
                $("#beforeTobEmoSurveyCGo").attr("href", "#");

        }

        function finishWhenUsingTobSurvey(){

            console.log("$('input:radio[name=radio-pleasur]:checked').val() = " + $('input:radio[name=radio-pleasur]:checked').val() +
                    "$('input:radio[name=radio-satisfy]:checked').val() = " + $('input:radio[name=radio-satisfy]:checked').val());

            var n1 = $('input:radio[name=radio-pleasur]:checked').length;
            var n2 = $('input:radio[name=radio-satisfy]:checked').length;

            console.log("number of checked in radio-pleasur: " + n1);
            console.log("number of checked in radio-satisfy: " + n2);

            if(n1 != 0 && n2 != 0){
                $("#whenUsingTobSurveyGo").attr("href", "#currentActivitySurvey");
                $("#currentActivitySurveyBack").attr("href", "#whenUsingTobSurvey");
                visitedWhenUsingTobSurvey = true;
            }

            else{
                $("#whenUsingTobSurveyGo").attr("href", "#");
            }
        }


        function finishProductUrgeSurvey(){
            //console.log("\nwritingToRandomPromptInt: " + writingToRandomPromptInt);
            checkboxGroupAnswered('productUrgeSurvey', 'Checkboxes', function(answered){
                if(answered){

                    if(writingToRandomPromptInt){

                        console.log("\nanswered a checkbox");
                        $("#productUrgeSurveyGo").attr('href', '#currentActivitySurvey');
                        $("#currentActivitySurveyBack").attr('href','#productUrgeSurvey')

                    }
                }
                else{
                    console.log("\ndid not answer a checkbox");
                    $("#productUrgeSurveyGo").attr('href', '#');
                }

                console.log("\n productUrgeSurveyGo href: " + $("#productUrgeSurveyGo").attr('href'));
            });
        }


        function finishCurrentActivitySurvey(){
            checkboxGroupAnswered('currentActivitySurvey', 'Checkboxes', function(answered){
                if(answered){
                    $("#currentActivitySurveyGo").attr('href', '#wOthersSurvey');

                }
                else{
                    $("#currentActivitySurveyGo").attr('href', '#');
                }
                console.log("\n currentActivitySurveyGo href: " + $("#currentActivitySurveyGo").attr('href'));
            })

        }



        function finishWhoFamilySurvey(){
            checkboxGroupAnswered('whoFamilySurvey', 'Checkboxes', function(answered){
                if(answered){
                    $("#whoFamilySurveyGo").attr('href', '#nearbyProductUseSurvey');

                }
                else{
                    $("#whoFamilySurveyGo").attr('href', '#');
                }
                console.log("\n whoFamilySurveyGo href: " + $("#whoFamilySurveyGo").attr('href'));
            });
        }

        function finishNearbyProductUseSurvey(){
            checkboxGroupAnswered('nearbyProductUseSurvey', 'Checkboxes', function(answered){
                if(answered){
                    console.log("\nanswered a checkbox");
                    $("#nearbyProductUseSurveyGo").attr('href', '#locationSurvey');

                    //$.mobile.navigate("#currentActivitySurvey');
                }

                else{
                    console.log("\ndid not answer a checkbox");
                    $("#nearbyProductUseSurveyGo").attr('href', '#');
                }

                console.log("\n nearbyProductUseSurveyGo href: " + $("#nearbyProductUseSurveyGo").attr('href'));
            });
        }

        function finishLocationSurvey(){
            checkboxGroupAnswered('locationSurvey', 'Radios', function(answered){
                if(answered){
                    console.log("\nanswered a radio");
                    $("#locationSurveyGo").attr('href', '#firstRadioSetSurvey');

                    //$.mobile.navigate("#currentActivitySurvey');
                }

                else{
                    console.log("\ndid not answer a checkbox");
                    $("#locationSurveyGo").attr('href', '#');
                }

                console.log("\n locationSurveyGo href: " + $("#locationSurveyGo").attr('href'));
            });

        }


        function finishFirstRadioSetSurvey(){

            var answered1 = false;
            var answered2 = false;
            var answered3 = false;



            if($("#radio-smklocat2").prop("checked")){
                answered1 = true;
            }
            else if($("#radio-smklocat1").prop("checked")){
                answered1 = true;
            }


            if($("#radio-antimsg2").prop("checked")){
                answered2 = true;
            }
            else if($("#radio-antimsg1").prop("checked")){
                answered2 = true;
            }


            if($("#radio-promsg2").prop("checked")){
                answered3 = true;
            }
            else if($("#radio-promsg1").prop("checked")){
                answered3 = true;
            }



            if(answered1 && answered2 && answered3){
                console.log("\nanswered all radios");
                $("#firstRadioSetSurveyGo").attr('href', '#secondRadioSetSurvey');

            }
            else{
                console.log("\ndid not answer all checkboxes");
                $("#firstRadioSetSurveyGo").attr('href', '#');
            }
        }

        function finishSecondRadioSetSurvey(){

            var answered1 = false;
            var answered2 = false;

            if($("#radio-alchour2").prop("checked")){
                answered1 = true;
            }
            else if($("#radio-alchour1").prop("checked")){
                answered1 = true;
            }

            if($("#radio-pothour2").prop("checked")){
                answered2 = true;
            }
            else if($("#radio-pothour1").prop("checked")){
                answered2 = true;
            }

            if(answered1 && answered2){
                if(writingToRandomPromptInt){

                    //Criteria for not registering as 'abdndoned survey'
                    hasMissedNotif = false;
                    missedNotifs = 0;
                    finishedRandomPromptSurvey = true;
                    startedRandomPromptSurvey = false;

                    console.log("\nanswered all radios");
                    //$("#secondRadioSetSurveyGo").attr('href', '#main');
                    $.mobile.navigate("#main");
                    recordRandomPromptSurvey();

                    //$.mobile.navigate("#currentActivitySurvey');
                }
                else{
                    console.log("\nanswered all radios");
                    $.mobile.navigate("#beforeTobEmoSurveyA");
                    //$("#secondRadioSetSurveyGo").attr('href', '#beforeTobEmoSurveyA');
                }
            }
            else{
                console.log("\ndid not answer all checkboxs");
                $("#secondRadioSetSurveyGo").attr('href', '#');
            }

        }

        function finishTobProductSurvey(){
            var chosenValue = "";

            checkboxGroupAnswered('tobProductSurvey', 'Radios', function(answered){
                if(answered){
                    if($("#radio-tuproduct1").prop("checked")){

                       gotoCigMenthol = true;
                       $("#tobProductSurveyGo").attr('href', '#cigMentholSurvey');
                       $("#emoSurveyABack").attr('href', '#cigMentholSurvey');

                    }

                    //if not chosen cigarette...
                    //Change back and go buttons to correct anchors
                    //In case of a user initially choosing cigarette, then choosing menthol or not, then reverseing to
                    //choose a product other than cigarette, need to change the menthol widgets to clear
                    else{
                       gotoCigMenthol = false;
                       $("#tobProductSurveyGo").attr('href', '#emoSurveyA');
                       $("#emoSurveyABack").attr('href', '#tobProductSurvey');



                        $("#cigMentholSurveyRadios input:checked").prop("checked", false);
                       $("#cigMentholSurveyRadios .radio").checkboxradio("refresh");
                    }
                    //Need to set text for question 3... when using tobacco...


                    if($("#radio-tuproduct1").prop("checked")){
                        chosenValue = "Cigarette";
                    }
                    else if ($("#radio-tuproduct2").prop("checked")){
                        chosenValue = "Little Cigar";
                    }
                    else if ($("#radio-tuproduct3").prop("checked")){
                        chosenValue = "Cigarillo";
                    }
                    else if ($("#radio-tuproduct4").prop("checked")){
                        chosenValue = "Big Cigar";
                    }
                    else if ($("#radio-tuproduct5").prop("checked")){
                        chosenValue = "e-cigarette";
                    }
                    else if ($("#radio-tuproduct6").prop("checked")){
                        chosenValue = "Vaporizer";
                    }
                    else if ($("#radio-tuproduct7").prop("checked")){
                        chosenValue = "Hookah";
                    }
                    else if ($("#radio-tuproduct8").prop("checked")){
                        chosenValue = "Chew";
                    }
                    else if ($("#radio-tuproduct9").prop("checked")){
                        chosenValue = "Dip/Snuff";
                    }
                    else if ($("#radio-tuproduct10").prop("checked")){
                        chosenValue = "Snus";
                    }

                    $("#pleasurLabel").text("How pleasurable was the " + chosenValue + "?");
                    $("#satisfyLabel").text("How satisfying was the " + chosenValue + "?");
                }

                else{
                    console.log("\ndid not answer a checkbox");
                    $("#tobProductSurveyGo").attr('href', '#');
                }

            });

            console.log("\nChosen Value: " + chosenValue);
            console.log("\n tobProductSurveyGo href: " + $("#tobProductSurveyGo").attr('href')
                      + "\n emoSurveyABack href:     " + $("#emoSurveyABack").attr('href'));
        }



        function finishCigMentholSurvey(){
            checkboxGroupAnswered('cigMentholSurvey', 'Radios', function(answered){

                if(answered){
                    $("#cigMentholSurveyGo").attr("href", "#emoSurveyA");

                }
                else{
                    $("#cigMentholSurveyGo").attr("href", "#");
                }

            });
            console.log("\n cigMentholSurveyGo href: " + $("#cigMentholSurveyGo").attr('href'));

        }



        //translates passed string of checkbox to needed data value... on, undefined ---> 2, 1
        function translateCheckBox(passedChecked){
           checkboxCount += 1;

           //console.log('\n' + 'Checkbox ' + checkboxCount.toString() + ' ' + passedChecked);
           if(passedChecked){
               return '2';
           }
           else{
               return '1';
           }

        }


        function checkboxGroupAnswered(id, type, callback){
            var answer;
            var n = $( "#" + id + type +" input:checked" ).length;
            console.log("\n" + n + " checked checkboxes");

            if(n != 0){
                answer = true;
            }
            else{
                answer = false;
            }



            if (typeof(callback) === 'function'){
                callback(answer);
            }
        }



        //Aux function that creates a randomized moment object between two ranges
        function randomMoment(mStart, mEnd) {
            var dStart, dEnd;
            dStart = mStart.toDate();
            dEnd = mEnd.toDate();

            var randMoment, tempDate;

            tempDate = new Date(dStart.getTime() + Math.random() * (dEnd.getTime() - dStart.getTime()));
            randMoment = moment(tempDate);

            //console.log(randMoment.format());

            return randMoment;
        }


        //This function uses moment.js:
        //Populates partitionTimes only!!   Does not actually add notifs!
        //Need to have waketime and bedtimes decided before here!
        //This version only adds an absence of notifs for the first period of timeAsleep, afterward, adds notifs throughout
        // the next day
        function setPartitionNotifsForDaysV2(numDays, fromWakeUp, callback){
            console.log("\nsetPartitionNotifsForDaysV2()");
            //Will always subtract bedtime from waketime, as bedtime will always come after waketime
            //var partitionAmt = Math.abs((bedTimeDate.toDate() - wakeTimeDate.toDate())) / surveysInADay;
            var tempTimeAsleep = Number(timeAsleep);
            var tempTimeAwake = Number(timeAwake);

            var partitionAmt = Math.abs((tempTimeAwake * 60 * 1000)) / surveysInADay;

            partitionaAmt = Math.round(Math.abs(partitionAmt));


            surveysInADay = 10;
            //console.log("\nPartition amount during first wake period:      " + partitionAmt);

            //didMissNotifArr = [];
            //partitionTimes = [];

            //var oldMoment = moment(passedDate).hours(wakeTimeDate.hours()).minutes(wakeTimeDate.minutes());
            //var newMoment = moment(oldMoment).add('milliseconds', partitionAmt);

            var oldMoment = moment(wakeTimeDate);
            var newMoment = moment(oldMoment).add('milliseconds', partitionAmt);

            //console.log("\noldMoment: " + oldMoment);
            //console.log("\nnewMoment: " + newMoment)

            var randMoment;

            var bufferedOldMoment, bufferedNewMoment;

            for(var i = 0; i < (parseInt(numDays) * surveysInADay); i++){

                //Every time we reach the max number of surveys in a day, start over and partition notifs for the next day


                if(i % surveysInADay == 0 && i != 0 && (i != (parseInt(numDays) * surveysInADay))){

                    //console.log('\noldMoment: ' + moment(oldMoment).format("dddd, MMMM Do YYYY, HH:mm:ss a"))
                    //console.log('\ntimeAsleep: ' + timeAsleep);
                    tempTimeAsleep = 1;
                    tempTimeAwake =  Math.abs(tempTimeAsleep - 24 * 60);
                    surveysInADay = 10;
                    //surveysInADay = 200;

                    partitionAmt =  Math.round(Math.abs((24 * 60 * 60 * 1000) / surveysInADay));
                    //console.log("\nPartition amount after first wake period: " + partitionAmt);
                    oldMoment.add('minutes', tempTimeAsleep);
                    //console.log('\noldMoment after adding timeAsleep: ' + moment(oldMoment).format("dddd, MMMM Do YYYY, HH:mm:ss a"));

                    newMoment = moment(oldMoment).add('milliseconds', partitionAmt);
                    //console.log('\nnewMoment from oldMoment: ' + moment(newMoment).format("dddd, MMMM Do YYYY, HH:mm:ss a") );
                }

                bufferedOldMoment = oldMoment.clone().add('minutes', bufferMins);
                bufferedNewMoment = newMoment.clone().subtract('minutes', bufferMins)

                randMoment = randomMoment(bufferedOldMoment, bufferedNewMoment);

                console.log('\n' + randMoment.toDate().toString());

                partitionTimes.push(randMoment);
                //didMissNotifArr.push(true);

                oldMoment = newMoment;
                newMoment = moment(newMoment);
                newMoment.add('milliseconds', partitionAmt);
            }

            surveysInADay = 10;
            //surveysInADay = 200;

            //console.log('\nend of setPartitionNotifs()');

            if (typeof(callback) === 'function'){
                callback();
            }
        }



        //traverse partitiontimes, for all times that are greater than the current time,
        //add dates those dates to notiftimes
        function notifCheckAndAdd(){
            console.log("\nnotifCheckAndAdd()");

            notifTimes = [];

            //reset timeAsleep and timeAwake here, so that if we need to repopulate notifs, it will do that for 24 hour period, not base don timeAwake
            timeAsleep = 1;
            timeAwake = Math.abs(timeAsleep - (24 * 60));

            //Same reason as above... need to reset variables so that repopulating notifs after this will populate for 24 hour period
            wakeTimeDate = moment(defaultWakeTime);
            bedTimeDate = moment(defaultBedTime);

            var tempMoment;
            var now = moment();

            console.log("\nWithin notifCheckAndAdd()\nAdded:");

            for(var i = 0; i < partitionTimes.length; i++){
                tempMoment = moment(partitionTimes[i]);

                if(tempMoment.isAfter(now)){
                    notifCount += 1;
                    addNotifAtTime(tempMoment.toDate(), notifCount);
                    notifTimes.push(tempMoment);
                    //if(notifCount <= 5)
                        //console.log('\nAdded #' + notifCount + ' @' + tempMoment.format('dddd, MMMM Do, HH:mm:ss a'));
                    //break;
                }
            }

            //There may be an instance where no notifs will be added for a day... when setting the waketime, will also set bedtime
            //as current time, therefore no more notifs for that day...
            if (notifCount == 0){
                console.log("\nNOTIFICATION COUNT = 0");
                //clearPriorNotifs(addNewNotifs);
                //formNotifString(writeToNotifFile);
            }
        }


        //Convenience function to called every time a notification is added
        function addNotifAtTime(passedDate, passedNo, callback){
            //notifyDateObj = Date.parse(passedStringDate);
            var tempDate = new Date(passedDate);
            var tempStr = tempDate.toString();

            window.plugin.notification.local.add({
                id:         passedNo,
                date:       tempDate,
                message:    "Tap to take a survey",
                title:      'Random Prompt Notification',
                //autoCancel: true,
                sound:      notifAudioLoc,
                json:       JSON.stringify({ date: tempStr}),
                badge:      parseInt(passedNo),
                ongoing:    true
                //duration:   (3 * 60 * 1000)
            });

            console.log('\nadded notif ' + passedNo.toString() + ' @ ' + tempStr);

            if(typeof(callback) === 'function'){
                callback();
            }
        }


        //Convenience function to record missed notification type to the missed notification file
        function addToMissedNotifs(missType, passedDateString){
            var concatStr;

            concatStr = userID + delimiter + missType.toString() + delimiter + passedDateString + '\n';
            writeToMissedNotifsFile(concatStr);
        }


        //
        function recordState(callback){
            var concString = currentState;
            concString += ', ';

            if(resumeTime)
                concString += resumeTime.toString();
            else
                concString += resumeTime;

            writeToStateFile(concString, false);

            if(typeof(callback)==='function'){
                callback();
            }
        }

        //Assigns values saved in local text to global variables to be used in program... important for when
        //app decides to restart for no good fucking reason upon clicking a notif...
        function determineState(callback){

            var stateArr = [];
            var timeStr = '';

            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fs){

                var entry = fs.root;
                entry.getDirectory("alt", {create: true, exclusive: false}, function(directory){

                    directory.getFile('State.state', null, function(fe){
                        console.log('\nwithin determine state, got file');

                        fe.file(function(file){
                            //console.log('\nwithin readFromFile file()');
                            var reader = new FileReader();

                            reader.onloadend = function(evt){
                                //console.log("\nRead as text");
                                content = evt.target.result;
                                //console.log(content);

                                stateArr = content.split(', ');

                                currentState = stateArr[0];
                                timeStr = stateArr[1];

                                if(timeStr == '' || timeStr == null || timeStr =='null')
                                    resumeTime = null;
                                else
                                    resumeTime = moment(timeStr).toDate();

                                console.log("\ncurrentState: " + currentState);

                                if(resumeTime)
                                    console.log("\nresumeTime: " + moment(resumeTime).format("MMM D, h:mm a"));
                                else
                                    console.log("\nresumeTime: " + resumeTime);
                            }

                            reader.readAsText(file);
                        }, onFSError);
                    }, onFSError);
                }, onGetDirectoryFail);
            }, onFSError);

            if(typeof(callback) === 'function'){

                //setTimeout(function(){
                    callback();
                //}, 1000)

            }

        }



        //Opens Not.not and reads in all times that were saved.
        function readInNotifTimes(callback){
            var tempNotifTimes = [];
            notifTimes = [];

            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fs){

                var entry = fs.root;
                entry.getDirectory("alt", {create: false, exclusive: false}, function(directory){

                    directory.getFile('Not.not', null, function(fe){
                        console.log('\nwithin readInNotifTimes, got file');

                        fe.file(function(file){
                            //console.log('\nwithin readFromFile file()');
                            var reader = new FileReader();

                            reader.onloadend = function(evt){
                                //console.log("\nRead as text");
                                content = evt.target.result;
                                //console.log(content);

                                tempNotifTimes = content.split(/[\r\n]+/g);

                                console.log(tempNotifTimes[tempNotifTimes.length - 2]);
                                console.log("\nlast recorded notifTime is after now? " + moment(tempNotifTimes[tempNotifTimes.length - 2]).isAfter(moment()));

                                //for(var i = 0; i < tempNotifTimes.length - 1; i++){
                                    //console.log(tempNotifTimes[i]);
                                //}

                                //Check last time within recorded notif times, if it is after current moment, then
                                //There must be notifs that have already been added, otherwise, all of the notif times are old
                                //And can be replaced with new times
                                //arr.length - 2 because the delimiter added at the end of every recorded notif time means there will be an extra null at the last element of the arr.
                                if(tempNotifTimes[tempNotifTimes.length - 2] && moment(tempNotifTimes[tempNotifTimes.length - 2]).isAfter(moment())){
                                    //notifTimes = [];

                                    for(var h = 0; h < tempNotifTimes.length - 1; h++){
                                        if(tempNotifTimes[h] != null && tempNotifTimes[h] != 'null' && tempNotifTimes[h] != ''){
                                            //console.log("\ntempNotifTimes[" + h + "] = " + tempNotifTimes[h]);
                                            notifTimes.push(moment(tempNotifTimes[h]));
                                        }
                                        else{
                                            //console.log("\ntempNotifTimes[" + h + "] = " + tempNotifTimes[h]);
                                            notifTimes.push(null);
                                        }
                                    }
                                }
                            }
                            reader.readAsText(file);
                        }, onFSError);
                    }, onFSError);
                }, onGetDirectoryFail);
            }, onFSError);

            if(typeof(callback) === 'function'){

                setTimeout(function(){
                    callback();

                }, 1000);
            }
        }



        function formNotifString(callback){
            console.log("\nformNotifString()");
            var concatString='';

            //for(var i = 0; i < partitionTimes.length; i++){
            for(var i = 0; i < notifTimes.length; i++){
                if(notifTimes[i]){
                    concatString += notifTimes[i].clone().toDate().toString();
                    concatString += '\n';
                }
                else{
                    concatString += null;
                    concatString += '\n';
                }
            }

            if(typeof(callback) === 'function'){
                callback(concatString, false);
            }
        }


        //Called when a new user submits his userID and password. Makes sure that they adhere to restrictions set by group
        function checkNewLoginInfo(){
            var tempName, tempName2, tempPass, tempPass2;
            var namesMatch, passesMatch;
            var correctPassSyntax = false;

            tempName = $("#login-newuser-username").val();
            tempName2 = $("#login-newuser-username2").val();
            tempPass = $("#login-newuser-password").val();
            tempPass2 = $("#login-newuser-password2").val();

            namesMatch = (tempName == tempName2);
            passesMatch = (tempPass == tempPass2);

            if(tempPass.length == 4)
                correctPassSyntax = true;

            if(!correctPassSyntax){
                alert("Password must be 4-digits long");
                $("#login-newuser-username").val('');
                $("#login-newuser-username2").val('');
                $("#login-newuser-password").val('');
                $("#login-newuser-password2").val('');
            }
            else if(!namesMatch){
                alert("Usernames must match");
                $("#login-newuser-username").val('');
                $("#login-newuser-username2").val('');
                $("#login-newuser-password").val('');
                $("#login-newuser-password2").val('');
            }
            else if(!passesMatch){
                alert("Passwords must match");
                $("#login-newuser-username").val('');
                $("#login-newuser-username2").val('');
                $("#login-newuser-password").val('');
                $("#login-newuser-password2").val('');
            }
            else if((namesMatch && passesMatch) && correctPassSyntax){
                userPass = tempPass;
                userID = tempName;
                alert("New user successfully created");
                writeToLoginFile(tempName + delimiter + tempPass, true);
                $.mobile.navigate("#login");
            }
        }

        //Function resets all set widgets to an empty value, so taking future surveys don't result in widgets having old answers
        function resetSurveyWidgets(){
            //console.log("\nWithin resetSurveyWidgets()");

            visitedEmoSurveyA = false;
            visitedEmoSurveyB = false;
            visitedEmoSurveyC = false;

            visitedBeforeTobEmoSurveyA = false;
            visitedBeforeTobEmoSurveyB = false;
            visitedBeforeTobEmoSurveyC = false;

            visitedWhenUsingTobSurvey = false;

            takingTestSurvey = false;

            gotoCigMenthol = false;

            /*
            Old Slider reset code

            $(".jquerymobileslider").val(null).slider("refresh").val(null).change();
            $(".jquerymobileslidercont .ui-slider-handle").css("left", "50%");
            */

            $('.horizontal input[type="radio"]').prop('checked', false).checkboxradio('refresh');

            $(".check").prop('checked', false).checkboxradio('refresh');
            $(".radio").prop('checked', false).checkboxradio('refresh');

            $("label .ui-btn").removeClass("ui-btn-down-c ui-btn-hover-c").addClass("ui-btn-up-c");

            if($("#problemdetail").val() != ''){
                $("#problemdetail").val('');
            }

            if($("#suspend-select2 option:selected").val() != 0){
                console.log("suspend selected val != 0");
                $("#suspend-select2").val(0).selectmenu('refresh');
            }
        }


        function determineWhichLogin(){

            exists("Log.log", function(result){
                if(result){
                    determineNameAndPass();
                }
                else{
                    userID = '';
                    userPass = '';

                    $.mobile.navigate('#login-newuser');
                    //console.log("\ndetermineWhichLogin: NOT found Log.log");
                }
            });
        }


        //For use in reference section
        function fireExampleNotif(){
            window.plugin.notification.local.add({
                id:         -1,
                message:    "Tap here to take a survey",
                title:      'Random Prompt Notification',
                autoCancel: true,
                sound:      notifAudioLoc,
                badge:      -1
                //duration:   (3 * 60 * 1000)
            });
        }

        //Useful when testing notifications in the app
        function addNotifsNow(callback){
            var times = [
            moment(),
            moment().add('seconds', 2),
            moment().add('seconds', 5),
            moment().add('seconds', 65),
            moment().add('seconds', 125),
            moment().add('seconds', 185),
            moment().add('seconds', 245),
            moment().add('seconds', 305),
            moment().add('seconds', 365),
            moment().add('seconds', 425),
            moment().add('seconds', 485)];

            for(var i = 0; i < times.length; i++){
                partitionTimes.push(times[i]);
                notifTimes.push(times[i]);
                addNotifAtTime(times[i].toDate(), (i+1));
            }

            if(typeof(callback)==='function'){
                callback();
            }

        }

        //Encrypt--or decrypt-- a passed string, returns encrypted string
        function cryptWithCaesar(passedString, doDecrypt, callback){

            var result = doCrypt(doDecrypt, passedString);

            if(typeof(callback) === 'function')
                callback(result);
            else
                return result;

        }


        function organizeTimes(listOfObjs, callback){

            if(typeof(callback) === 'function'){
                callback();
            }
        }

        //Reads in the times from the .mis file and reorganizes them so that they are listed chronologically
        function correctMissedTimes(callback){
            var tempMissedTimes = [];

            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fs){

                var entry = fs.root;
                entry.getDirectory("alt", {create: false, exclusive: false}, function(directory){

                    directory.getFile('Mis.mis', null, function(fe){
                        console.log('\nwithin organizeMissedTimes, got file');

                        fe.file(function(file){
                            //console.log('\nwithin readFromFile file()');
                            var reader = new FileReader();

                            reader.onloadend = function(evt){
                                //console.log("\nRead as text");
                                content = evt.target.result;
                                //console.log(content);
                                tempMissedTimes = content.split(/[\r\n]+/g);

                                for(var i = 0; i< tempMissedTimes.length; i++){
                                    var tempArr = [];
                                    var tempObj;

                                    tempArr = tempMissedTimes[i].split('; ')
                                    tempObj = {
                                        "id"    :   tempArr[0],
                                        "type"  :   tempArr[1],
                                        "date"  :   tempArr[2]
                                    }

                                    tempMissedTimes.push(tempObj);
                                }

                                organizeTimes(tempMissedTimes);
                            }
                        }, onFSError);
                    }, onFSError);
                }, onGetDirectoryFail);
            }, onFSError);

            if(typeof(callback) === 'function'){
                callback();
            }
        }


        //Decrypts all the output files, renames all of the files to userName_fileType.txt, and moves them from '...' to
        //a new directory within '.alt' named userName
        function prepareAllFiles(){
            var fileNames = new Array("Tob.tob", "Rpt.rpt", "Log.log", "Bed.bed", "Mis.mis", "Not.not", "Prob.prob");

            clearPriorNotifs(function(){
                formNotifString(writeToNotifFile);
            });
            if(my_media){
                my_media.stop();
                //my_media.reset();
                my_media.release();
            }

            changeAppStatus(states.ACTIVE);

            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSystem){
                fileSystem.root.getDirectory("alt", {create: true, exclusive: false}, function(directory){

                    console.log("\nCheckpoint 1");

                    exists(fileNames[2], function(value){
                        if(value){
                            console.log("\nCheckpoint 2, " + fileNames[2] + " found.");

                            directory.getFile(fileNames[2], {create: false, exclusive: false}, function(fileEntry){
                                console.log("\nCheckpoint 3 @prepareAllFiles(), got file, FILEENTRY.NAME: " + fileEntry.name);

                                copyFile(fileEntry, function(copiedFileEntry){
                                    //decryptFileWithAES(copiedFileEntry)

                                    cryptFileWithCaesar(copiedFileEntry, true);

                                });
                            }, onFSError);
                        }
                        //else
                            //console.log(fileNames[2] + " not found!");
                    });

                    exists(fileNames[3], function(value){
                        if(value){
                            console.log("\nCheckpoint 2, " + fileNames[3] + " found.");

                            directory.getFile(fileNames[3], {create: false, exclusive: false}, function(fileEntry){
                                console.log("\nCheckpoint 3 @prepareAllFiles(), got file, FILEENTRY.NAME: " + fileEntry.name);
                                copyFile(fileEntry);

                            }, onFSError);
                        }
                        //else
                            //console.log(fileNames[3] + " not found!");
                    });

                    exists(fileNames[4], function(value){
                        if(value){
                            console.log("\nCheckpoint 2, " + fileNames[4] + " found.");

                            directory.getFile(fileNames[4], {create: false, exclusive: false}, function(fileEntry){
                                console.log("\nCheckpoint 3 @prepareAllFiles(), got file, FILEENTRY.NAME: " + fileEntry.name);

                                copyFile(fileEntry);
                            }, onFSError);
                        }
                        //else
                            //console.log(fileNames[4] + " not found!");
                    });

                    exists(fileNames[5], function(value){
                        if(value){
                            console.log("\nCheckpoint 2, " + fileNames[5] + " found.");

                            directory.getFile(fileNames[5], {create: false, exclusive: false}, function(fileEntry){
                                console.log("\nCheckpoint 3 @prepareAllFiles(), got file, FILEENTRY.NAME: " + fileEntry.name);

                                copyFile(fileEntry);
                            }, onFSError);
                        }
                        //else
                        //console.log(fileNames[4] + " not found!");
                    });
                    exists(fileNames[6], function(value){
                        if(value){
                            console.log("\nCheckpoint 2, " + fileNames[6] + " found.");

                            directory.getFile(fileNames[6], {create: false, exclusive: false}, function(fileEntry){
                                console.log("\nCheckpoint 3 @prepareAllFiles(), got file, FILEENTRY.NAME: " + fileEntry.name);

                                copyFile(fileEntry);
                            }, onFSError);
                        }
                        //else
                        //console.log(fileNames[4] + " not found!");
                    });


                    //First, encrypted files
                    exists(fileNames[0], function(value){
                        if(value){
                            console.log("\nCheckpoint 2, " + fileNames[0] + " found.");

                            directory.getFile(fileNames[0], {create: false, exclusive: false}, function(fileEntry){
                                console.log("\nCheckpoint 3 @prepareAllFiles(), got file, FILEENTRY.NAME: " + fileEntry.name);

                                copyFile(fileEntry, function(copiedFileEntry){
                                    //decryptFileWithAES(copiedFileEntry)

                                    cryptFileWithCaesar(copiedFileEntry, true);
                                });
                            }, onFSError);
                        }
                        //else
                        //console.log(fileNames[0] + " not found!");
                    });


                    exists(fileNames[1], function(value){
                        if(value){
                            console.log("\nCheckpoint 2, " + fileNames[1] + " found.");

                            directory.getFile(fileNames[1], {create: false, exclusive: false}, function(fileEntry){
                                console.log("\nCheckpoint 3 @prepareAllFiles(), got file, FILEENTRY.NAME: " + fileEntry.name);

                                copyFile(fileEntry, function(copiedFileEntry){
                                    //decryptFileWithAES(copiedFileEntry)
                                    cryptFileWithCaesar(copiedFileEntry, true);

                                });
                            }, onFSError);
                        }
                        //else
                        //console.log(fileNames[1] + " not found!");
                    });

                },onGetDirectoryFail);
            }, onFSError);
        }


        //Deletes all of the output files, including the newly prepared directory which holds formatted user data
        function deleteAllFiles(){

            clearPriorNotifs();
            if(my_media){
                my_media.stop();
                //my_media.reset();
                my_media.release();
            }

            userID = null;
            userPass = null;

            changeAppStatus(states.ACTIVE);

            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSystem){
                fileSystem.root.getDirectory("alt", {create: true, exclusive: false}, function(directory){

                    directory.removeRecursively(function(){
                        alert("You have deleted all of the user data for " + userID.toString())
                    }, function(){
                        alert("Error, user data not deleted for user " + userId.toString() + " delete the directory manually from Android file manager.");
                    });
                }, onGetDirectoryFail);
            }, onFSError);
        }


        //Suspends notifications by cancelling any that are within the suspend limit set by the user
        function suspendNotifs(callback){
            var suspendTime = parseInt($("#suspend-select1 option:selected").val());
            var suspendReason = $("#suspend-select2 option:selected").text();

            //If not cancelling a suspension:
            if(suspendTime && (suspendReason != "...    " && suspendReason != "...")){
                var now = moment();
                var suspendLimit = moment().add('minutes', suspendTime);
                console.log('\nadding mins:  ' + suspendTime);
                console.log('\ntime now:     ' + now.format("dddd, MMMM Do YYYY, HH:mm:ss a"));
                console.log('\nsuspendLimit: ' + suspendLimit.format("dddd, MMMM Do YYYY, HH:mm:ss a"))

                //difference between number of notifs actually added and number of notif times partitioned:
                //var diff = Math.abs(notifCount - partitionTimes.length);
                //var translatedIndex;

                //for(var i = 0; i < partitionTimes.length; i++){
                for(var i = 0; i < notifTimes.length; i++){
                    //notif IDs are stored by the actual count of the notif, not from the notif index of their related time
                    //if (partitionTimes[i].isAfter(now) && partitionTimes[i].isBefore(suspendLimit)){

                    if(notifTimes[i]){
                        if(notifTimes[i].isAfter(now) && notifTimes[i].isBefore(suspendLimit)){
                            //translatedIndex = (i - diff) + 1;
                            //console.log('\nSUSPENSION: notif ' + (i + 1) + " cancelled!");
                            window.plugin.notification.local.cancel(i + 1);
                            notifTimes[i] = null;
                        }
                    }
                }
                resumeTime = suspendLimit.toDate();

                currentState = states.SUSPENDED;
                changeAppStatus(states.SUSPENDED);

                $.mobile.navigate("#login");
            }

            else{

                alert("You must enter a time and reason before suspending the app.");
            }

            if(typeof(callback) === 'function'){
                callback();
            }
        }

        //Updates the portion below the login screen to let user know if the application is suspended, delayed, or sleeping
        function changeAppStatus(type){
            if(type == states.SUSPENDED){
                currentState = states.SUSPENDED;
                switchLoginTheme('g');

                $("#login-header h1").text("Notifications Suspended");
                $("#login-footer-header").text("Log in to break suspension");

                setLoginStatusLabel("Random Prompt Notifications will resume: " + moment(resumeTime).format("MMM D, h:mm a"));

                //console.log('\nwithin changeAppStatus(\'suspend\'');
            }
            else if(type == states.ASLEEP){
                currentState = states.ASLEEP;
                switchLoginTheme('f');

                $("#login-header h1").text("App is Asleep");
                $("#login-footer-header").text("Log in to break bedtime");

                setLoginStatusLabel("Random Prompt Notifications will resume: " + moment(resumeTime).format("MMM D, h:mm a"));

                //console.log('\nwithin changeAppStatus(\'bedtime\'');
            }
            else if(type == states.DELAYED){
                currentState = states.DELAYED;
                switchLoginTheme('h');

                $("#login-header h1").text("Delaying Notif");
                $("#login-footer-header").text("Log in to take a survey now");

                //console.log('\nwithin changeAppStatus(\'delay\'');
            }

            //Cancel appStatus display
            else if(type == states.ACTIVE){
                currentState = states.ACTIVE;
                switchLoginTheme('a');

                $("#login-header h1").text("Login");
                $("#login-footer-header").text("");

                $("#suspend-select1").val(30).selectmenu('refresh');
                $("#delaydiv #select-choice-1").val(5).selectmenu('refresh');

                //console.log('\nwithin changeAppStatus(\'active\'');
                setLoginStatusLabel("Receiving Random Prompt Notifications");

                resumeTime = null;
                wakeUpFiring = false;
            }

            recordState();
        }

        //Aux function that changes appearance of login widgets
        function switchLoginTheme(passedTheme){

            //btns
            $('#login').each(function(){
                $(this).find('.ui-btn').removeClass('ui-btn-up-a ui-btn-hover-a ' +
                        'ui-btn-up-f ui-btn-hover-f ui-btn-up-g ui-btn-hover-g ' +
                        'ui-btn-up-h ui-btn-hover-h').addClass('ui-btn-up-' + passedTheme).attr('data-theme', passedTheme);
            });

            //header and footer
            $('#login').each(function(){
                $(this).find('.ui-header, .ui-footer').removeClass('ui-bar-a ' +
                        'ui-bar-f ' + 'ui-bar-g ' + 'ui-bar-h').addClass('ui-bar-' + passedTheme).attr('data-theme', passedTheme);
            });

            //page contents
            $('#login').each(function(){
                $(this).removeClass('ui-body-a ' +
                        'ui-body-f ' + 'ui-body-g ' + 'ui-body-h').addClass('ui-body-' + passedTheme).attr('data-theme', passedTheme);
            });

        }

        function setLoginStatusLabel(passedString){
            $("#login-statuslabel h3").text(passedString);
            //console.log('\nShould change label to ' + passedString);
        }

        //Called upon setting the waketime... will clear all notifs for that day, to be resumed at waketime set
        function setWakeTime(callback){
            var wScrollVal;
            var delimiter = '\n';
            var hour, minute, ampm;
            var tempWakeTime, tempBedTime; //temp date objects used for comparison between set waketime and set bedtime, before actual assignment

            wScrollVal = $("#wscroller").mobiscroll('getValue');

            hour = wScrollVal[0];
            minute = wScrollVal[1];
            ampm = wScrollVal[2];

            //In case of am or pm...
            if (ampm == '1'){
                temphour = parseInt(hour);
                temphour += 12;
                hour = temphour.toString();
            }

            tempWakeTime = moment().hour(hour).minute(minute);
            tempBedTime = moment();

            //If same day waketime is greater than same day bedtime, will cancel all notifs and create partitions from sameday waketime to next day bedtime
            //So for now, set bedtime to next day
            if(tempWakeTime.isAfter(tempBedTime)){
                //timeAsleep = moment(tempBedTime).from(tempWakeTime, true);
                timeAsleep = Math.abs(moment(tempBedTime).diff(tempWakeTime, 'minutes'));
                timeAwake = Math.abs(timeAsleep - (24 * 60));
                console.log(timeAsleep);
                tempBedTime.add('days', 1);
            }

            //If same day waketime is less than same day bedtime, will cancel all notifs, and set new partitions for next day waketime to next day bedtime
            //So for now, set bedtime to next day, as well as waketime to next day
            else if(tempBedTime.isAfter(tempWakeTime)){
                tempWakeTime.add('days', 1);

                //timeAsleep = moment(tempBedTime).from(tempWakeTime, true);
                timeAsleep = Math.abs(moment(tempBedTime).diff(tempWakeTime, 'minutes'));
                timeAwake = Math.abs(timeAsleep - (24 * 60));
                console.log(timeAsleep);
                tempBedTime.add('days', 1);
            }

            //console.log("\n*******Time asleep: " + timeAsleep.asHours());
            //console.log("\n*******Upcoming notif period:" + tempBedTime.from(tempWakeTime, true));

            //timeAsleep is number of minutes of bedtime duration
            //Must not allow user to sleep for less than minSleepTime nor sleep longer than maxSleepTime
            if((Math.abs(timeAsleep) > 60 * minSleepTime) && (Math.abs(timeAsleep) < 60 * maxSleepTime)){
                //$("#waketimesubmit").attr("href","#popupWakeTime");


                wakeTimeDate = tempWakeTime;
                bedTimeDate = tempBedTime;

                var timesStr;
                timesStr = wakeTimeDate.toString() + delimiter + bedTimeDate.toString();

                //Test code to try out old dates within Bed.bed
                //timesStr = wakeTimeDate.subtract('days',2).toString() + delimiter + bedTimeDate.subtract('days',2).toString();

                console.log('\nupcoming hours awake:      ' + timeAwake);
                console.log('\nhours asleep:              ' + (timeAsleep / 60));
                console.log('\nnext notif period:  ' + tempBedTime.from(tempWakeTime, true));
                console.log('\nnew wake time:             ' + wakeTimeDate.toString() + '\nnew bed time: ' + bedTimeDate.toString());

                resumeTime = moment().add('minutes', timeAsleep).toDate();

                currentState = states.ASLEEP;
                changeAppStatus(states.ASLEEP);

                $.mobile.navigate('#login');

                if(typeof(callback) ==='function'){

                    callback();
                }
            }

            else if(Math.abs(timeAsleep) < 60 * minSleepTime){
                alert("Your bedtime must not be shorter than " + minSleepTime + " hours");
                $("#popupWakeTime").popup("close");
                //$("#wscroller").val('');
            }

            else if (Math.abs(timeAsleep) > 60 * maxSleepTime){
                alert("Your bedtime must not be longer than " + maxSleepTime + " hours");
                $("#popupWakeTime").popup("close");
                //$("#wscroller").val('');
            }
        }


        //Add a notification specific to notifications meant to wake up the user
        function addAlarmNotification(callback){

            console.log("TYPE OF date object sent to alarm notification: " + typeof(moment(resumeTime).toDate()));
            console.log("DATE of date object sent to alarm notification: " + moment(resumeTime).toDate().toString());

            //Set notif at time which alarm will wake user up:
            window.plugin.notification.local.add({
                id:         -99,
                date:       moment(resumeTime).toDate(),
                message:    "Tap to wake up",
                title:      'Application is now awake',
                autoCancel: true,
                sound:      alarmAudioLoc,
                json:       JSON.stringify({ date: moment(resumeTime).toString()})
                //duration:   (3 * 60 * 1000)
            });

            if(typeof(callback)==='function'){

                callback();
            }
        }


	</script>
<style>
    /* Sizing code so that horizontal radio boxes fit on phone width */

    .horizontal .ui-radio {
        width: 10%;
    }

    /* adjusts inner text on radio buttons for horizontal radios so that nums are in middle... only really set for the Motorola Razr m */
    .horizontal .ui-btn-inner{
        right: .5em;
        font-size: 20px;
        text-overflow: ellipsis;
        overflow: visible;
        white-space: normal;
    }

    .horizontal-10 .ui-btn-inner{
        right: .8em !important;
    }

    .post-header{
        margin-bottom: 8%;
    }

    .post-horizontal{
        margin-bottom: 8%;
    }

    .tick {
        width: 2px;
        background-color:#3388cc;
        height:100%;
        position:absolute;
        bottom:0px;
    }

    #number1{
        margin-left:0%;
    }

    #ticka, #numbera{
        margin-left:11.1%;
    }

    #tickb, #numberb{
        margin-left:22.2%;
    }

    #tickc, #numberc{
        margin-left:33.3%;
    }
    #tickd, #numberd{
        margin-left:44.4%;
    }

    #ticke, #numbere{
        margin-left:55.5%;
    }

    #tickf, #numberf{
        margin-left:66.6%;
    }
    #tickg, #numberg{
        margin-left:77.7%;
    }

    #tickh, #numberh{
        margin-left:88.8%;
    }

    #number10{
        margin-left:100%;
    }

    .number {
        position:absolute;
        top:110%;
        left:-5px;
        bottom:0px;
        font-size:10px;
        color:#999999;
    }

    /*
    .sliderTickmarks{
        -webkit-box-sizing: border-box;
        box-sizing: border-box;
        height: 100%;
        width: 25%;
        float: left;
        border-right: 1px solid #888;
    }
    .sliderTickmarks span{
        position: relative;
        left: 100%;
        top: 125%;
        margin-left: -10px;
        font-size: 12px;
        font-weight: normal;
    }

    .ui-slider-track > div.sliderTickmarks:first-child{
        border-right: 0;
        width: 0;
    }
    .ui-slider-track > div.sliderTickmarks:first-child span{
        margin-left: -5px;
    }
    .ui-slider-track > div.sliderTickmarks:last-of-type{
        border-right: 0;
    }

    */

    .ui-title {
        margin: 0.6em 10% 0.8em !important;
    }

    #ajaxSpinner{
        width: 100%;
        height: 100%;
        background-color:#f3f3f3;
    }

    h2{
    margin-top: 0px;
    margin-bottom: 0px;
    }

    h3{
    margin-top: 5px;
    margin-bottom: 0px;

    }

    #button-mainsurvey .ui-btn-inner {
        font-size: 20px;
    }

    #button-snooze .ui-btn-inner {
        font-size: 40px;
    }
    #button-wakeup .ui-btn-inner {
        font-size: 40px;
    }

    #button-whichprompt-yes .ui-btn-inner {
        font-size: 25px;

    }

    #button-whichprompt-no .ui-btn-inner {
        font-size: 25px;

    }



    .jquerymobileslidercont {
        padding: 20px 0px;
        border-bottom: 1px solid #ddd;
    }

    .jquerymobileslidercont label {
        font-weight: bold;
        font-size: 20px;
    }

    /*
    .jquerymobileslidercont .leftSpan{
        margin-left: 68px;
    }

    .jquerymobileslidercont .rightSpan{
        position: absolute;
        right: 0px;
        margin-right: 5%;
    } */

    .leftSpan{
        margin-left: 0%;
    }

    .rightSpan{
        position: absolute;
        right: 0px;
        margin-right: 5%;
    }
    .jquerymobileslidercont .ui-slider-track {
        height: 32px;
        border-radius: 12px;
        margin-top: -8px;
    }

    .ui-slider-bg {
        border-radius: 12px;
    }

    .jquerymobileslidercont .ui-slider-handle {
        height: 40px !important;
        width: 30px !important;
        margin-top: -20px !important;
        margin-left: -15px !important;
        line-height: 40px;
    }
    .jquerymobileslidercont .ui-slider-handle .ui-btn-text {
        font-weight: bold;
        font-size: 18px;
    }

    .ui-slider-track, .ui-slider-switch {
        height: 30px;
        border-radius: 12px;
    }

    .ui-header .ui-title{
        font-size: 20px;
    }

    .jquerymobileslidercont .ui-slider-handle .ui-btn-text{

        bottom: 17%;
    }

    .ui-slider .ui-btn-inner {
        padding: 5px 0 15px 0 !important;
        font-size: 1.5em;
    }

    .ui-slider-popup {
        position: absolute !important;
        width: 64px;
        height: 64px;
        text-align: center;
        font-size: 36px;
        padding-top: 14px;
        z-index: 100;
        opacity: 0.8;
    }

    input .password-field{
        -webkit-text-security: disc;

    }

    /*
    #login-appstatus{
        height:50px;
        width:100%;
        background-color:#f3f3f3;
    }
    */


    /*
    label.ui-slider{
        font-size: 20px;
    }

    .ui-slider-track .ui-btn.ui-slider-handle {
        top: 30%;
    }

    .ui-slider-track {
        height: 30px;
        top: 0%;
    }

    .ui-slider-handle{
        height: 40px !important;
        width: 40px !important;
    }
    */



</style>
</head>

    <body onload="onLoad()">
        <!-- login page -->

        <div id="login" data-role="page">

            <!--div style="position:fixed" id="ajaxSpinner"><img src="img/ajax-loader.gif" style="vertical-align: middle; right: 50%;"> </div-->

            <div data-role="header" id="login-header">
                <h1>Login</h1>
            </div>

            <div data-role="content">
                <!--div id="logincontent"></div-->
                <form id="form-login">
                    <div data-role="fieldcontain" class="ui-hide-label">
                        <label for="login-password">Password:</label>
                        <input type="tel" name="login-password" id="login-password" value="" placeholder="Password" class="password-field"/>
                    </div>
                    <a href="#" id="login-button" data-role="button" onclick="checkLoginV2()">Login</a>
                    <!--a href="#" id="login-button" data-role="button" data-rel="popup" onclick="checkLoginPopUp()">Login</a-->
                </form>
                <div id="login-statuslabel">
                    <h3 align="center">Receiving Random Prompt Notifications</h3>
                </div>


            </div>



            <div data-role="footer" id="login-footer" data-theme="a">
                <h4 id="login-footer-header"></h4>
            </div>

            <!--div data-role="popup" id="popupLogin" data-overlay-theme="a" data-theme="a" data-dismissible="false" style="max-width:400px;" class="ui-corner-all">
                <div data-role="header" data-theme="a" class="ui-corner-top">
                    <h2>Login</h2>
                </div>
                <div data-role="content" align="center" data-theme="a" class="ui-corner-bottom ui-content">
                    <h4 align="center">By setting your wake time, you are putting the application to sleep.</h4>
                    <h3 align="center">Are you sure you want to break?</h3>
                    <a href="#" data-role="button" data-inline="true" data-rel="back" data-theme="a">Cancel</a>
                    <a href="#" data-role="button" data-inline="true" data-transition="flow" onclick="checkLogin()" data-theme="a">Log in</a>
                </div>
            </div-->


        </div>


    <!-- NEW USER LOGIN PAGE -->

    <div id="login-newuser" data-role="page">

        <div data-role="header">
            <h1>New user registration</h1>
        </div>

        <div data-role="content">
            <form id="form-login-newuser">
                <div data-role="fieldcontain">
                    <label for="login-newuser-username">Enter username:</label>
                    <input type="text" name="login-newuser-username" id="login-newuser-username" value="" placeholder="Please enter desired username" />
                    <input type="text" name="login-newuser-username2" id="login-newuser-username2" value="" placeholder="Re-enter username" align="right" />
                </div>
                <div data-role="fieldcontain">
                    <label for="login-newuser-password">Enter password:</label>
                    <input type="tel" name="login-newuser-password" id="login-newuser-password" value="" placeholder="Please enter desired 4-digit password" />
                    <input type="tel" name="login-newuser-password2" id="login-newuser-password2" value="" placeholder="Re-enter password" align="right" />
                </div>
                <a href="#" id="login-newuser-button" data-role="button" onclick="checkNewLoginInfo()">Register new user</a>
            </form>
        </div>

        <div data-role="footer">
            <h4></h4>
        </div>

    </div>


    <!-- WHICH PROMPT MENU... NOT USED ANYMORE-->

    <div data-role="page" id="whichprompt">

        <header data-role="header" data-theme="c">
            <h1 align="center">How did you get here?</h1>
        </header>

        <div data-role="content">
            <div align="center">
                <h1 align="center">Are you here from a random prompt?</h1>
                <a href="#" data-role="button" id="button-whichprompt-no" data-inline="true" onclick="startLoginToMain(true)">No</a>
                <a href="#" data-role="button" id="button-whichprompt-yes" data-inline="true" onclick="startRandomPromptInterview()">Yes</a>
            </div>
        </div>

        <div data-role="footer" data-position="fixed" data-tap-toggle="false">
            <div data-role="navbar">
                <ul>
                    <li><a href="#anylink" class="ui-disabled">Back</a></li>
                    <li><a href="#anylink" class="ui-disabled">Next</a></li>
                </ul>
            </div>
            <h4> </h4>
        </div>

    </div>

    <!-- DELAY PAGE -->
    <div data-role="page" id="delay">
        <header data-role="header" data-theme="h">
            <h1 align="center">Delay Notif</h1>
        </header>

        <div data-role="content">
            <div id="delaycontent"></div>
        </div>

        <div data-role="footer" data-position="fixed" data-tap-toggle="false">
            <div data-role="navbar">
                <ul>
                    <li><a href="#" class="ui-disabled">Back</a></li>
                    <li><a href="#" class="ui-disabled">Next</a></li>
                </ul>
            </div>
            <h4> </h4>
        </div>


    </div>

    <!--  MAIN PAGE   -->

    <div data-role="page" id="main">

        <header data-role="header" data-theme="c">
            <h1 class="main-header" align="center">Main Menu</h1>
        </header>

        <div data-role="content">
            <ul id="notelist" data-role="listview"></ul>
            <a href="#tobProductSurvey" data-role="button" data-icon="bars" id="button-mainsurvey" onclick="cancelFutureNotif()">Tobacco Use Interview</a>
            <a href="#suspend" data-role="button" data-icon="forward">Suspend</a>
            <a href="#wakeTime" data-role="button" data-icon="edit">Set Wake Time</a>
            <a href="#problemreport" data-role="button" data-icon="alert">Problem Report</a>
            <a href="#reference" data-role="button" data-icon="arrow-r">Reference</a>
        </div>

        <div data-role="footer" data-position="fixed" data-tap-toggle="false">
             <div data-role="navbar">
                 <ul>
                     <li><a href="#anylink" class="ui-disabled">Back</a></li>
                     <li><a href="#anylink" class="ui-disabled">Next</a></li>
                 </ul>
             </div>
            <h4> </h4>
        </div>

    </div>

    <!-- ADMINISTRATOR MENU -->

    <div data-role="page" id="administrator">

        <header data-role="header" data-theme="c">
            <h1 class="admin-header" align="center">Administrator Menu</h1>
        </header>

        <div data-role="content">
            <ul id="administratorlist" data-role="listview"></ul>
            <a href="#" data-role="button" data-icon="grid" onclick="prepareAllFiles()">Prepare all files</a>
            <a href="#delete1" data-role="button" data-icon="delete">Delete all files</a>
        </div>

        <div data-role="footer" data-position="fixed" data-tap-toggle="false">
            <div data-role="navbar">
                <ul>
                    <li><a href="#anylink" class="ui-disabled">Back</a></li>
                    <li><a href="#anylink" class="ui-disabled">Next</a></li>
                </ul>
            </div>
            <h4> </h4>
        </div>

    </div>

    <!-- LINKED SURVEY 1a -->

    <div data-role="page" id="emoSurveyA">

        <div data-role="content">
            <div id="emoSurveyAcontent"></div>
        </div>


        <div data-role="footer" data-position="fixed" data-tap-toggle="false">
            <div data-role="navbar">
                <ul>
                    <li><a href="#" id="emoSurveyABack">Back</a></li>
                    <li><a href="#" onclick="finishEmoSurveyA()" id="emoSurveyAGo">Next</a></li>
                </ul>
            </div>
            <h4> </h4>
        </div>
    </div>

    <!-- LINKED SURVEY 1b -->

    <div data-role="page" id="emoSurveyB">

        <div data-role="content">
            <div id="emoSurveyBcontent"></div>
        </div>




        <div data-role="footer" data-position="fixed" data-tap-toggle="false">
            <div data-role="navbar">
                <ul>
                    <li><a href="#emoSurveyA">Back</a></li>
                    <li><a href="#" onclick="finishEmoSurveyB()" id="emoSurveyBGo">Next</a></li>
                </ul>
            </div>
            <h4> </h4>
        </div>
    </div>

    <!-- LINKED SURVEY 1c -->

    <div data-role="page" id="emoSurveyC">

        <div data-role="content">
            <div id="emoSurveyCcontent"></div>
        </div>




        <div data-role="footer" data-position="fixed" data-tap-toggle="false">
            <div data-role="navbar">
                <ul>
                    <li><a href="#emoSurveyB">Back</a></li>
                    <li><a href="#" onclick="finishEmoSurveyC()" id="emoSurveyCGo">Next</a></li>
                </ul>
            </div>
            <h4> </h4>
        </div>
    </div>



    <!--BEFORE TOBACCO USE SLIDER PAGES -->

    <!-- LINKED SURVEY ba -->

    <div data-role="page" id="beforeTobEmoSurveyA">

        <div data-role="content">
            <div id="beforeTobEmoSurveyAcontent"></div>
        </div>


        <div data-role="footer" data-position="fixed" data-tap-toggle="false">
            <div data-role="navbar">
                <ul>
                    <li><a href="#secondRadioSetSurvey">Back</a></li>
                    <li><a href="#" onclick="finishBeforeTobEmoSurveyA()" id="beforeTobEmoSurveyAGo">Next</a></li>
                </ul>
            </div>
            <h4> </h4>
        </div>
    </div>

    <!-- LINKED SURVEY bb -->

    <div data-role="page" id="beforeTobEmoSurveyB">

        <div data-role="content">
            <div id="beforeTobEmoSurveyBcontent"></div>
        </div>




        <div data-role="footer" data-position="fixed" data-tap-toggle="false">
            <div data-role="navbar">
                <ul>
                    <li><a href="#beforeTobEmoSurveyA">Back</a></li>
                    <li><a href="#" onclick="finishBeforeTobEmoSurveyB()" id="beforeTobEmoSurveyBGo">Next</a></li>
                </ul>
            </div>
            <h4> </h4>
        </div>
    </div>

    <!-- LINKED SURVEY bc -->

    <div data-role="page" id="beforeTobEmoSurveyC">

        <div data-role="content">
            <div id="beforeTobEmoSurveyCcontent"></div>
        </div>




        <div data-role="footer" data-position="fixed" data-tap-toggle="false">
            <div data-role="navbar">
                <ul>
                    <li><a href="#beforeTobEmoSurveyB">Back</a></li>
                    <li><a href="#" onclick="finishBeforeTobEmoSurveyC()" id="beforeTobEmoSurveyCGo">Submit survey</a></li>
                </ul>
            </div>
            <h4> </h4>
        </div>
    </div>

    <!-- LINKED WHENUSINGTOBSURVEY -->

    <div data-role="page" id="whenUsingTobSurvey">

        <div data-role="content">
            <div id="whenUsingTobSurveycontent"></div>
        </div>




        <div data-role="footer" data-position="fixed" data-tap-toggle="false">
            <div data-role="navbar">
                <ul>
                    <li><a href="#emoSurveyC">Back</a></li>
                    <li><a href="#" onclick="finishWhenUsingTobSurvey()" id="whenUsingTobSurveyGo">Next</a></li>
                </ul>
            </div>
            <h4> </h4>
        </div>
    </div>


    <!-- LINKED SURVEY 2 -->
    <div data-role="page" id="productUrgeSurvey">

        <div data-role="content">
            <div id="productUrgeSurveyContent">
            </div>
        </div>




        <div data-role="footer" data-position="fixed" data-tap-toggle="false">
            <div data-role="navbar">
                <ul>
                    <li><a href="#emoSurveyC">Back</a></li>
                    <li><a href="#" id="productUrgeSurveyGo" onclick="finishProductUrgeSurvey()">Next</a></li>
                </ul>
            </div>
            <h4> </h4>
        </div>
    </div>


    <!-- LINKED SURVEY3 -->

    <div data-role="page" id="currentActivitySurvey">

        <div data-role="content">
            <div id="currentActivitySurveyContent">
            </div>
        </div>


        <div data-role="footer" data-position="fixed" data-tap-toggle="false">
            <div data-role="navbar">
                <ul>
                    <li><a href="#" id="currentActivitySurveyBack">Back</a></li>
                    <li><a href="#" onclick="finishCurrentActivitySurvey()" id="currentActivitySurveyGo">Next</a></li>
                </ul>
            </div>
            <h4> </h4>
        </div>
    </div>


    <!-- LINKED SURVEY4 **DEPENDENT**-->

    <div data-role="page" id="wOthersSurvey">


        <div data-role="content">
            <div id="wOthersSurveyContent">
            </div>
        </div>


        <div data-role="footer" data-position="fixed" data-tap-toggle="false">
            <div data-role="navbar">
                <ul>
                    <li><a href="#currentActivitySurvey">Back</a></li>
                    <li><a href="#" id="wOthersSurveyGo" onclick="setSurveyFromWOthersSurvey()">Next</a></li>
                </ul>
            </div>
            <h4> </h4>
        </div>
    </div>

    <!-- LINKED SURVEY5a **DEPENDENT**-->

    <div data-role="page" id="whoNearbySurvey">


        <div data-role="content">
            <div id="whoNearbySurveyContent">
            </div>
        </div>


        <div data-role="footer" data-position="fixed" data-tap-toggle="false">
            <div data-role="navbar">
                <ul>
                    <li><a href="#wOthersSurvey">Back</a></li>
                    <li><a href="#" id="whoNearbySurveyGo" onclick="setSurveyFromWhoNearbySurvey()">Next</a></li>
                </ul>
            </div>
            <h4> </h4>
        </div>
    </div>

    <!-- LINKED SURVEY5a1 -->

    <div data-role="page" id="whoFamilySurvey">


        <div data-role="content">
            <div id="whoFamilySurveyContent">
            </div>
        </div>


        <div data-role="footer" data-position="fixed" data-tap-toggle="false">
            <div data-role="navbar">
                <ul>
                    <li><a href="#whoNearbySurvey">Back</a></li>
                    <li><a href="#nearbyProductUseSurvey" onclick="finishWhoFamilySurvey()" id="whoFamilySurveyGo">Next</a></li>
                </ul>
            </div>
            <h4> </h4>
        </div>
    </div>

    <!-- LINKED SURVEY5b -->

    <div data-role="page" id="nearbyProductUseSurvey">


        <div data-role="content">
            <div id="nearbyProductUseSurveyContent">
            </div>
        </div>


        <div data-role="footer" data-position="fixed" data-tap-toggle="false">
            <div data-role="navbar">
                <ul>
                    <!-- Need to determine how to go back correctly -->
                    <li><a href="#" id="nearbyProductUseSurveyBack">Back</a></li>
                    <li><a href="#" onclick="finishNearbyProductUseSurvey()" id="nearbyProductUseSurveyGo">Next</a></li>
                </ul>
            </div>
            <h4> </h4>
        </div>
    </div>

    <!-- LINKED SURVEY6 -->

    <div data-role="page" id="locationSurvey">


        <div data-role="content">
            <div id="locationSurveyContent">
            </div>
        </div>


        <div data-role="footer" data-position="fixed" data-tap-toggle="false">
            <div data-role="navbar">
                <ul>
                    <li><a href="#" id="locationSurveyBack">Back</a></li>
                    <li><a href="#" onclick="finishLocationSurvey()" id="locationSurveyGo">Next</a></li>
                </ul>
            </div>
            <h4> </h4>
        </div>
    </div>

    <!-- LINKED SURVEY 789 -->


    <div data-role="page" id="firstRadioSetSurvey">

        <div data-role="content">
            <div id="firstRadioSetSurveyContent">
            </div>
        </div>


        <div data-role="footer" data-position="fixed" data-tap-toggle="false">
            <div data-role="navbar">
                <ul>
                    <!-- Need to determine how to go back correctly -->
                    <li><a href="#locationSurvey" id="firstRadioSetSurveyBack">Back</a></li>
                    <li><a href="#" onclick="finishFirstRadioSetSurvey()" id="firstRadioSetSurveyGo">Next</a></li>
                </ul>
            </div>
            <h4> </h4>
        </div>
    </div>

    <!-- LINKED SURVEY 1011 -->


    <div data-role="page" id="secondRadioSetSurvey">


        <div data-role="content">
            <div id="secondRadioSetSurveyContent">
            </div>
        </div>


        <div data-role="footer" data-position="fixed" data-tap-toggle="false">
            <div data-role="navbar">
                <ul>
                    <li><a href="#firstRadioSetSurvey" id="secondRadioSetSurveyBack">Back</a></li>
                    <li><a href="#" onclick="finishSecondRadioSetSurvey()" id="secondRadioSetSurveyGo">Next</a></li>
                </ul>
            </div>
            <h4> </h4>
        </div>
    </div>


    <!-- TOBPRODUCTSURVEY -->

    <div data-role="page" id="tobProductSurvey">


        <div data-role="content">
            <div id="tobProductSurveyContent">
            </div>
        </div>

        <div data-role="footer" data-position="fixed" data-tap-toggle="false">
            <div data-role="navbar">
                <ul>
                    <li><a href="#" class="ui-disabled">Back</a></li>
                    <li><a href="#" onclick="finishTobProductSurvey()" id="tobProductSurveyGo">Next</a></li>
                </ul>
            </div>
            <h4> </h4>
        </div>

    </div>


    <!-- CIGMENTHOLSURVEY -->

    <div data-role="page" id="cigMentholSurvey">

        <div data-role="content">
            <div id="cigMentholSurveyContent">
            </div>
        </div>

        <div data-role="footer" data-position="fixed" data-tap-toggle="false">
            <div data-role="navbar">
                <ul>
                    <li><a href="#tobProductSurvey">Back</a></li>
                    <li><a href="#" onclick="finishCigMentholSurvey()" id="cigMentholSurveyGo">Next</a></li>
                </ul>
            </div>
            <h4> </h4>
        </div>

    </div>



    <!-- LINKED SUSPEND PAGE -->

    <div data-role="page" id="suspend">

        <div data-role="header" data-theme="g">
            <h1>Suspend Prompt Notifications</h1>
        </div>

        <div data-role="content">
            <div id="suspendcontent" data-role="controlgroup" data-type="horizontal">

            </div>
        </div>

        <div data-role="footer" data-position="fixed" data-tap-toggle="false">
            <div data-role="navbar">
                <ul>
                    <li><a href="#main">Back</a></li>
                    <!--li><a href="#" id="suspend-button-submit">Submit suspension</a></li-->
                    <li><a href="#" onclick="suspendNotifs(function(){formNotifString(writeToNotifFile)})" id="suspend-button-submit">Submit suspension</a></li>
                </ul>
            </div>
            <h4> </h4>
        </div>
    </div>

    <!-- Dialog for waketime check -->
    <!--div data-role="page" id="dialogPageWakeTime" data-theme="f">
        <div data-role="header" data-theme="f">

        </div>
        <div role="main" class="ui-content" data-theme="f">



            <div align="center">
                <a href="#wakeTime" data-role="button" data-rel="back" data-inline="true" data-theme="f">Cancel</a>
                <a href="#" data-role="button" onclick="setWakeTime()" data-inline="true" data-theme="f">Put to sleep</a>
            </div>
        </div>
    </div-->

    <!--a href="#popupWakeTime" data-rel="popup" data-position-to="window" data-role="button" data-inline="true" data-transition="pop" data-icon="delete" data-theme="b">Delete page...</a-->


    <!-- LINKED WAKETIME PAGE -->

    <div data-role="page" id="wakeTime">

        <div data-role="header" data-theme="f">
            <h1>Wake Time</h1>
        </div>

        <div data-role="content">
            <div id="wakeTimecontent">
                <!--  bedTime content here... collapsible sets -->
            </div>
        </div>



        <div data-role="footer" data-position="fixed" data-tap-toggle="false">
            <div data-role="navbar">
                <ul>
                    <li><a href="#main">Back</a></li>
                    <li><a href="#popupWakeTime" id="waketimesubmit" data-transition="pop" data-position-to="window" data-rel="popup">Submit wake time</a></li>
                </ul>
            </div>
            <h4> </h4>
        </div>

        <div data-role="popup" id="popupWakeTime" data-overlay-theme="f" data-theme="f" data-dismissible="false" style="max-width:400px;" class="ui-corner-all">
            <div data-role="header" data-theme="f" class="ui-corner-top">
                <h2>Put application to sleep?</h2>
            </div>
            <div data-role="content" align="center" data-theme="f" class="ui-corner-bottom ui-content">
                <h4 align="center">By setting your wake time, you are putting the application to sleep.</h4>
                <h3 align="center">Are you sure you want to continue?</h3>
                <a href="#" data-role="button" data-inline="true" data-rel="back" data-theme="a">Cancel</a>
                <a href="#" data-role="button" data-inline="true" data-transition="flow" onclick="setWakeTime(function(){clearPriorNotifs(function(){addAlarmNotification(); addNewNotifs(true, function(){formNotifString(writeToNotifFile);});});})" data-theme="f">Put to sleep</a>
            </div>
        </div>

    </div>



    <!-- LINKED PROBLEM REPORT -->

    <div data-role="page" id="problemreport">

        <div data-role="header" data-theme="e">
            <h1>Problem Report</h1>
        </div>

        <div data-role="content">
            <div id="problemreportcontent"></div>
        </div>



        <div data-role="footer" data-position="fixed" data-tap-toggle="false">
            <div data-role="navbar">
                <ul>
                    <li><a href="#main">Back</a></li>
                    <li><a href="#main" onclick="recordProblemReport()">Submit report</a></li>
                </ul>
            </div>
            <h4> </h4>
        </div>
    </div>


    <!-- LINKED DEMO PAGE -->

    <div data-role="page" id="reference">

        <div data-role="header" data-theme="e">
            <h1>Reference Page</h1>
        </div>

        <div data-role="content">
            <div id="referencecontent"></div>
        </div>




        <div data-role="footer" data-position="fixed" data-tap-toggle="false">
            <div data-role="navbar">
                <ul>
                    <li><a href="#main">Back</a></li>
                    <li><a href="#anylink" class="ui-disabled">Go</a></li>
                </ul>
            </div>
            <h4> </h4>
        </div>
    </div>

    <!-- Delete screens -->

    <div data-role="page" id="delete1">

        <div data-role="header" data-theme="a">
            <h1>Delete all data files?</h1>
        </div>

        <div data-role="content">
            <h2 style="padding-top:50px">Do you want to delete all of the data files found at:</h2>
            <h3 align="center">/storage/sdcard/alt/  ?</h3>
        </div>

        <div data-role="footer" data-position="fixed" data-tap-toggle="false">
            <div data-role="navbar">
                <ul>
                    <li><a href="#administrator">Cancel deletion</a></li>
                    <li><a href="#delete2" data-theme="g">Yes, delete the data</a></li>
                </ul>
            </div>
            <h4> </h4>
        </div>


    </div>

    <div data-role="page" id="delete2">

        <div data-role="header" data-theme="a">
            <h1>Delete all user data?</h1>
        </div>

        <div data-role="content">
            <h2 style="padding-top:50px">Do you want to delete all of the data files found at:</h2>
            <h3 align="center">/storage/sdcard/alt/  ?</h3>
            <h2 style="padding-top:50px">This will delete all data including any zips, encrypted data, and decrypted data</h2>
        </div>

        <div data-role="footer" data-position="fixed" data-tap-toggle="false">
            <div data-role="navbar">
                <ul>
                    <li><a href="#administrator">Cancel deletion</a></li>
                    <li><a href="#delete3" data-theme="g">Yes, delete the data</a></li>
                </ul>
            </div>
            <h4> </h4>
        </div>

    </div>

    <div data-role="page" id="delete3" data-theme="g">

        <div data-role="header" data-theme="g">
            <h1>Delete all user data?</h1>
        </div>

        <div data-role="content" data-theme="g">
            <h2 style="padding-top:20px">Do you want to delete all of the data files found at:</h2>
            <h3 align="center">/storage/sdcard/alt/  ?</h3>
            <h2 style="padding-top:30px">This will delete all data including any zips, encrypted data, and decrypted data</h2>
            <h1 align="center">Make certain you have grabbed the zipped data before deletion. Do you want to continue?</h1>
        </div>

        <div data-role="footer" data-position="fixed" data-theme="g">
            <div data-role="navbar">
                <ul>
                    <li><a href="#administrator" data-theme="a">Cancel deletion</a></li>
                    <li><a href="#administrator" onclick="deleteAllFiles()">Yes, delete the data</a></li>
                </ul>
            </div>
            <h4> </h4>
        </div>


    </div>

    <div data-role="page" id="wakeup" data-theme="f">

        <div data-role="header" data-theme="f">
            <h1>Wake up</h1>
        </div>

        <div data-role="content" data-theme="f">
            <h2 align="center">Would you like to wake up the application?</h2>
            <div data-role="controlgroup">
                <a href="#" data-role="button" onclick="wakeUp()" id="button-wakeup" >Wake up</a>
                <a href="#" data-role="button" onclick="snooze()" id="button-snooze">Snooze</a>
            </div>
        </div>


        <div data-role="footer" data-theme="f">
            <h4></h4>
        </div>

    </div>


</body>
</html>
